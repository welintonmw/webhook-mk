"use strict";var Zr=Object.create;var Oe=Object.defineProperty;var Hr=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var Fr=Object.getPrototypeOf,$r=Object.prototype.hasOwnProperty;var qr=(e,t)=>{for(var r in t)Oe(e,r,{get:t[r],enumerable:!0})},Nt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of wr(t))!$r.call(e,o)&&o!==r&&Oe(e,o,{get:()=>t[o],enumerable:!(n=Hr(t,o))||n.enumerable});return e};var d=(e,t,r)=>(r=e!=null?Zr(Fr(e)):{},Nt(t||!e||!e.__esModule?Oe(r,"default",{value:e,enumerable:!0}):r,e)),Jr=e=>Nt(Oe({},"__esModule",{value:!0}),e);var Mn={};qr(Mn,{DEFAULT_END_IN_YEARS:()=>hr,attendeePartStatusTypes:()=>er,classTypes:()=>yr,dateObjectTypes:()=>rr,encodingTypes:()=>Xt,extendByRecurrenceRule:()=>Dt,extendTimezoneProps:()=>Ot,generateIcsAlarm:()=>ct,generateIcsAttachment:()=>ot,generateIcsAttendee:()=>me,generateIcsCalendar:()=>en,generateIcsDate:()=>it,generateIcsDateTime:()=>F,generateIcsDuration:()=>w,generateIcsEvent:()=>ut,generateIcsMail:()=>Y,generateIcsOrganizer:()=>pt,generateIcsRecurrenceRule:()=>ye,generateIcsTimeStamp:()=>L,generateIcsTimezone:()=>ft,generateIcsTimezoneProp:()=>Tt,generateIcsTrigger:()=>at,generateIcsWeekdayNumber:()=>mt,getDurationFromInterval:()=>Sn,getEventEnd:()=>zn,getEventEndFromDuration:()=>Vt,getTimezoneObjectOffset:()=>xt,icsAlarmToObject:()=>Be,icsAttachmentToObject:()=>Me,icsAttendeeToObject:()=>re,icsCalendarToObject:()=>Ur,icsDateTimeToDateTime:()=>W,icsDateToDate:()=>he,icsDurationToObject:()=>U,icsEventToObject:()=>Ue,icsOrganizerToObject:()=>_e,icsRecurrenceIdToObject:()=>Wr,icsRecurrenceRuleToObject:()=>ae,icsTimeStampToObject:()=>x,icsTimezonePropToObject:()=>De,icsTimezoneToObject:()=>We,icsTriggerToObject:()=>Pe,icsWeekdayNumberToObject:()=>ke,parseIcsAlarm:()=>ln,parseIcsAttachment:()=>on,parseIcsAttendee:()=>sn,parseIcsCalendar:()=>Vn,parseIcsDate:()=>cn,parseIcsDateTime:()=>pn,parseIcsDuration:()=>an,parseIcsEvent:()=>xn,parseIcsOrganizer:()=>En,parseIcsRecurrenceId:()=>Nn,parseIcsRecurrenceRule:()=>On,parseIcsTimezone:()=>In,parseIcsTimezoneProp:()=>An,parseIcsTrigger:()=>yn,parseIcsWeekdayNumber:()=>gn,parseicsTimeStamp:()=>mn,recurrenceObjectKeyIsNumber:()=>_r,recurrenceObjectKeyIsNumberArray:()=>Pr,recurrenceObjectKeyIsTimeStamp:()=>Cr,recurrenceObjectKeyIsWeekdayNumberArray:()=>Br,recurrenceRuleFrequencies:()=>cr,statusTypes:()=>Et,timeTransparentTypes:()=>mr,timeZoneOffsetToMilliseconds:()=>Ce,timezonePropTypes:()=>fr,triggerRelations:()=>or,valueTypes:()=>tn,weekDays:()=>_,zAttachment:()=>ue,zAttendee:()=>$,zDateObject:()=>g,zDateObjectTzProps:()=>nr,zOrganizer:()=>le,zRecurrenceId:()=>ge,zRecurrenceRule:()=>q,zVAlarm:()=>fe,zVCalendar:()=>Rt,zVCalendarMethods:()=>lr,zVEvent:()=>Re,zVEventBase:()=>Tr,zVEventDuration:()=>j,zVEventDurationOrEnd:()=>ur,zVEventTrigger:()=>Te,zVEventTriggerBase:()=>ar,zVEventTriggerOptions:()=>ir,zVEventTriggerUnion:()=>sr,zVTimezone:()=>de,zVTimezoneProp:()=>ze,zWeekdayNumberObject:()=>Ee});module.exports=Jr(Mn);var St={ACTION:"action",DESCRIPTION:"description",DURATION:"duration",REPEAT:"repeat",SUMMARY:"summary",TRIGGER:"trigger",ATTACH:"attachment",ATTENDEE:"attendee"},zt={action:"ACTION",description:"DESCRIPTION",duration:"DURATION",repeat:"REPEAT",summary:"SUMMARY",trigger:"TRIGGER",attachment:"ATTACH",attendee:"ATTENDEE"};var nt=d(require("lodash/compact"),1);var Mt={METHOD:"method",PRODID:"prodId",VERSION:"version"},ht={method:"METHOD",prodId:"PRODID",version:"VERSION"};var He="BEGIN",we="END",Kt="VCALENDAR",Fe="VTIMEZONE",$e="STANDARD",qe="DAYLIGHT",Je="VEVENT",Ge="VALARM";var ce=e=>new RegExp(`${He}:${e}([\\s\\S]*?)${we}:${e}`,"g"),Qe=ce(Fe),Xe=ce($e),et=ce(qe),tt=ce(Je),rt=ce(Ge),X=e=>new RegExp(`${He}:${e}|${we}:${e}`,"g"),Yt=X(Kt),Lt=X(Fe),jt=X($e),vt=X(qe),Ct=X(Je),Pt=X(Ge);var xe=/\r\n|\r|\n/,Ae=`\r
`,Bt=":",ee=",",_t='"',H=";";var pe="=";var Ie=e=>`${e}${Ae}`,u=(e,t,r)=>r?t==null?"":Ie(`${e};${r}:${t}`):Ie(`${e}:${t}`),V=e=>Ie(`BEGIN:${e}`),N=e=>Ie(`END:${e}`);var D=e=>{if(!(e.length<1))return`${e.map(t=>`${t.key}${pe}${t.value}`).join(H)}`};var ot=e=>{if(e.type==="uri"){let t=D((0,nt.default)([e.formatType&&{key:"FMTTYPE",value:e.formatType}]));return u("ATTACH",e.url,t)}if(e.type==="binary"){let t=D((0,nt.default)([e.value&&{key:"VALUE",value:e.value},e.encoding&&{key:"ENCODING",value:e.encoding}]));return u("ATTACH",e.binary,t)}throw Error(`Attachment has no type! ${JSON.stringify(e)}`)};var kt=d(require("lodash/compact"),1);var Y=(e,t)=>t?`"MAILTO:${e}"`:`MAILTO:${e}`;var me=(e,t)=>{let r=D((0,kt.default)([e.dir&&{key:"DIR",value:`"${e.dir}"`},e.delegatedFrom&&{key:"DELEGATED-FROM",value:Y(e.delegatedFrom,!0)},e.member&&{key:"MEMBER",value:Y(e.member,!0)},e.role&&{key:"ROLE",value:e.role},e.name&&{key:"CN",value:e.name},e.partstat&&{key:"PARTSTAT",value:e.partstat},e.role&&{key:"ROLE",value:e.role},e.sentBy&&{key:"SENT-BY",value:Y(e.sentBy,!0)}]));return u(t,Y(e.email),r)};var w=e=>{let t="";return e.before&&(t+="-"),t+="P",e.weeks&&(t+=`${e.weeks}W`),e.days&&(t+=`${e.days}D`),(e.hours||e.minutes||e.seconds)&&(t+="T",e.hours&&(t+=`${e.hours}H`),e.minutes&&(t+=`${e.minutes}M`),e.seconds&&(t+=`${e.seconds}S`)),t};var Wt=d(require("lodash/compact"),1);var Ut=d(require("lodash/compact"),1);var st=d(require("lodash/isDate"),1),it=e=>{if(!(0,st.default)(e))throw Error(`Incorrect date object: ${e}`);let t=e.toISOString(),r=t.slice(0,4),n=t.slice(5,7),o=t.slice(8,10);return`${r}${n}${o}`},F=e=>{if(!(0,st.default)(e))throw Error(`Incorrect date object: ${e}`);let t=e.toISOString(),r=t.slice(0,4),n=t.slice(5,7),o=t.slice(8,10),s=t.slice(11,13),i=t.slice(14,16),a=t.slice(17,19);return`${r}${n}${o}T${s}${i}${a}Z`};var L=(e,t)=>{var o;let r=t.type==="DATE"?it(t.date):F(((o=t.local)==null?void 0:o.date)||t.date),n=D((0,Ut.default)([t.type&&{key:"VALUE",value:t.type},t.local&&{key:"TZID",value:t.local.timezone}]));return u(e,r,n)};var at=e=>{var r;let t=D((0,Wt.default)([((r=e.options)==null?void 0:r.related)&&{key:"RELATED",value:e.options.related}]));if(e.type==="absolute")return L("TRIGGER",e.value);if(e.type==="relative")return u("TRIGGER",w(e.value),t)};var S=e=>Object.keys(e);var ct=e=>{let t=S(e),r="";return r+=V("VALARM"),t.forEach(n=>{if(n==="attachments"||n==="attendees")return;let o=zt[n];if(!o)return;let s=e[n];if(s&&s!=null){if(n==="trigger"){r+=at(s);return}if(n==="duration"){r+=u(o,w(s));return}if(n==="repeat"){r+=u(o,s==null?void 0:s.toString());return}r+=u(o,String(s))}}),e.attachments&&e.attachments.length>0&&e.attachments.forEach(n=>{r+=ot(n)}),e.attendees&&e.attendees.length>0&&e.attendees.forEach(n=>{r+=me(n,"ATTENDEE")}),r+=N("VALARM"),r};var Zt={"LAST-MODIFIED":"lastModified",ALARM:"alarm",CATEGORIES:"categories",CREATED:"created",DESCRIPTION:"description",DTSTAMP:"stamp",DTSTART:"start",LOCATION:"location",EXDATE:"exceptionDates",RRULE:"recurrenceRule",SUMMARY:"summary",UID:"uid",TRANSP:"timeTransparent",URL:"url",DTEND:"end",DURATION:"duration",GEO:"geo",CLASS:"class",ORGANIZER:"organizer",PRIORITY:"priority",SEQ:"sequence",STATUS:"status",ATTACH:"attach","RECURRENCE-ID":"recurrenceId",ATTENDEE:"attendee",COMMENT:"comment"},Ht={alarm:"ALARM",categories:"CATEGORIES",created:"CREATED",description:"DESCRIPTION",lastModified:"LAST-MODIFIED",location:"LOCATION",exceptionDates:"EXDATE",recurrenceRule:"RRULE",stamp:"DTSTAMP",start:"DTSTART",summary:"SUMMARY",uid:"UID",timeTransparent:"TRANSP",url:"URL",end:"DTEND",duration:"DURATION",geo:"GEO",class:"CLASS",organizer:"ORGANIZER",priority:"PRIORITY",sequence:"SEQ",status:"STATUS",attach:"ATTACH",recurrenceId:"RECURRENCE-ID",attendee:"ATTENDEE",comment:"COMMENT"};var Gr=["stamp","start","end","created","lastModified"],Ve=e=>Gr.includes(e),Qr=["categories"],Ne=e=>Qr.includes(e);var wt=(e,t)=>L(t,e);var Ft=d(require("lodash/compact"),1);var pt=e=>{let t=D((0,Ft.default)([e.dir&&{key:"DIR",value:`"${e.dir}"`},e.name&&{key:"CN",value:e.name},e.sentBy&&{key:"SENT-BY",value:Y(e.sentBy)}]));return u("ORGANIZER",Y(e.email),t)};var yt=d(require("lodash/compact"),1);var mt=e=>e.occurence?`${e.occurence}${e.day}`:e.day;var ye=e=>{let t="",r=D((0,yt.default)([e.byDay&&{key:"BYDAY",value:e.byDay.map(n=>mt(n)).join(",")},e.byHour&&{key:"BYHOUR",value:e.byHour.join(",")},e.byMinute&&{key:"BYMINUTE",value:e.byMinute.join(",")},e.byMonth&&{key:"BYMONTH",value:e.byMonth.map(n=>n+1).join(",")},e.byMonthday&&{key:"BYMONTHDAY",value:e.byMonthday.join(",")},e.bySecond&&{key:"BYSECOND",value:e.bySecond.join(",")},e.bySetPos&&{key:"BYSETPOS",value:e.bySetPos.join(",")},e.byWeekNo&&{key:"BYWEEKNO",value:e.byWeekNo.join(",")},e.byYearday&&{key:"BYYEARDAY",value:e.byYearday.join(",")},e.count&&{key:"COUNT",value:e.count.toString()},e.frequency&&{key:"FREQ",value:e.frequency},e.interval&&{key:"INTERVAL",value:e.interval.toString()},e.until&&{key:"UNTIL",value:`${e.until.local&&`${D((0,yt.default)([{key:"TZID",value:e.until.local.timezone}]))}=`}${e.until.date}`},e.workweekStart&&{key:"WKST",value:e.workweekStart}]));return t+=u("RRULE",r),t};var ut=e=>{let t=S(e),r="";return r+=V("VEVENT"),t.forEach(n=>{if(n==="alarms"||n==="attendees"||n==="exceptionDates")return;let o=Ht[n];if(!o)return;let s=e[n];if(s!=null){if(Ve(n)){r+=L(o,s);return}if(Ne(n)){r+=u(o,s.join(","));return}if(n==="recurrenceRule"){r+=ye(s);return}if(n==="duration"){r+=u(o,w(s));return}if(n==="organizer"){r+=pt(s);return}if(n==="sequence"){r+=s.toString();return}r+=u(o,String(s))}}),e.alarms&&e.alarms.length>0&&e.alarms.forEach(n=>{r+=ct(n)}),e.attendees&&e.attendees.length>0&&e.attendees.forEach(n=>{r+=me(n,"ATTENDEE")}),e.exceptionDates&&e.exceptionDates.length>0&&e.exceptionDates.forEach(n=>{r+=wt(n,"EXDATE")}),r+=N("VEVENT"),r};var $t={"LAST-MODIFIED":"lastModified",TZID:"id",TZURL:"url"},qt={id:"TZID",lastModified:"LAST-MODIFIED",url:"TZURL"};var Jt={COMMENT:"comment",DTSTART:"start",RDATE:"recurrenceDate",RRULE:"recurrenceRule",TZNAME:"name",TZOFFSETFROM:"offsetFrom",TZOFFSETTO:"offsetTo"},Gt={comment:"COMMENT",name:"TZNAME",offsetFrom:"TZOFFSETFROM",offsetTo:"TZOFFSETTO",recurrenceDate:"RDATE",recurrenceRule:"RRULE",start:"DTSTART"};var Tt=e=>{let t=S(e),r="";return r+=V(e.type),t.forEach(n=>{if(n==="type")return;let o=Gt[n];if(!o)return;let s=e[n];if(n==="start"){r+=u(o,F(s));return}if(n==="recurrenceRule"){r+=ye(s);return}if(n==="recurrenceDate"){r+=L(o,s);return}r+=u(o,String(s))}),r+=N(e.type),r};var ft=e=>{let t=S(e),r="";return r+=V("VTIMEZONE"),t.forEach(n=>{if(n==="props")return;let o=qt[n];if(!o)return;let s=e[n];if(n==="lastModified"){r+=u(o,F(s));return}r+=u(o,String(s))}),e.props&&e.props.length>0&&e.props.forEach(n=>{r+=Tt(n)}),r+=N("VTIMEZONE"),r};var Qt=e=>{let t=e.split(xe),r=[];return t.forEach(n=>{if(n.length<75){r.push(n);return}Xr(n,75).forEach(o=>{r.push(o)})}),r.join(Ae)},Xr=(e,t)=>{let r=e,n=[];for(;Math.ceil(r.length/t)>=1;)n.push(n.length===0?r.substring(0,t):` ${r.substring(0,t)}`),r=r.substring(t);return n};var en=e=>{let t=S(e),r="";return r+=V("VCALENDAR"),t.forEach(n=>{if(n==="events"||n==="timezones")return;let o=ht[n];if(!o)return;let s=e[n];r+=u(o,s)}),e.timezones&&e.timezones.length>0&&e.timezones.forEach(n=>{r+=ft(n)}),e.events&&e.events.length>0&&e.events.forEach(n=>{r+=ut(n)}),r+=N("VCALENDAR"),Qt(r)};var G=d(require("lodash/set"),1);var B=require("zod");var b=require("zod"),Xt=["BASE64"],tn=["BINARY"],ue=b.z.discriminatedUnion("type",[b.z.object({type:b.z.literal("uri"),url:b.z.string().url(),formatType:b.z.string().optional(),encoding:b.z.never().optional(),value:b.z.never().optional(),binary:b.z.never().optional()}),b.z.object({type:b.z.literal("binary"),url:b.z.never().optional(),formatType:b.z.never().optional(),encoding:b.z.enum(Xt),value:b.z.enum(["BINARY"]),binary:b.z.string()})]);var z=require("zod"),er=["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED"],$=z.z.object({email:z.z.string().email(),name:z.z.string().optional(),member:z.z.string().email().optional(),delegatedFrom:z.z.string().email().optional(),role:z.z.string().optional(),partstat:z.z.enum(er).optional(),dir:z.z.string().url().optional(),sentBy:z.z.string().email().optional()});var C=require("zod"),j=C.z.object({before:C.z.boolean().optional(),weeks:C.z.number().optional(),days:C.z.number().optional(),hours:C.z.number().optional(),minutes:C.z.number().optional(),seconds:C.z.number().optional()});var M=require("zod");var tr=require("date-fns"),P=require("zod"),rr=["DATE","DATE-TIME"],nr=P.z.object({date:P.z.date(),timezone:P.z.string(),tzoffset:P.z.string()}),rn=P.z.date().transform(e=>(0,tr.setMilliseconds)(e,0)),g=P.z.object({date:rn,type:P.z.enum(rr).optional(),local:nr.optional()});var or=["START","END"],sr=M.z.discriminatedUnion("type",[M.z.object({type:M.z.literal("absolute"),value:g}),M.z.object({type:M.z.literal("relative"),value:j})]),ir=M.z.object({related:M.z.enum(or).optional()}),ar=M.z.object({options:ir.optional()}),Te=M.z.intersection(ar,sr);var fe=B.z.object({action:B.z.string().default("DISPLAY"),description:B.z.string().optional(),trigger:Te,attendees:B.z.array($).optional(),duration:j.optional(),repeat:B.z.number().optional(),summary:B.z.string().optional(),attachments:B.z.array(ue).optional()});var v=require("zod");var T=require("zod");var te=require("zod"),le=te.z.object({name:te.z.string().optional(),email:te.z.string().email(),dir:te.z.string().optional(),sentBy:te.z.string().email().optional()});var f=require("zod");var Se=require("zod"),_=["SU","MO","TU","WE","TH","FR","SA"],Ee=Se.z.object({day:Se.z.enum(_),occurence:Se.z.number().optional()});var cr=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"],q=f.z.object({frequency:f.z.enum(cr),until:g.optional(),count:f.z.number().optional(),interval:f.z.number().optional(),bySecond:f.z.array(f.z.number().min(0).max(60)).optional(),byMinute:f.z.array(f.z.number().min(0).max(59)).optional(),byHour:f.z.array(f.z.number().min(0).max(23)).optional(),byDay:f.z.array(Ee).optional(),byMonthday:f.z.array(f.z.number().min(-31).max(31)).optional(),byYearday:f.z.array(f.z.number().min(1).max(366)).optional(),byWeekNo:f.z.array(f.z.number().min(1).max(53)).optional(),byMonth:f.z.array(f.z.number().min(0).max(11)).optional(),bySetPos:f.z.array(f.z.number().min(-366).max(366)).optional(),workweekStart:f.z.enum(_).optional()});var lt=require("zod");var ge=lt.z.object({range:lt.z.literal("THISANDFUTURE").optional(),value:g});var Et=["TENTATIVE","CONFIRMED","CANCELLED"];var pr=require("zod");var nn=g,gt=pr.z.array(nn);var mr=["TRANSPARENT","OPAQUE"],yr=["PRIVATE","PUBLIC","CONFIDENTIAL"],ur=T.z.union([T.z.object({duration:j,end:T.z.never().optional()}),T.z.object({duration:T.z.never().optional(),end:g})]),Tr=T.z.object({summary:T.z.string(),uid:T.z.string(),created:g.optional(),lastModified:g.optional(),stamp:g,start:g,location:T.z.string().optional(),description:T.z.string().optional(),categories:T.z.array(T.z.string()).optional(),exceptionDates:gt.optional(),recurrenceRule:q.optional(),alarms:T.z.array(fe).optional(),timeTransparent:T.z.enum(mr).optional(),url:T.z.string().url().optional(),geo:T.z.string().optional(),class:T.z.enum(yr).optional(),organizer:le.optional(),priority:T.z.string().optional(),sequence:T.z.number().optional(),status:T.z.enum(Et).optional(),attach:T.z.string().optional(),recurrenceId:ge.optional(),attendees:T.z.array($).optional(),comment:T.z.string().optional()}),Re=T.z.intersection(Tr,ur);var A=require("zod");var fr=["STANDARD","DAYLIGHT"],ze=A.z.object({type:A.z.enum(fr),start:A.z.date(),offsetTo:A.z.string(),offsetFrom:A.z.string(),recurrenceRule:q.optional(),comment:A.z.string().optional(),recurrenceDate:g.optional(),name:A.z.string().optional()}),de=A.z.object({id:A.z.string(),lastModified:A.z.date().optional(),url:A.z.string().url().optional(),props:A.z.array(ze)});var lr=["PUBLISH"],Rt=v.z.object({version:v.z.literal("2.0"),prodId:v.z.string(),method:v.z.union([v.z.enum(lr),v.z.string()]).optional(),timezones:v.z.array(de).optional(),events:v.z.array(Re).optional()});var Me=(e,t)=>(t==null?void 0:t.VALUE)==="BINARY"?{type:"binary",encoding:(t==null?void 0:t.ENCODING)||"BASE64",binary:e,value:t==null?void 0:t.VALUE}:{type:"uri",url:e,formatType:t==null?void 0:t.FMTTYPE},on=(e,t)=>ue.parse(Me(e,t));var k=e=>e.replace(/mailto:/gi,"");var re=(e,t)=>({email:k(e),delegatedFrom:t!=null&&t["DELEGATED-FROM"]?k(t["DELEGATED-FROM"]):void 0,dir:t==null?void 0:t.DIR,member:t!=null&&t.MEMBER?k(t.MEMBER):void 0,name:t==null?void 0:t.CN,partstat:t==null?void 0:t.PARTSTAT,role:t==null?void 0:t.ROLE,sentBy:t!=null&&t["SENT-BY"]?k(t["SENT-BY"]):void 0}),sn=(e,t)=>$.parse(re(e,t));var J=d(require("lodash/set"),1);var U=e=>{let t=e,r={};t[0]==="-"&&((0,J.default)(r,"before",!0),t=t.slice(1)),t=t.slice(1);let n=t.split("T"),o=n[0];if(o.includes("D")){let[i,a]=o.split("D");(0,J.default)(r,"days",Number(i)),o=a}if(o.includes("W")){let[i,a]=o.split("W");(0,J.default)(r,"weeks",Number(i)),o=a}let s=n[1];if(s){if(s.includes("H")){let[i,a]=s.split("H");(0,J.default)(r,"hours",Number(i)),s=a}if(s.includes("M")){let[i,a]=s.split("M");(0,J.default)(r,"minutes",Number(i)),s=a}if(s.includes("S")){let[i,a]=s.split("S");(0,J.default)(r,"seconds",Number(i)),s=a}}return r},an=e=>j.parse(U(e));var Yr=require("date-fns");var dt=require("zod"),he=e=>{let t=Number.parseInt(e.slice(0,4),10),r=Number.parseInt(e.slice(4,6),10)-1,n=Number.parseInt(e.slice(6,8),10);return new Date(t,r,n)},cn=e=>dt.z.date().parse(he(e)),W=e=>{let t=Number.parseInt(e.slice(0,4),10),r=Number.parseInt(e.slice(4,6),10)-1,n=Number.parseInt(e.slice(6,8),10),o=Number.parseInt(e.slice(9,11),10),s=Number.parseInt(e.slice(11,13),10),i=Number.parseInt(e.slice(13,15),10);return new Date(Date.UTC(t,r,n,o,s,i))},pn=(e,t)=>dt.z.date().parse(W(e,t));var ie=require("date-fns");var Mr=require("date-fns");var O=require("date-fns"),ne=(e,t)=>t===void 0?!1:e>=t,Er=(e,{start:t,end:r},n)=>{if(ne(n.length,e.count))return;let o=e.frequency,s=e.interval||1;if(!o)return;let i=t;if(o==="SECONDLY"){for(;i<r;){if(ne(n.length,e.count))return;i=(0,O.addSeconds)(i,s),n.push([i])}return}if(o==="MINUTELY"){for(;i<r;){if(ne(n.length,e.count))return;i=(0,O.addMinutes)(i,s),n.push([i])}return}if(o==="HOURLY"){for(;i<r;){if(ne(n.length,e.count))return;i=(0,O.addHours)(i,s),n.push([i])}return}if(o==="DAILY"){for(;i<r;){if(ne(n.length,e.count))return;i=(0,O.addDays)(i,s),n.push([i])}return}if(o==="WEEKLY"){for(;i<r;){if(ne(n.length,e.count))return;i=(0,O.addWeeks)(i,s),n.push([i])}return}if(o==="MONTHLY"){for(;i<r;)i=(0,O.addMonths)(i,s),n.push([i]);return}if(o==="YEARLY"){for(;i<r;)i=(0,O.addYears)(i,s),n.push([i]);return}};var se=require("date-fns");var m=require("date-fns");var gr=(e,t,r,n)=>{let o=r.map(({day:s,occurence:i})=>({occurence:i,day:_.indexOf(s)}));return e.frequency==="YEARLY"?e.byYearday||e.byMonthday?t.map(s=>s.filter(i=>o.find(({day:a})=>a===(0,m.getDay)(i)))):e.byWeekNo?t.map(s=>s.flatMap(i=>o.map(({day:a})=>(0,m.setDay)(i,a,{weekStartsOn:n})))):e.byMonth?t.map(s=>s.flatMap(i=>o.flatMap(({day:a,occurence:c})=>bt(Z((0,m.startOfMonth)(i)),Z((0,m.endOfMonth)(i)),a,n,c)))):t.map(s=>s.flatMap(i=>o.flatMap(({day:a,occurence:c})=>bt(Z((0,m.startOfYear)(i)),Z((0,m.endOfYear)(i)),a,n,c)))):e.frequency==="MONTHLY"?e.byMonthday?t.map(s=>s.filter(i=>o.find(({day:a})=>a===(0,m.getDay)(i)))):t.map(s=>s.flatMap(i=>o.flatMap(({day:a,occurence:c})=>bt(Z((0,m.startOfMonth)(i)),Z((0,m.endOfMonth)(i)),a,n,c)))):e.frequency==="WEEKLY"?t.map(s=>s.flatMap(i=>o.map(({day:a})=>(0,m.setDay)(i,a,{weekStartsOn:n})))):t.map(s=>s.filter(i=>o.find(({day:a})=>a===(0,m.getDay)(i))))},bt=(e,t,r,n,o)=>{if(o!==void 0){if(!(o<0)){let E=(0,m.setDay)(e,r,{weekStartsOn:n}),l=e>E;return(0,m.addWeeks)(E,(o||1)-1+(l?1:0))}let a=(0,m.setDay)(t,r,{weekStartsOn:n}),c=t<a;return Z((0,m.startOfDay)((0,m.subWeeks)(a,-(o||1)-1+(c?1:0))))}return(0,m.eachDayOfInterval)({start:e,end:t}).map(i=>Z(i)).filter(i=>(0,m.isWithinInterval)(i,{start:e,end:t})).filter(i=>r===(0,m.getDay)(i))},Z=e=>(0,m.addMinutes)(e,-e.getTimezoneOffset());var Ke=require("date-fns"),Rr=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"?t.map(n=>n.flatMap(o=>r.map(s=>(0,Ke.setHours)(o,s)))):t.map(n=>n.filter(o=>r.includes((0,Ke.getHours)(o))));var Ye=require("date-fns"),dr=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"||e.frequency==="HOURLY"?t.map(n=>n.flatMap(o=>r.map(s=>(0,Ye.setMinutes)(o,s)))):t.map(n=>n.filter(o=>r.includes((0,Ye.getMinutes)(o))));var Le=require("date-fns"),br=(e,t,r)=>e.frequency==="YEARLY"?t.map(n=>n.flatMap(o=>r.map(s=>(0,Le.setMonth)(o,s)))):t.map(n=>n.filter(o=>r.includes((0,Le.getMonth)(o))));var oe=require("date-fns"),Dr=d(require("lodash/compact"),1),Or=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"?t.map(n=>n.flatMap(o=>{let s=(0,oe.getDaysInMonth)(o);return(0,Dr.default)(r.map(i=>i>s?void 0:(0,oe.setDate)(o,i)))})):e.frequency==="WEEKLY"?t:t.map(n=>n.filter(o=>r.includes((0,oe.getMonth)(o))));var je=require("date-fns"),xr=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"||e.frequency==="HOURLY"||e.frequency==="MINUTELY"?t.map(n=>n.flatMap(o=>r.map(s=>(0,je.setSeconds)(o,s)))):t.map(n=>n.filter(o=>r.includes((0,je.getSeconds)(o))));var Ar=require("date-fns"),Ir=(e,t,r)=>!e.byYearday&&!e.byWeekNo&&!e.byMonthday&&!e.byMonth&&!e.byDay&&!e.byHour&&!e.byMinute&&!e.bySecond?t:t.map(n=>n.sort(Ar.compareAsc).filter((o,s)=>r.some(i=>i>0?s===0?!1:s%i===0:s===0?n.length-1+i===0:s%(n.length-1+i)===0)));var Vr=require("date-fns"),Nr=(e,t,r,n)=>e.frequency==="YEARLY"?t.map(o=>o.flatMap(s=>r.map(i=>(0,Vr.setWeek)(s,i,{weekStartsOn:n})))):t;var ve=require("date-fns"),Sr=(e,t,r)=>e.frequency==="YEARLY"?t.map(n=>n.flatMap(o=>r.map(s=>(0,ve.setDayOfYear)(o,s)))):e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"?t:t.map(n=>n.filter(o=>r.includes((0,ve.getYear)(o))));var zr=(e,t,r)=>{let n=r;return e.byMonth&&(n=br(e,n,e.byMonth)),e.byWeekNo&&(n=Nr(e,n,e.byWeekNo,t.weekStartsOn)),e.byYearday&&(n=Sr(e,n,e.byYearday)),e.byMonthday&&(n=Or(e,n,e.byMonthday)),e.byDay&&(n=gr(e,n,e.byDay,t.weekStartsOn)),e.byHour&&(n=Rr(e,n,e.byHour)),e.byMinute&&(n=dr(e,n,e.byMinute)),e.bySecond&&(n=xr(e,n,e.bySecond)),e.bySetPos&&(n=Ir(e,n,e.bySetPos)),n.map(s=>s.sort(se.compareAsc).filter(i=>!(t.exceptions.length>0&&t.exceptions.some(a=>(0,se.isEqual)(a,i))||!(0,se.isWithinInterval)(i,{start:t.start,end:t.end}))))};var hr=2,Dt=(e,t)=>{var p;let r=t.start,n=((p=e.until)==null?void 0:p.date)||(t==null?void 0:t.end)||(0,Mr.addYears)(r,hr),o=t.exceptions||[],s=(e.workweekStart?_.indexOf(e.workweekStart):1)%7,i=[[r]];Er(e,{start:r,end:n},i);let a=zr(e,{start:r,end:n,exceptions:o,weekStartsOn:s},i);return e.count?a.flat().splice(0,e.count):a.flat()};var Ot=(e,t)=>t.flatMap(r=>!r.recurrenceRule||r.recurrenceRule.until&&r.recurrenceRule.until.date<e?r:Dt(r.recurrenceRule,{start:r.start,end:e}).map(o=>({...r,start:o})));var Ce=e=>{let t=e[0]==="+"?1:-1,r=Number(e.slice(1,3)),n=e.length>3?Number(e.slice(3,5)):0,o=e.length>5?Number(e.slice(5,7)):0;return((r*60+n)*60+o)*1e3*t};var Kr=(e,t)=>{let r="en-US",n=new Date(t.toLocaleString(r,{timeZone:"UTC"}));return new Date(t.toLocaleString(r,{timeZone:e})).getTime()-n.getTime()};var xt=(e,t,r)=>{let n=r==null?void 0:r.find(s=>s.id===t);if(n){let s=Ot(e,n.props).sort((c,p)=>(0,ie.compareAsc)(c.start,p.start));for(let c=0;c<s.length;c+=1)if(e<s[c].start){let p=s[c-1]?s[c-1].offsetTo:s[c].offsetFrom,E=p.length>5?p.substring(0,5):p;return{offset:E,milliseconds:Ce(E)}}let i=s[s.length-1].offsetTo,a=i.length>5?i.substring(0,5):i;return{offset:a,milliseconds:Ce(a)}}let o=Kr(t,e);if(!Number.isNaN(o)){let s=o<0,i=Math.abs((0,ie.millisecondsToHours)(o)),a=Math.abs((0,ie.millisecondsToMinutes)(o))-i*60,c=i.toString().length===1?`0${i}`:i.toString(),p=a.toString().length===1?`0${a}`:a.toString();return{offset:`${s?"-":"+"}${c}${p}`,milliseconds:o}}};var x=(e,t,r)=>{if((t==null?void 0:t.VALUE)==="DATE")return{date:he(e),type:t==null?void 0:t.VALUE};let n=(t==null?void 0:t.VALUE)||"DATE-TIME",o=W(e);if(!(t!=null&&t.TZID))return{date:o,type:n};let s=xt(o,t.TZID,r);return s?{date:(0,Yr.addMilliseconds)(o,-s.milliseconds),type:n,local:t!=null&&t.TZID?{date:o,timezone:t==null?void 0:t.TZID,tzoffset:s.offset}:void 0}:{date:o,type:n}},mn=(e,t,r)=>g.parse(x(e,t,r));var Pe=(e,t,r)=>(t==null?void 0:t.VALUE)==="DATE-TIME"||(t==null?void 0:t.VALUE)==="DATE"?{type:"absolute",value:x(e,t,r),options:{related:t==null?void 0:t.RELATED}}:{type:"relative",value:U(e),options:{related:t==null?void 0:t.RELATED}},yn=(e,t,r)=>Te.parse(Pe(e,t,r));var Lr=d(require("lodash/set"),1);var un=e=>e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e,At=e=>e.map(t=>{let[r,...n]=t.split(pe),o=n.join(pe);return{property:r,value:un(o)}},{}),Tn=e=>e.reduce((t,r)=>((0,Lr.default)(t,r.property,r.value),t),{}),jr=e=>Tn(At(e));var fn=e=>{let t=!1,r;for(let s=0;s<e.length&&r===void 0;s+=1)e.charAt(s)===_t&&(t=!t),e.charAt(s)===Bt&&!t&&(r=s);if(r===void 0)throw Error(`Line not valid: ${e}`);let n=e.substring(0,r),o=e.substring(r+1);return{property:n,value:o}},h=e=>{let{property:t,value:r}=fn(e);if(t.includes(H)){let[n,...o]=t.split(H),s=jr(o);return{property:n,options:s,value:r}}return{property:t,value:r}};var K=e=>{let t=[],r=e.split(xe).filter(n=>n!=="");for(let n=0;n<r.length;){let o=r[n];for(n+=1;r[n]&&/^[ \t]/.test(r[n]);)o+=r[n].trimStart(),n+=1;t.push(o)}return t};var Be=(e,t)=>{let r=e.replace(Pt,""),n=K(r),o={},s=[],i=[];return n.forEach(a=>{let{property:c,options:p,value:E}=h(a),l=St[c];if(l){if(l==="trigger"){(0,G.default)(o,l,Pe(E,p,t));return}if(l==="duration"){(0,G.default)(o,l,U(E));return}if(l==="repeat"){(0,G.default)(o,l,Number(E));return}if(l==="attachment"){s.push(Me(E,p));return}if(l==="attendee"){i.push(re(E,p));return}(0,G.default)(o,l,E)}}),s.length>0&&(0,G.default)(o,"attachments",s),i.length>0&&(0,G.default)(o,"attendees",i),o},ln=(e,t)=>fe.parse(Be(e,t));var Ze=d(require("lodash/set"),1);var I=d(require("lodash/set"),1);var _e=(e,t)=>({name:t==null?void 0:t.CN,dir:t==null?void 0:t.DIR,sentBy:t!=null&&t["SENT-BY"]?k(t["SENT-BY"]):void 0,email:k(e)}),En=(e,t)=>le.parse(_e(e,t));var Q=d(require("lodash/set"),1);var vr={BYDAY:"byDay",BYHOUR:"byHour",BYMINUTE:"byMinute",BYMONTH:"byMonth",BYMONTHDAY:"byMonthday",BYSECOND:"bySecond",BYSETPOS:"bySetPos",BYWEEKNO:"byWeekNo",BYYEARDAY:"byYearday",COUNT:"count",FREQ:"frequency",INTERVAL:"interval",UNTIL:"until",WKST:"workweekStart"};var ke=e=>{if(e.length===2)return{day:e};let r=e.slice(0,-2);return{day:e.replace(r,""),occurence:Number(r)}},gn=e=>Ee.parse(ke(e));var Rn=["until"],Cr=e=>Rn.includes(e),dn=["bySecond","byMinute","byHour","byMonthday","byYearday","byWeekNo","bySetPos"],Pr=e=>dn.includes(e),bn=["byDay"],Br=e=>bn.includes(e),Dn=["count","interval"],_r=e=>Dn.includes(e),ae=(e,t)=>{let r={};return At(e.split(H)).forEach(o=>{let{property:s,value:i}=o,a=vr[s];if(a){if(Cr(a)){(0,Q.default)(r,a,x(i,{},t));return}if(Pr(a)){(0,Q.default)(r,a,i.split(ee).map(c=>Number(c)));return}if(a==="byMonth"){(0,Q.default)(r,a,i.split(ee).map(c=>Number(c)-1));return}if(Br(a)){(0,Q.default)(r,a,i.split(ee).map(c=>ke(c)));return}if(_r(a)){(0,Q.default)(r,a,Number(i));return}(0,Q.default)(r,a,i)}}),r},On=(e,t)=>q.parse(ae(e,t));var kr=(e,t)=>e.split(",").map(r=>x(r,t));var Ue=(e,t)=>{let r=e.replace(Ct,""),n=K(r.replace(rt,"")),o={},s=[],i=[];n.forEach(c=>{let{property:p,options:E,value:l}=h(c),R=Zt[p];if(R){if(Ve(R)){(0,I.default)(o,R,x(l,E,t));return}if(Ne(R)){(0,I.default)(o,R,l.split(ee));return}if(R==="recurrenceRule"){(0,I.default)(o,R,ae(l,t));return}if(R==="duration"){(0,I.default)(o,R,U(l));return}if(R==="organizer"){(0,I.default)(o,R,_e(l,E));return}if(R==="sequence"){(0,I.default)(o,R,Number(l));return}if(R==="attendee"){s.push(re(l,E));return}if(R==="exceptionDates"){i.push(...kr(l,E));return}(0,I.default)(o,R,l)}});let a=[...e.matchAll(rt)].map(c=>c[0]);if(a.length>0){let c=a.map(p=>Be(p,t));(0,I.default)(o,"alarms",c)}return s.length>0&&(0,I.default)(o,"attendees",s),i.length>0&&(0,I.default)(o,"exceptionDates",i),o},xn=(e,t)=>Re.parse(Ue(e,t));var It=d(require("lodash/set"),1);var be=d(require("lodash/set"),1);var De=(e,t)=>{let r=e.replace(jt,"").replace(vt,""),n=K(r),o={type:t||"STANDARD"};return n.forEach(s=>{let{property:i,options:a,value:c}=h(s),p=Jt[i];if(p){if(p==="start"){(0,be.default)(o,p,W(c));return}if(p==="recurrenceRule"){(0,be.default)(o,p,ae(c));return}if(p==="recurrenceDate"){(0,be.default)(o,p,x(c,a));return}(0,be.default)(o,p,c)}}),o},An=(e,t)=>ze.parse(De(e,t));var We=e=>{let t=e.replace(Lt,""),r=K(t.replace(Xe,"").replace(et,"")),n={props:[]};r.forEach(i=>{let{property:a,value:c}=h(i),p=$t[a];if(p){if(p==="lastModified"){(0,It.default)(n,p,W(c));return}(0,It.default)(n,p,c)}});let o=[...t.matchAll(Xe)].map(i=>i[0]);o.length>0&&o.forEach(i=>{n.props.push(De(i,"STANDARD"))});let s=[...t.matchAll(et)].map(i=>i[0]);return s.length>0&&s.forEach(i=>{n.props.push(De(i,"DAYLIGHT"))}),n},In=e=>de.parse(We(e));var Ur=e=>{let t=e.replace(Yt,""),r=K(t.replace(tt,"").replace(Qe,"")),n={};r.forEach(i=>{let{property:a,value:c}=h(i),p=Mt[a];p&&(0,Ze.default)(n,p,c)});let o=[...t.matchAll(Qe)].map(i=>i[0]);if(o.length>0){let i=o.map(a=>We(a));(0,Ze.default)(n,"timezones",i)}let s=[...t.matchAll(tt)].map(i=>i[0]);if(s.length>0){let i=s.map(a=>Ue(a,n.timezones));(0,Ze.default)(n,"events",i)}return n},Vn=e=>Rt.parse(Ur(e));var Wr=(e,t,r)=>({value:x(e,t,r),range:t==null?void 0:t.RANGE}),Nn=(e,t,r)=>ge.parse(Wr(e,t,r));var y=require("date-fns"),Vt=(e,t)=>t.before?(0,y.subWeeks)((0,y.subDays)((0,y.subHours)((0,y.subMinutes)((0,y.subSeconds)(e,t.seconds||0),t.minutes||0),t.hours||0),t.days||0),t.weeks||0):(0,y.addWeeks)((0,y.addDays)((0,y.addHours)((0,y.addMinutes)((0,y.addSeconds)(e,t.seconds||0),t.minutes||0),t.hours||0),t.days||0),t.weeks||0),Sn=(e,t)=>{let r=Math.abs((0,y.differenceInWeeks)(t,e)),n=Math.abs((0,y.differenceInDays)(t,e)),o=n-r*7,s=Math.abs((0,y.differenceInHours)(t,e)),i=s-n*24,a=Math.abs((0,y.differenceInMinutes)(t,e)),c=a-s*60,E=Math.abs((0,y.differenceInSeconds)(t,e))-a*60;return{before:e>t,weeks:r,days:o,hours:i,minutes:c,seconds:E}};var zn=e=>e.end?e.end.date:Vt(e.start.date,e.duration);0&&(module.exports={DEFAULT_END_IN_YEARS,attendeePartStatusTypes,classTypes,dateObjectTypes,encodingTypes,extendByRecurrenceRule,extendTimezoneProps,generateIcsAlarm,generateIcsAttachment,generateIcsAttendee,generateIcsCalendar,generateIcsDate,generateIcsDateTime,generateIcsDuration,generateIcsEvent,generateIcsMail,generateIcsOrganizer,generateIcsRecurrenceRule,generateIcsTimeStamp,generateIcsTimezone,generateIcsTimezoneProp,generateIcsTrigger,generateIcsWeekdayNumber,getDurationFromInterval,getEventEnd,getEventEndFromDuration,getTimezoneObjectOffset,icsAlarmToObject,icsAttachmentToObject,icsAttendeeToObject,icsCalendarToObject,icsDateTimeToDateTime,icsDateToDate,icsDurationToObject,icsEventToObject,icsOrganizerToObject,icsRecurrenceIdToObject,icsRecurrenceRuleToObject,icsTimeStampToObject,icsTimezonePropToObject,icsTimezoneToObject,icsTriggerToObject,icsWeekdayNumberToObject,parseIcsAlarm,parseIcsAttachment,parseIcsAttendee,parseIcsCalendar,parseIcsDate,parseIcsDateTime,parseIcsDuration,parseIcsEvent,parseIcsOrganizer,parseIcsRecurrenceId,parseIcsRecurrenceRule,parseIcsTimezone,parseIcsTimezoneProp,parseIcsTrigger,parseIcsWeekdayNumber,parseicsTimeStamp,recurrenceObjectKeyIsNumber,recurrenceObjectKeyIsNumberArray,recurrenceObjectKeyIsTimeStamp,recurrenceObjectKeyIsWeekdayNumberArray,recurrenceRuleFrequencies,statusTypes,timeTransparentTypes,timeZoneOffsetToMilliseconds,timezonePropTypes,triggerRelations,valueTypes,weekDays,zAttachment,zAttendee,zDateObject,zDateObjectTzProps,zOrganizer,zRecurrenceId,zRecurrenceRule,zVAlarm,zVCalendar,zVCalendarMethods,zVEvent,zVEventBase,zVEventDuration,zVEventDurationOrEnd,zVEventTrigger,zVEventTriggerBase,zVEventTriggerOptions,zVEventTriggerUnion,zVTimezone,zVTimezoneProp,zWeekdayNumberObject});
