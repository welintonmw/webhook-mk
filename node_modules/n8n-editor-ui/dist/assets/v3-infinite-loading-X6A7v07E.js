import{r as v,_ as S,b as H,Y as C,l as b,m as x,H as p,U as L,R as u,p as c,T as g,d as y,n as N,aw as $,ax as j}from"./vendor-Dv5OeN6t.js";const h=(e,o)=>{const t=e.__vccOpts||e;for(const[n,a]of o)t[n]=a;return t},O={},R=e=>($("data-v-259be2b2"),e=e(),j(),e),T={class:"container"},V=R(()=>c("div",{class:"spinner"},null,-1)),M=[V];function U(e,o){return b(),x("div",T,M)}const D=h(O,[["render",U],["__scopeId","data-v-259be2b2"],["__file","/home/oumoussa/side-projects/infinite/src/components/Spinner.vue"]]),z=e=>({loading(){e.value="loading"},loaded(){e.value="loaded"},complete(){e.value="complete"},error(){e.value="error"}}),A=(e,o,t)=>()=>{const n=t.parentEl||document.documentElement;t.prevHeight=n.scrollHeight,o.loading(),e("infinite",o)},F=(e,o)=>{const t=e.getBoundingClientRect();if(!o)return t.top>=0&&t.bottom<=window.innerHeight;const n=o.getBoundingClientRect();return t.top>=n.top&&t.bottom<=n.bottom},_=e=>{e.parentEl=document.querySelector(e.target)||null;let o=`0px 0px ${e.distance}px 0px`;e.top&&(o=`${e.distance}px 0px 0px 0px`);const t=new IntersectionObserver(n=>{n[0].isIntersecting&&(e.firstload&&e.emit(),e.firstload=!0)},{root:e.parentEl,rootMargin:o});return t.observe(e.infiniteLoading.value),t},G={class:"state-error"},K={__name:"InfiniteLoading",props:{top:{type:Boolean,required:!1},target:{type:[String,Boolean],required:!1},distance:{type:Number,required:!1,default:0},identifier:{required:!1},firstload:{type:Boolean,required:!1,default:!0},slots:{type:Object,required:!1}},emits:["infinite"],setup(e,{emit:o}){const t=e;let n=null;const a=v(null),s=v("ready"),{top:m,firstload:E,target:k,distance:I}=t,{identifier:f}=S(t),r={infiniteLoading:a,target:k,top:m,firstload:E,distance:I,prevHeight:0,parentEl:null};r.emit=A(o,z(s),r);const q=()=>y(s,async i=>{const l=r.parentEl||document.documentElement;await N(),i=="loaded"&&m&&(l.scrollTop=l.scrollHeight-r.prevHeight),i=="loaded"&&F(a.value,r.parentEl)&&r.emit(),i=="complete"&&n.disconnect()}),w=()=>y(f,()=>{s.value="ready",n.disconnect(),n=_(r)});return H(()=>{n=_(r),q(),f&&w()}),C(()=>{n.disconnect()}),(i,l)=>(b(),x("div",{ref_key:"infiniteLoading",ref:a},[s.value=="loading"?p(i.$slots,"spinner",{key:0},()=>[L(D)],!0):u("v-if",!0),s.value=="complete"?p(i.$slots,"complete",{key:1},()=>{var d;return[c("span",null,g(((d=e.slots)==null?void 0:d.complete)||"No more results!"),1)]},!0):u("v-if",!0),s.value=="error"?p(i.$slots,"error",{key:2,retry:r.emit},()=>{var d;return[c("span",G,[c("span",null,g(((d=e.slots)==null?void 0:d.error)||"Oops something went wrong!"),1),c("button",{class:"retry",onClick:l[0]||(l[0]=(...B)=>r.emit&&r.emit(...B))}," retry ")])]},!0):u("v-if",!0)],512))}},Y=h(K,[["__scopeId","data-v-9d82030b"],["__file","/home/oumoussa/side-projects/infinite/src/components/InfiniteLoading.vue"]]);export{Y as K};
//# sourceMappingURL=v3-infinite-loading-X6A7v07E.js.map
