import{s as V,es as L,eu as C,K as W,O as H,bM as K,a3 as O,dp as z}from"./index-1OxaEeO3.js";import{T as w,M as J}from"./TextWithHighlights-kUoC0rXY.js";import{G as F,e as r,ag as T,l as s,m as n,I as o,p as I,U as S,M as h,R as p,F as A,a7 as M,S as P,T as B,J as U,r as q,O as D,u as G}from"./vendor-Dv5OeN6t.js";import{_ as N}from"./n8n-4UEsHtUL.js";import{D as Q}from"./NodeDetailsView-DcV7LI-g.js";import"./pinia-sugP77Im.js";import"./axios-Mm4CS0gO.js";import"./flatted-DN8lQ2XG.js";import"./@vueuse/core-BBHtM40w.js";import"./lodash-es-CZ1inz46.js";import"./@n8n/permissions-BxxteU-C.js";import"./dateformat-CIxnBJXX.js";import"./vue-i18n-Delvyc9x.js";import"./uuid-SoommWqA.js";import"./luxon-CLwAIbs0.js";import"./@n8n/codemirror-lang-sql-DBO6T13I.js";import"./@lezer/common-B6ct0j_v.js";import"./prettier-bS6l4Vb1.js";import"./@jsplumb/util-DS-9vq_E.js";import"./@jsplumb/core-CVBraiyY.js";import"./@jsplumb/common-CF-b-6-M.js";import"./@jsplumb/connector-bezier-BGU0Ovbw.js";import"./@jsplumb/browser-ui-BVF2KoJK.js";import"./codemirror-lang-html-n8n-CWDO6_kP.js";import"./@n8n/codemirror-lang-Dl0FW_KM.js";import"./esprima-next-nhoSXAeq.js";import"./fast-json-stable-stringify-BOfzoJX1.js";import"./timeago.js-CiyKClrF.js";import"./qrcode.vue-BGkPba5A.js";import"./vue3-touch-events-mV0oX_Sl.js";import"./chart.js-343vZi4M.js";import"./file-saver-By8WREO3.js";import"./vue-json-pretty-Cqx2Hpq3.js";import"./dateFormatter-CfbOITvW.js";import"./RunDataAi-C3XiqNZa.js";import"./useWorkflowActivate-npf1npdP.js";const X=["title"],Y=["data-value","data-name","data-path","data-depth"],Z=["id"],x=["for"],ee=F({__name:"RunDataSchemaItem",props:{schema:{},level:{},parent:{},subKey:{},paneType:{},mappingEnabled:{type:Boolean},draggingPath:{},distanceFromActive:{},node:{},search:{}},setup(b){const a=b,l=r(()=>Array.isArray(a.schema.value)),y=r(()=>l.value?a.schema.value:[]),m=r(()=>{var e;return((e=a.parent)==null?void 0:e.type)==="array"}),c=r(()=>a.level===0&&Array.isArray(a.schema.value)&&a.schema.value.every(e=>!Array.isArray(e.value))),v=r(()=>m.value?`[${a.schema.key}]`:a.schema.key),k=r(()=>m.value?`${a.schema.type}[${a.schema.key}]`:a.schema.key),_=r(()=>Array.isArray(a.schema.value)?"":V(a.schema.value,600,0)),f=r(()=>a.draggingPath===a.schema.path),t=e=>L({nodeName:a.node.name,distanceFromActive:a.distanceFromActive,path:e}),i=e=>`${e*.033}s`,u=e=>{switch(e){case"object":return"cube";case"array":return"list";case"string":case"null":return"font";case"number":return"hashtag";case"boolean":return"check-square";case"function":return"code";case"bigint":return"calculator";case"symbol":return"sun";case"undefined":return"ban";default:return C(e),""}};return(e,$)=>{var E;const j=T("font-awesome-icon"),R=T("run-data-schema-item",!0);return s(),n("div",{class:o(e.$style.item),"data-test-id":"run-data-schema-item"},[e.level>0||e.level===0&&!l.value?(s(),n("div",{key:0,title:e.schema.type,class:o({[e.$style.pill]:!0,[e.$style.mappable]:e.mappingEnabled,[e.$style.highlight]:f.value})},[I("span",{class:o(e.$style.label),"data-value":t(e.schema.path),"data-name":k.value,"data-path":e.schema.path,"data-depth":e.level,"data-target":"mappable"},[S(j,{icon:u(e.schema.type),size:"sm"},null,8,["icon"]),m.value?(s(),h(w,{key:0,content:(E=a.parent)==null?void 0:E.key,search:a.search},null,8,["content","search"])):p("",!0),v.value?(s(),h(w,{key:1,class:o({[e.$style.arrayIndex]:m.value}),content:v.value,search:a.search},null,8,["class","content","search"])):p("",!0)],10,Y)],10,X)):p("",!0),_.value?(s(),n("span",{key:1,class:o(e.$style.text)},[(s(!0),n(A,null,M(_.value.split(`
`),(g,d)=>(s(),n(A,{key:`line-${d}`},[d>0?(s(),n("span",{key:0,class:o(e.$style.newLine)},"\\n",2)):p("",!0),P(B(g),1)],64))),128))],2)):p("",!0),e.level>0&&l.value?(s(),n("input",{key:2,id:e.subKey,type:"checkbox",checked:""},null,8,Z)):p("",!0),e.level>0&&l.value?(s(),n("label",{key:3,class:o(e.$style.toggle),for:e.subKey},[S(j,{icon:"angle-up"})],10,x)):p("",!0),l.value?(s(),n("div",{key:4,class:o({[e.$style.sub]:!0,[e.$style.flat]:c.value})},[(s(!0),n(A,null,M(y.value,(g,d)=>(s(),h(R,{key:`${g.type}-${e.level}-${d}`,schema:g,level:e.level+1,parent:e.schema,"pane-type":e.paneType,"sub-key":`${e.paneType}_${g.type}-${e.level}-${d}`,"mapping-enabled":e.mappingEnabled,"dragging-path":e.draggingPath,"distance-from-active":e.distanceFromActive,node:e.node,style:U({transitionDelay:i(d)}),search:e.search},null,8,["schema","level","parent","pane-type","sub-key","mapping-enabled","dragging-path","distance-from-active","node","style","search"]))),128))],2)):p("",!0)],2)}}}),ae="_item_jk6di_1",te="_sub_jk6di_14",se="_toggle_jk6di_20",ne="_flat_jk6di_41",re="_pill_jk6di_51",oe="_mappable_jk6di_51",le="_label_jk6di_90",ie="_arrayIndex_jk6di_95",pe="_text_jk6di_101",ce="_newLine_jk6di_110",me={item:ae,sub:te,toggle:se,flat:ne,pill:re,mappable:oe,label:le,arrayIndex:ie,text:pe,newLine:ce},ue={$style:me},de=N(ee,[["__cssModules",ue]]),he=F({__name:"RunDataSchema",props:{data:{},mappingEnabled:{type:Boolean},distanceFromActive:{default:0},runIndex:{},totalRuns:{},paneType:{},node:{},search:{}},setup(b){const a=b,l=q(""),y=W(),{getSchemaForExecutionData:m}=K(),c=r(()=>m(a.data)),v=r(()=>{const t=c.value.type==="object"||c.value.type==="array",i=Array.isArray(c.value.value)&&c.value.value.length===0;return t&&i}),k=r(()=>y.highlightDraggables),_=t=>{var i;(i=t==null?void 0:t.dataset)!=null&&i.path&&(l.value=t.dataset.path),y.resetMappingTelemetry()},f=t=>{l.value="",setTimeout(()=>{var e;const i=y.mappingTelemetry,u={src_node_type:(e=a.node)==null?void 0:e.type,src_field_name:t.dataset.name??"",src_nodes_back:a.distanceFromActive,src_run_index:a.runIndex,src_runs_total:a.totalRuns,src_field_nest_level:t.dataset.depth??0,src_view:"schema",src_element:t,success:!1,...i};O().run("runDataJson.onDragEnd",u),z.track("User dragged data for mapping",u,{withPostHog:!0})},1e3)};return(t,i)=>{const u=T("n8n-info-tip");return s(),n("div",{class:o([t.$style.schemaWrapper,{highlightSchema:k.value}])},[v.value?(s(),h(u,{key:0},{default:D(()=>[P(B(G(H).baseText("dataMapping.schemaView.emptyData")),1)]),_:1})):(s(),h(Q,{key:1,type:"mapping","target-data-key":"mappable",disabled:!t.mappingEnabled,onDragstart:_,onDragend:f},{preview:D(({canDrop:e,el:$})=>[$?(s(),h(J,{key:0,html:$.outerHTML,"can-drop":e},null,8,["html","can-drop"])):p("",!0)]),default:D(()=>[I("div",{class:o(t.$style.schema)},[S(de,{schema:c.value,level:0,parent:null,"pane-type":t.paneType,"sub-key":`${c.value.type}-0-0`,"mapping-enabled":t.mappingEnabled,"dragging-path":l.value,"distance-from-active":t.distanceFromActive,node:t.node,search:t.search},null,8,["schema","pane-type","sub-key","mapping-enabled","dragging-path","distance-from-active","node","search"])],2)]),_:1},8,["disabled"]))],2)}}}),ye="_schemaWrapper_3g73j_1",ge="_schema_3g73j_1",ve={schemaWrapper:ye,schema:ge},_e={$style:ve},aa=N(he,[["__cssModules",_e]]);export{aa as default};
//# sourceMappingURL=RunDataSchema-CF4YH-8y.js.map
