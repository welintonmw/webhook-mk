import{s as v,m as g}from"./pinia-sugP77Im.js";import{j as T}from"./jsonpath-rUxBTvsX.js";import{et as h,K as y,ap as S,aK as b,a6 as J,u as $,n as C,j as D,a4 as x,dQ as k,dO as j,eB as P,x as N}from"./index-1OxaEeO3.js";import{G as I,ag as l,l as d,m as O,M as f,O as r,U as p,S as m,T as u,p as R,I as V}from"./vendor-Dv5OeN6t.js";import{_ as A}from"./n8n-4UEsHtUL.js";import"./axios-Mm4CS0gO.js";import"./flatted-DN8lQ2XG.js";import"./@vueuse/core-BBHtM40w.js";import"./lodash-es-CZ1inz46.js";import"./@n8n/permissions-BxxteU-C.js";import"./dateformat-CIxnBJXX.js";import"./vue-i18n-Delvyc9x.js";import"./uuid-SoommWqA.js";import"./luxon-CLwAIbs0.js";import"./@n8n/codemirror-lang-sql-DBO6T13I.js";import"./@lezer/common-B6ct0j_v.js";import"./prettier-bS6l4Vb1.js";import"./@jsplumb/util-DS-9vq_E.js";import"./@jsplumb/core-CVBraiyY.js";import"./@jsplumb/common-CF-b-6-M.js";import"./@jsplumb/connector-bezier-BGU0Ovbw.js";import"./@jsplumb/browser-ui-BVF2KoJK.js";import"./codemirror-lang-html-n8n-CWDO6_kP.js";import"./@n8n/codemirror-lang-Dl0FW_KM.js";import"./esprima-next-nhoSXAeq.js";import"./fast-json-stable-stringify-BOfzoJX1.js";import"./timeago.js-CiyKClrF.js";import"./qrcode.vue-BGkPba5A.js";import"./vue3-touch-events-mV0oX_Sl.js";import"./chart.js-343vZi4M.js";const B=I({name:"RunDataJsonActions",props:{node:{type:Object,required:!0},paneType:{type:String},pushRef:{type:String},currentOutputIndex:{type:Number},runIndex:{type:Number},displayMode:{type:String},distanceFromActive:{type:Number},selectedJsonPath:{type:String,default:h},jsonData:{type:Array,required:!0}},setup(){const t=y(),e=N(),o=S(),s=b(),{activeNode:n}=v(t),a=J(n);return{i18n:e,nodeHelpers:o,clipboard:s,pinnedData:a,...$()}},computed:{...g(x,y,D,C),isReadOnlyRoute(){var t,e;return((e=(t=this.$route)==null?void 0:t.meta)==null?void 0:e.readOnlyCanvas)===!0},activeNode(){return this.ndvStore.activeNode},noSelection(){return this.selectedJsonPath===h},normalisedJsonPath(){return this.noSelection?'[""]':this.selectedJsonPath}},methods:{getJsonValue(){let t=T.query(this.jsonData,`$${this.normalisedJsonPath}`)[0];if(this.noSelection){const o=window!==window.parent&&window.parent.location.pathname.includes("/executions");this.pinnedData.hasData.value&&!o?t=k(this.pinnedData.data.value):t=j(this.nodeHelpers.getNodeInputData(this.node,this.runIndex,this.currentOutputIndex))}let e="";return typeof t=="object"?e=JSON.stringify(t,null,2):e=t.toString(),e},getJsonItemPath(){const t=P(this.normalisedJsonPath);let e="",o="";const s=t.split("]"),n=s[0].slice(1);return o=s.slice(1).join("]"),e=`$item(${n}).$node["${this.node.name}"].json`,{path:o,startPath:e}},getJsonParameterPath(){const e=P(this.normalisedJsonPath).split("]").slice(1).join("]");let o=`$node["${this.node.name}"].json`;return this.distanceFromActive===1&&(o="$json"),{path:e,startPath:o}},handleCopyClick(t){var s;let e;if(t.command==="value")e=this.getJsonValue(),this.showToast({title:this.i18n.baseText("runData.copyValue.toast"),message:"",type:"success",duration:2e3});else{let n="",a="";if(t.command==="itemPath"){const i=this.getJsonItemPath();n=i.startPath,a=i.path,this.showToast({title:this.i18n.baseText("runData.copyItemPath.toast"),message:"",type:"success",duration:2e3})}else if(t.command==="parameterPath"){const i=this.getJsonParameterPath();n=i.startPath,a=i.path,this.showToast({title:this.i18n.baseText("runData.copyParameterPath.toast"),message:"",type:"success",duration:2e3})}!a.startsWith("[")&&!a.startsWith(".")&&a&&(a+="."),e=`{{ ${n+a} }}`}const o={value:"selection",itemPath:"item_path",parameterPath:"parameter_path"}[t.command];this.$telemetry.track("User copied ndv data",{node_type:(s=this.activeNode)==null?void 0:s.type,push_ref:this.pushRef,run_index:this.runIndex,view:"json",copy_type:o,workflow_id:this.workflowsStore.workflowId,pane:this.paneType,in_execution_log:this.isReadOnlyRoute}),this.clipboard.copy(e)}}}),G="_actionsGroup_wlnwy_1",M={actionsGroup:G},q={class:"el-dropdown-link"};function E(t,e,o,s,n,a){const i=l("n8n-icon-button"),c=l("el-dropdown-item"),_=l("el-dropdown-menu"),w=l("el-dropdown");return d(),O("div",{class:V(t.$style.actionsGroup)},[t.noSelection?(d(),f(i,{key:0,title:t.i18n.baseText("runData.copyToClipboard"),icon:"copy",type:"tertiary",circle:!1,onClick:e[0]||(e[0]=H=>t.handleCopyClick({command:"value"}))},null,8,["title"])):(d(),f(w,{key:1,trigger:"click",onCommand:t.handleCopyClick},{dropdown:r(()=>[p(_,null,{default:r(()=>[p(c,{command:{command:"value"}},{default:r(()=>[m(u(t.i18n.baseText("runData.copyValue")),1)]),_:1}),p(c,{command:{command:"itemPath"},divided:""},{default:r(()=>[m(u(t.i18n.baseText("runData.copyItemPath")),1)]),_:1}),p(c,{command:{command:"parameterPath"}},{default:r(()=>[m(u(t.i18n.baseText("runData.copyParameterPath")),1)]),_:1})]),_:1})]),default:r(()=>[R("span",q,[p(i,{title:t.i18n.baseText("runData.copyToClipboard"),icon:"copy",type:"tertiary",circle:!1},null,8,["title"])])]),_:1},8,["onCommand"]))],2)}const F={$style:M},gt=A(B,[["render",E],["__cssModules",F]]);export{gt as default};
//# sourceMappingURL=RunDataJsonActions-BQBpmtOi.js.map
