import{aH as _,e as V,af as l}from"./vendor-Dv5OeN6t.js";import{u as S,j as I,b as W,e as B,E as C,A as P,V as L,l as v,cI as A,cJ as E,G as O,x as U,H as R}from"./index-1OxaEeO3.js";const K=()=>{const h=O(),T=_(),t=U(),N=R(),g=S(),s=I(),M=W(),c=B(),k=V(()=>M.isEnterpriseFeatureEnabled(C.DebugInEditor));return{applyExecutionData:async o=>{var D;const a=await s.getExecution(o),m=s.getCurrentWorkflow(),f=s.getNodes();if(!((D=a==null?void 0:a.data)!=null&&D.resultData))return;const{runData:b}=a.data.resultData,p=Object.keys(b),u=p.filter(e=>!f.some(i=>i.name===e)),y=Object.keys(s.workflow.pinData??{}),d=p.filter(e=>y.includes(e));if(d.length>0){const e=l("p",[t.baseText("nodeView.confirmMessage.debug.message"),l("ul",{class:"mt-l ml-l"},d.map(n=>l("li",n)))]);if(await N.confirm(e,t.baseText("nodeView.confirmMessage.debug.headline"),{type:"warning",confirmButtonText:t.baseText("nodeView.confirmMessage.debug.confirmButtonText"),cancelButtonText:t.baseText("nodeView.confirmMessage.debug.cancelButtonText"),dangerouslyUseHTMLString:!0,customClass:"matching-pinned-nodes-confirmation"})===P)d.forEach(n=>{const r=s.getNodeByName(n);r&&s.unpinData({node:r})});else{await T.push({name:L.EXECUTION_PREVIEW,params:{name:m.id,executionId:o}});return}}s.setWorkflowExecutionData(a);const w=f.filter(e=>!m.getParentNodes(e.name).length);let x=0;w.forEach(e=>{var n,r;const i=(r=(n=b[e.name])==null?void 0:n[0].data)==null?void 0:r.main[0];i&&(x++,s.pinData({node:e,data:i}))}),g.showToast({title:t.baseText("nodeView.showMessage.debug.title"),message:t.baseText("nodeView.showMessage.debug.content"),type:"info"}),u.length&&g.showToast({title:t.baseText("nodeView.showMessage.debug.missingNodes.title"),message:t.baseText("nodeView.showMessage.debug.missingNodes.content",{interpolate:{nodeNames:u.join(", ")}}),type:"warning"}),h.track("User clicked debug execution button",{instance_id:v().instanceId,exec_status:A(a)?a.status:"",override_pinned_data:w.length===x,all_exec_data_imported:u.length===0})},handleDebugLinkClick:o=>{if(!k.value){c.openModalWithData({name:E,data:{title:t.baseText(c.contextBasedTranslationKeys.feature.unavailable.title),footerButtonAction:()=>{c.closeModal(E),c.goToUpgrade("debug","upgrade-debug")}}}),o.preventDefault(),o.stopPropagation();return}s.isInDebugMode=!1}}};export{K as u};
//# sourceMappingURL=useExecutionDebugging-EHinBq_u.js.map
