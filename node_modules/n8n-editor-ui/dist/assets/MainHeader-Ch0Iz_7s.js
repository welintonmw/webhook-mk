import{G as C,l as d,m as S,H as oe,ag as N,M as F,O,p as R,a7 as Je,F as qe,J as Qe,I,S as se,T as z,U as g,e as h,r as W,b as re,y as fe,aq as Ze,P as Be,a8 as Ee,d as pe,a2 as et,n as tt,aH as Me,az as Ce,u as y,R as ne,av as ot,D as at,V as st}from"./vendor-Dv5OeN6t.js";import{s as nt,c as $e,d as rt,e as ve,B as Te,f as ye,g as Oe,h as Se,i as lt,a as Ne,j as we,k as it,T as ut,l as ct,m as dt,b as mt,n as Re,o as ft,p as pt,u as vt,q as wt,P as te,V as k,r as bt,W as B,t as ht,E as Ie,v as _t,w as kt,S as gt,x as Le,y as Et,z as We,A as Tt,C as yt,D as Ot,F as St,G as It,H as Wt,I as Bt,J as A,K as Mt,L as Ct,N as $t}from"./index-1OxaEeO3.js";import{_ as V,b as G}from"./n8n-4UEsHtUL.js";import{m as Nt}from"./pinia-sugP77Im.js";import{d as Rt}from"./lodash-es-CZ1inz46.js";import{P as Lt}from"./PushConnectionTracker-Bp-RjnYr.js";import{W as Dt}from"./WorkflowActivator-BXWURYao.js";import{u as xt}from"./collaboration.store-Ol7bcCFc.js";import{F as Ut}from"./file-saver-By8WREO3.js";import{u as At}from"./usePushConnection-PQgFeT_8.js";import"./axios-Mm4CS0gO.js";import"./flatted-DN8lQ2XG.js";import"./@vueuse/core-BBHtM40w.js";import"./@n8n/permissions-BxxteU-C.js";import"./dateformat-CIxnBJXX.js";import"./vue-i18n-Delvyc9x.js";import"./uuid-SoommWqA.js";import"./luxon-CLwAIbs0.js";import"./@n8n/codemirror-lang-sql-DBO6T13I.js";import"./@lezer/common-B6ct0j_v.js";import"./prettier-bS6l4Vb1.js";import"./@jsplumb/util-DS-9vq_E.js";import"./@jsplumb/core-CVBraiyY.js";import"./@jsplumb/common-CF-b-6-M.js";import"./@jsplumb/connector-bezier-BGU0Ovbw.js";import"./@jsplumb/browser-ui-BVF2KoJK.js";import"./codemirror-lang-html-n8n-CWDO6_kP.js";import"./@n8n/codemirror-lang-Dl0FW_KM.js";import"./esprima-next-nhoSXAeq.js";import"./fast-json-stable-stringify-BOfzoJX1.js";import"./timeago.js-CiyKClrF.js";import"./qrcode.vue-BGkPba5A.js";import"./vue3-touch-events-mV0oX_Sl.js";import"./chart.js-343vZi4M.js";import"./useWorkflowActivate-npf1npdP.js";const Ft=25,Vt=4,Pt=C({name:"ShortenName",props:["name","limit","testId"],computed:{shortenedName(){return nt(this.name,this.limit||Ft,Vt)}}}),Kt=["title","data-test-id"];function Ht(s,e,a,n,o,l){return d(),S("span",{title:s.name,"data-test-id":s.testId},[oe(s.$slots,"default",{shortenedName:s.shortenedName})],8,Kt)}const Xt=V(Pt,[["render",Ht]]),jt=C({name:"IntersectionObserver",props:{threshold:{type:Number,default:0},enabled:{type:Boolean,default:!1},eventBus:{type:Object,default:()=>G()}},data(){return{observer:null}},mounted(){if(!this.enabled)return;const s={root:this.$refs.root,rootMargin:"0px",threshold:this.threshold},e=new IntersectionObserver(a=>{a.forEach(({target:n,isIntersecting:o})=>{this.$emit("observed",{el:n,isIntersecting:o})})},s);this.observer=e,this.eventBus.on("observe",a=>{a&&e.observe(a)}),this.eventBus.on("unobserve",a=>{e.unobserve(a)})},beforeUnmount(){this.enabled&&this.observer&&this.observer.disconnect()}}),zt={ref:"root"};function Gt(s,e,a,n,o,l){return d(),S("div",zt,[oe(s.$slots,"default")],512)}const Yt=V(jt,[["render",Gt]]),Jt=C({name:"IntersectionObserved",props:{enabled:{type:Boolean,default:!1},eventBus:{type:Object,default:()=>G()}},async mounted(){this.enabled&&(await this.$nextTick(),this.eventBus.emit("observe",this.$refs.observed))},beforeUnmount(){this.enabled&&this.eventBus.emit("unobserve",this.$refs.observed)}}),qt={ref:"observed"};function Qt(s,e,a,n,o,l){return d(),S("span",qt,[oe(s.$slots,"default")],512)}const Zt=V(Jt,[["render",Qt]]),eo=20,to=C({name:"TagsContainer",components:{IntersectionObserver:Yt,IntersectionObserved:Zt},props:{tagIds:{type:Array,required:!0},limit:{type:Number,default:eo},clickable:Boolean,responsive:Boolean,hoverable:Boolean},emits:{click:null},data(){return{maxWidth:320,intersectionEventBus:G(),visibility:{},debouncedSetMaxWidth:()=>{}}},computed:{...Nt($e),style(){return{"max-width":`${this.maxWidth}px`}},tags(){const s=this.tagIds.map(n=>this.tagsStore.getTagById(n)).filter(Boolean);let e=this.limit?s.slice(0,this.limit):s;e=e.map(n=>({...n,hidden:this.responsive&&!this.visibility[n.id]}));let a=e.length;if(this.responsive&&(a=Object.values(this.visibility).reduce((n,o)=>o?n+1:n,0)),a<s.length){const n=s.slice(a),o=n.reduce((m,E)=>m?`${m}, ${E.name}`:E.name,""),l={id:"count",name:`+${n.length}`,title:o,isCount:!0};e.splice(a,0,l)}return e}},created(){this.debouncedSetMaxWidth=Rt(this.setMaxWidth,100)},mounted(){this.setMaxWidth(),window.addEventListener("resize",this.debouncedSetMaxWidth)},beforeUnmount(){window.removeEventListener("resize",this.debouncedSetMaxWidth)},methods:{setMaxWidth(){const a=this.$refs.tagsContainer.$el.parentNode;a&&(this.maxWidth=0,this.$nextTick(()=>{this.maxWidth=a.clientWidth}))},onObserved({el:s,isIntersecting:e}){s.dataset.id&&(this.visibility={...this.visibility,[s.dataset.id]:e})},onClick(s,e){this.clickable&&s.stopPropagation(),e.hidden||this.$emit("click",e.id)}}}),oo={class:"tags"},ao=["onClick"];function so(s,e,a,n,o,l){const m=N("el-tag"),E=N("IntersectionObserved"),f=N("IntersectionObserver");return d(),F(f,{ref:"tagsContainer",threshold:1,class:"tags-container",style:Qe(s.style),enabled:s.responsive,"event-bus":s.intersectionEventBus,onObserved:s.onObserved},{default:O(()=>[R("span",oo,[(d(!0),S(qe,null,Je(s.tags,p=>(d(),S("span",{key:p.id,class:I({clickable:!p.hidden}),onClick:u=>s.onClick(u,p)},[p.isCount?(d(),F(m,{key:0,title:p.title,type:"info",size:"small",class:"count-container","disable-transitions":!0},{default:O(()=>[se(z(p.name),1)]),_:2},1032,["title"])):(d(),F(E,{key:1,class:I({hideTag:p.hidden}),"data-id":p.id,enabled:s.responsive,"event-bus":s.intersectionEventBus},{default:O(()=>[g(m,{title:p.name,type:"info",size:"small",class:I({hoverable:s.hoverable}),"disable-transitions":!0},{default:O(()=>[se(z(p.name),1)]),_:2},1032,["title","class"])]),_:2},1032,["class","data-id","enabled","event-bus"]))],10,ao))),128))])]),_:1},8,["style","enabled","event-bus","onObserved"])}const no=V(to,[["render",so],["__scopeId","data-v-f4d542ee"]]),ro=["data-value"],lo=C({__name:"ExpandableInputBase",props:{modelValue:{},placeholder:{default:""},staticSize:{type:Boolean,default:!1}},setup(s){const e=s,a=h(()=>{let n=e.modelValue.replace(/\s/g,".");return n||(n=e.placeholder),`${n}`});return(n,o)=>(d(),S("div",{class:I({"el-input":!0,"static-size":n.staticSize}),"data-value":a.value},[oe(n.$slots,"default",{},void 0,!0)],10,ro))}}),De=V(lo,[["__scopeId","data-v-79df6a46"]]),io=["value","placeholder","maxlength"],uo=C({__name:"ExpandableInputEdit",props:{modelValue:{},placeholder:{},maxlength:{},autofocus:{type:Boolean},eventBus:{}},emits:["update:model-value","enter","blur","esc"],setup(s,{emit:e}){const a=s,n=e,o=W();re(()=>{var u;a.autofocus&&o.value&&l(),(u=a.eventBus)==null||u.on("focus",l)}),fe(()=>{var u;(u=a.eventBus)==null||u.off("focus",l)});function l(){o.value&&o.value.focus()}function m(){o.value&&n("update:model-value",o.value.value)}function E(){o.value&&n("enter",o.value.value)}function f(u){u.type==="click"&&o.value&&n("blur",o.value.value)}function p(){n("esc")}return(u,_)=>{const M=Ze("on-click-outside");return d(),F(De,{"model-value":u.modelValue,placeholder:u.placeholder},{default:O(()=>[Be(R("input",{ref_key:"inputRef",ref:o,class:"el-input__inner",value:u.modelValue,placeholder:u.placeholder,maxlength:u.maxlength,size:"4",onInput:m,onKeydown:[Ee(E,["enter"]),Ee(p,["esc"])]},null,40,io),[[M,f]])]),_:1},8,["model-value","placeholder"])}}}),co=["value"],mo=C({__name:"ExpandableInputPreview",props:{modelValue:{}},setup(s){return(e,a)=>(d(),F(De,{"model-value":e.modelValue,"static-size":!0},{default:O(()=>[R("input",{class:I({"el-input__inner":!0,clickable:!0}),value:e.modelValue,disabled:!0,size:"4"},null,8,co)]),_:1},8,["model-value"]))}}),fo=V(mo,[["__scopeId","data-v-9754ec4b"]]),po={key:0},vo=C({__name:"InlineTextEdit",props:{isEditEnabled:{type:Boolean,default:!1},modelValue:{default:""},placeholder:{default:""},maxLength:{default:0},previewValue:{default:""},disabled:{type:Boolean,default:!1}},emits:["toggle","submit"],setup(s,{emit:e}){const a=s,n=e,o=W(a.disabled),l=W(""),m=W(!1),E=W(G());pe(()=>a.disabled,v=>{o.value=v});function f(v){o.value||(l.value=v)}function p(){o.value||(l.value=a.modelValue,n("toggle"))}function u(){o.value||(m.value||_(),m.value=!1)}function _(){if(o.value)return;const v=T=>{o.value=!1,T||E.value.emit("focus")};o.value=!0,n("submit",{name:l.value,onSubmit:v})}function M(){o.value||(m.value=!0,n("toggle"))}return(v,T)=>(d(),S("span",{class:"inline-edit",onKeydown:T[1]||(T[1]=et(()=>{},["stop"]))},[v.isEditEnabled&&!o.value?(d(),S("span",po,[g(uo,{modelValue:l.value,"onUpdate:modelValue":[T[0]||(T[0]=r=>l.value=r),f],placeholder:v.placeholder,maxlength:v.maxLength,autofocus:!0,"event-bus":E.value,onEsc:M,onBlur:u,onEnter:_},null,8,["modelValue","placeholder","maxlength","event-bus"])])):(d(),S("span",{key:1,class:"preview",onClick:p},[g(fo,{"model-value":v.previewValue||v.modelValue},null,8,["model-value"])]))],32))}}),wo=V(vo,[["__scopeId","data-v-7b84e96b"]]),bo=C({__name:"BreakpointsObserver",props:{valueXS:{},valueXL:{},valueLG:{},valueMD:{},valueSM:{},valueDefault:{}},setup(s){const e=s,{callDebounced:a}=rt(),n=ve(),o=W(window.innerWidth),l=h(()=>o.value<Te?"XS":o.value>=ye?"XL":o.value>=Oe?"LG":o.value>=Se?"MD":"SM"),m=h(()=>e.valueXS&&o.value<Te?e.valueXS:e.valueXL&&o.value>=ye?e.valueXL:e.valueLG&&o.value>=Oe?e.valueLG:e.valueMD&&o.value>=Se?e.valueMD:e.valueSM?e.valueSM:e.valueDefault),E=()=>{a(f,{debounceTime:50})},f=async()=>{o.value=window.innerWidth,await tt();const p=await lt();n.updateBannersHeight(p)};return re(()=>{window.addEventListener("resize",E)}),fe(()=>{window.removeEventListener("resize",E)}),(p,u)=>(d(),S("span",null,[oe(p.$slots,"default",{bp:l.value,value:m.value})]))}}),ho=C({__name:"CollaborationPane",setup(s){const e=xt(),a=Ne(),n=we(),o=5*ut.MINUTE,l=W(null),m=h(()=>{const _=(e.getUsersForCurrentWorkflow??[]).map(v=>v.user),M=_.find(it);return{defaultGroup:M?[M,..._.filter(v=>v.id!==M.id)]:_}}),E=h(()=>{var _;return(_=a.currentUser)==null?void 0:_.email}),f=()=>{l.value!==null&&(clearInterval(l.value),l.value=null),l.value=window.setInterval(()=>{e.notifyWorkflowOpened(n.workflow.id)},o)},p=()=>{l.value!==null&&clearInterval(l.value)},u=()=>{document.visibilityState==="hidden"?p():f()};return re(()=>{e.initialize(),f(),document.addEventListener("visibilitychange",u)}),fe(()=>{document.removeEventListener("visibilitychange",u),p(),e.terminate()}),(_,M)=>{const v=N("n8n-user-stack");return d(),S("div",{class:I(`collaboration-pane-container ${_.$style.container}`),"data-test-id":"collaboration-pane"},[g(v,{users:m.value,"current-user-email":E.value},null,8,["users","current-user-email"])],2)}}}),_o="_container_iuui0_1",ko={container:_o},go={$style:ko},Eo=V(ho,[["__cssModules",go]]),To={key:0,class:"tags","data-test-id":"workflow-tags-container"},yo={key:1},Oo={key:1,class:"tags"},So=C({__name:"WorkflowDetails",props:{workflow:{},readOnly:{type:Boolean}},setup(s){const e=s,a=ot(),n=ct(),o=dt(),l=mt(),m=Re(),E=$e(),f=ve(),p=Ne(),u=we(),_=ft(),M=pt(),v=Me(),T=Ce(),r=Le(),Y=It(),J=Wt(),L=vt(),le=Bt(),X=wt({router:v}),D=W(!1),U=W(!1),j=W([]),q=W(!1),b=W(),w=G(),$=G(),Q=(t,c)=>{if(t.length!==c.length)return!0;const i=new Set(t);return c.reduce((x,K)=>x||!i.has(K),!1)},P=h(()=>!e.workflow.id||e.workflow.id===te||e.workflow.id==="new"),ae=h(()=>f.isActionActive("workflowSaving")),H=h(()=>T.meta&&(T.meta.nodeView||T.meta.keepWorkflowAlive===!0)),ie=h(()=>[k.EXECUTION_HOME.toString(),k.WORKFLOW_EXECUTIONS.toString(),k.EXECUTION_PREVIEW].includes(T.name||"")),xe=h(()=>bt(u.getWorkflowById(e.workflow.id))),Ue=h(()=>{const t=[{id:B.DOWNLOAD,label:r.baseText("menuActions.download"),disabled:!H.value}];return e.readOnly||(t.unshift({id:B.DUPLICATE,label:r.baseText("menuActions.duplicate"),disabled:!H.value||!e.workflow.id}),t.push({id:B.IMPORT_FROM_URL,label:r.baseText("menuActions.importFromUrl"),disabled:!H.value||ie.value},{id:B.IMPORT_FROM_FILE,label:r.baseText("menuActions.importFromFile"),disabled:!H.value||ie.value})),ht(["rbac"],{rbac:{scope:"sourceControl:push"}})&&t.push({id:B.PUSH,label:r.baseText("menuActions.push"),disabled:!m.isEnterpriseSourceControlEnabled||!H.value||ie.value||m.preferences.branchReadOnly}),t.push({id:B.SETTINGS,label:r.baseText("generic.settings"),disabled:!H.value||P.value}),(xe.value.delete&&!e.readOnly||P.value)&&t.push({id:B.DELETE,label:r.baseText("menuActions.delete"),disabled:!H.value||P.value,customClass:a.deleteItem,divided:!0}),t}),Ae=h(()=>l.isEnterpriseFeatureEnabled(Ie.WorkflowHistory)),Fe=h(()=>({name:k.WORKFLOW_HISTORY,params:{workflowId:e.workflow.id}})),Ve=h(()=>P.value),Pe=h(()=>(e.workflow.tags??[]).map(t=>typeof t=="string"?t:t.id));pe(()=>e.workflow.id,()=>{D.value=!1,U.value=!1});function be(){let t;return e.workflow.id!==te?t=e.workflow.id:T.params.name&&T.params.name!=="new"&&(t=T.params.name),t}async function he(){if(ae.value)return;const t=be(),c=e.workflow.name,i=e.workflow.tags;await X.saveCurrentWorkflow({id:t,name:c,tags:i})&&(ge(t),await M.fetchPromptsData(),T.name===k.EXECUTION_DEBUG&&await v.replace({name:k.WORKFLOW,params:{name:e.workflow.id}}))}function Ke(){var t;f.openModalWithData({name:Et,data:{id:e.workflow.id}}),Y.track("User opened sharing modal",{workflow_id:e.workflow.id,user_id_sharer:(t=p.currentUser)==null?void 0:t.id,sub_view:T.name===k.WORKFLOWS?"Workflows listing":"Workflow editor"})}function _e(){j.value=e.workflow.tags??[],D.value=!0,setTimeout(()=>{U.value=!1,w.emit("focus")},0)}async function ke(){const t=e.workflow.tags??[],c=j.value;if(!Q(t,c)){D.value=!1;return}if(q.value)return;q.value=!0;const i=await X.saveCurrentWorkflow({tags:c});Y.track("User edited workflow tags",{workflow_id:e.workflow.id,new_tag_count:c.length}),q.value=!1,i&&(D.value=!1)}function He(){D.value=!1}function Xe(){U.value=!U.value,U.value&&(D.value&&ke(),D.value=!1)}async function je({name:t,onSubmit:c}){const i=t.trim();if(!i){L.showMessage({title:r.baseText("workflowDetails.showMessage.title"),message:r.baseText("workflowDetails.showMessage.message"),type:"error"}),c(!1);return}if(i===e.workflow.name){U.value=!1,c(!0);return}f.addActiveAction("workflowSaving");const x=be(),K=await X.saveCurrentWorkflow({name:t});K&&(U.value=!1,ge(x)),f.removeActiveAction("workflowSaving"),c(K)}async function ze(){const t=b.value;if(t!=null&&t.files&&t.files.length!==0){const c=new FileReader;c.onload=()=>{let i;try{i=JSON.parse(c.result)}catch{L.showMessage({title:r.baseText("mainSidebar.showMessage.handleFileImport.title"),message:r.baseText("mainSidebar.showMessage.handleFileImport.message"),type:"error"});return}finally{c.onload=null,t.value=""}We.emit("importWorkflowData",{data:i})},c.readAsText(t.files[0])}}async function Ge(t){var c;switch(t){case B.DUPLICATE:{f.openModalWithData({name:St,data:{id:e.workflow.id,name:e.workflow.name,tags:e.workflow.tags}});break}case B.DOWNLOAD:{const i=await X.getWorkflowDataToSave(),{tags:x,...K}=i,ue={...K,meta:{...e.workflow.meta,instanceId:n.instanceId},tags:(x??[]).map(de=>{const{usageCount:ee,...me}=E.getTagById(de);return me})},ce=new Blob([JSON.stringify(ue,null,2)],{type:"application/json;charset=utf-8"});let Z=e.workflow.name||"unsaved_workflow";Z=Z.replace(/[^a-z0-9]/gi,"_"),Y.track("User exported workflow",{workflow_id:i.id}),Ut.saveAs(ce,Z+".json");break}case B.IMPORT_FROM_URL:{try{const i=await J.prompt(r.baseText("mainSidebar.prompt.workflowUrl")+":",r.baseText("mainSidebar.prompt.importWorkflowFromUrl")+":",{confirmButtonText:r.baseText("mainSidebar.prompt.import"),cancelButtonText:r.baseText("mainSidebar.prompt.cancel"),inputErrorMessage:r.baseText("mainSidebar.prompt.invalidUrl"),inputPattern:/^http[s]?:\/\/.*\.json$/i});if(i.action==="cancel")return;We.emit("importWorkflowUrl",{url:i.value})}catch{}break}case B.IMPORT_FROM_FILE:{(c=b.value)==null||c.click();break}case B.PUSH:{o.startLoading();try{await he();const i=await m.getAggregatedStatus();f.openModalWithData({name:Ot,data:{eventBus:$,status:i}})}catch(i){switch(i.message){case"source_control_not_connected":L.showError({...i,message:""},r.baseText("settings.sourceControl.error.not.connected.title"),r.baseText("settings.sourceControl.error.not.connected.message"));break;default:L.showError(i,r.baseText("error"))}}finally{o.stopLoading()}break}case B.SETTINGS:{f.openModal(yt);break}case B.DELETE:{if(await J.confirm(r.baseText("mainSidebar.confirmMessage.workflowDelete.message",{interpolate:{workflowName:e.workflow.name}}),r.baseText("mainSidebar.confirmMessage.workflowDelete.headline"),{type:"warning",confirmButtonText:r.baseText("mainSidebar.confirmMessage.workflowDelete.confirmButtonText"),cancelButtonText:r.baseText("mainSidebar.confirmMessage.workflowDelete.cancelButtonText")})!==Tt)return;try{await u.deleteWorkflow(e.workflow.id)}catch(x){L.showError(x,r.baseText("generic.deleteWorkflowError"));return}f.stateIsDirty=!1,le.titleReset(),L.showMessage({title:r.baseText("mainSidebar.showMessage.handleSelect1.title"),type:"success"}),await v.push({name:k.WORKFLOWS});break}}}function Ye(){f.goToUpgrade("workflow_sharing","upgrade-workflow-sharing")}function ge(t){if(!t||["new",te].includes(t)){let c=r.baseText("workflows.create.personal.toast.title"),i=r.baseText("workflows.create.personal.toast.text");_.currentProject&&(c=r.baseText("workflows.create.project.toast.title",{interpolate:{projectName:_.currentProject.name??""}}),i=r.baseText("workflows.create.project.toast.text",{interpolate:{projectName:_.currentProject.name??""}})),L.showMessage({title:c,message:i,type:"success"})}}return(t,c)=>{const i=N("N8nButton"),x=N("i18n-t"),K=N("N8nTooltip"),ue=N("EnterpriseEdition"),ce=N("N8nIconButton"),Z=N("RouterLink"),de=N("N8nActionDropdown");return d(),S("div",{class:I(y(a).container)},[g(bo,{"value-x-s":15,"value-s-m":25,"value-m-d":50,class:"name-container"},{default:O(({value:ee})=>[g(Xt,{name:t.workflow.name,limit:ee,custom:!0,"test-id":"workflow-name-input"},{default:O(({shortenedName:me})=>[g(wo,{"model-value":t.workflow.name,"preview-value":me,"is-edit-enabled":U.value,"max-length":y(_t),disabled:t.readOnly,placeholder:"Enter workflow name",class:"name",onToggle:Xe,onSubmit:je},null,8,["model-value","preview-value","is-edit-enabled","max-length","disabled"])]),_:2},1032,["name","limit"])]),_:1}),y(l).areTagsEnabled?(d(),S("span",To,[D.value&&!t.readOnly?(d(),F(kt,{key:0,ref:"dropdown",modelValue:j.value,"onUpdate:modelValue":c[0]||(c[0]=ee=>j.value=ee),"create-enabled":!0,"event-bus":y(w),placeholder:t.$locale.baseText("workflowDetails.chooseOrCreateATag"),class:"tags-edit","data-test-id":"workflow-tags-dropdown",onBlur:ke,onEsc:He},null,8,["modelValue","event-bus","placeholder"])):(t.workflow.tags??[]).length===0&&!t.readOnly?(d(),S("div",yo,[R("span",{class:"add-tag clickable","data-test-id":"new-tag-link",onClick:_e}," + "+z(t.$locale.baseText("workflowDetails.addTag")),1)])):(d(),F(no,{key:t.workflow.id,"tag-ids":Pe.value,clickable:!0,responsive:!0,"data-test-id":"workflow-tags",onClick:_e},null,8,["tag-ids"]))])):(d(),S("span",Oo)),g(Lt,{class:"actions"},{default:O(()=>[R("span",{class:I(`activator ${y(a).group}`)},[g(Dt,{"workflow-active":t.workflow.active,"workflow-id":t.workflow.id},null,8,["workflow-active","workflow-id"])],2),g(ue,{features:[y(Ie).Sharing]},{fallback:O(()=>[g(K,null,{content:O(()=>[g(x,{keypath:y(f).contextBasedTranslationKeys.workflows.sharing.unavailable.description.tooltip,tag:"span"},{action:O(()=>[R("a",{onClick:Ye},z(t.$locale.baseText(y(f).contextBasedTranslationKeys.workflows.sharing.unavailable.button)),1)]),_:1},8,["keypath"])]),default:O(()=>[g(i,{type:"secondary",class:I(["mr-2xs",y(a).disabledShareButton])},{default:O(()=>[se(z(t.$locale.baseText("workflowDetails.share")),1)]),_:1},8,["class"])]),_:1})]),default:O(()=>[R("div",{class:I(y(a).group)},[g(Eo),g(i,{type:"secondary","data-test-id":"workflow-share-button",onClick:Ke},{default:O(()=>[se(z(t.$locale.baseText("workflowDetails.share")),1)]),_:1})],2)]),_:1},8,["features"]),R("div",{class:I(y(a).group)},[g(gt,{type:"primary",saved:!y(f).stateIsDirty&&!P.value,disabled:ae.value||t.readOnly,"with-shortcut":"","shortcut-tooltip":t.$locale.baseText("saveWorkflowButton.hint"),"data-test-id":"workflow-save-button",onClick:he},null,8,["saved","disabled","shortcut-tooltip"]),Ae.value?(d(),F(Z,{key:0,to:Fe.value,class:I(y(a).workflowHistoryButton)},{default:O(()=>[g(ce,{disabled:Ve.value,"data-test-id":"workflow-history-button",type:"tertiary",icon:"history",size:"medium",text:""},null,8,["disabled"])]),_:1},8,["to","class"])):ne("",!0)],2),R("div",{class:I([y(a).workflowMenuContainer,y(a).group])},[R("input",{ref_key:"importFileRef",ref:b,class:I(y(a).hiddenInput),type:"file","data-test-id":"workflow-import-input",onChange:c[1]||(c[1]=ee=>ze())},null,34),g(de,{items:Ue.value,"data-test-id":"workflow-menu",onSelect:Ge},null,8,["items"])],2)]),_:1})],2)}}}),Io="_container_osj4g_1",Wo="_group_osj4g_9",Bo="_hiddenInput_osj4g_14",Mo="_deleteItem_osj4g_18",Co="_disabledShareButton_osj4g_22",$o="_workflowHistoryButton_osj4g_26",No={container:Io,group:Wo,hiddenInput:Bo,deleteItem:Mo,disabledShareButton:Co,workflowHistoryButton:$o},Ro={$style:No},Lo=V(So,[["__cssModules",Ro],["__scopeId","data-v-3db4d320"]]),Do=C({__name:"TabBar",props:{items:{},modelValue:{default:A.WORKFLOW}},emits:["update:modelValue"],setup(s,{emit:e}){const a=e;function n(o,l){a("update:modelValue",o,l)}return(o,l)=>{const m=N("N8nRadioButtons");return o.items?(d(),S("div",{key:0,class:I({[o.$style.container]:!0,"tab-bar-container":!0})},[g(m,{"model-value":o.modelValue,options:o.items,"onUpdate:modelValue":n},null,8,["model-value","options"])],2)):ne("",!0)}}}),xo="_container_1ndnk_1",Uo={container:xo},Ao={$style:Uo},Fo=V(Do,[["__cssModules",Ao]]),Vo={class:"top-menu"},Ta=C({__name:"MainHeader",setup(s){const e=Me(),a=Ce(),n=Le(),o=At({router:e}),l=Mt(),m=ve(),E=Re(),f=we(),p=Ct(),u=W(A.WORKFLOW),_=W(""),M=W(""),v=W(!1),T=h(()=>[{value:A.WORKFLOW,label:n.baseText("generic.editor")},{value:A.EXECUTIONS,label:n.baseText("generic.executions")}]),r=h(()=>l.activeNode),Y=h(()=>!!(r.value&&r.value.type!==$t)),J=h(()=>f.workflow),L=h(()=>String(e.currentRoute.value.params.name||f.workflowId)),le=h(()=>!!(a.meta.nodeView||a.meta.keepWorkflowAlive)),X=h(()=>E.preferences.branchReadOnly);pe(a,(b,w)=>{D(b,w)}),at(()=>{o.initialize()}),re(async()=>{v.value=m.stateIsDirty,D(a)});function D(b,w){b.name===k.EXECUTION_HOME||b.name===k.WORKFLOW_EXECUTIONS||b.name===k.EXECUTION_PREVIEW?u.value=A.EXECUTIONS:(b.name===k.WORKFLOW||b.name===k.NEW_WORKFLOW||b.name===k.EXECUTION_DEBUG)&&(u.value=A.WORKFLOW),b.params.name!=="new"&&typeof b.params.name=="string"&&(_.value=b.params.name),(w==null?void 0:w.name)===k.EXECUTION_PREVIEW&&b.params.name===w.params.name&&typeof w.params.executionId=="string"&&(M.value=w.params.executionId)}function U(b,w){const $=w.ctrlKey||w.metaKey;switch(b){case A.WORKFLOW:j($);break;case A.EXECUTIONS:q($);break}}async function j(b){let w;if(["","new",te].includes(_.value)?w={name:k.NEW_WORKFLOW}:w={name:k.WORKFLOW,params:{name:_.value}},b){const{href:$}=e.resolve(w);window.open($,"_blank")}else a.name!==w.name&&(a.name===k.NEW_WORKFLOW&&(m.stateIsDirty=v.value),u.value=A.WORKFLOW,await e.push(w))}async function q(b){var P;const w=L.value===te?"new":L.value,$=((P=p.activeExecution)==null?void 0:P.id)||M.value,Q=$?{name:k.EXECUTION_PREVIEW,params:{name:w,executionId:$}}:{name:k.EXECUTION_HOME,params:{name:w}};if(b){const{href:ae}=e.resolve(Q);window.open(ae,"_blank")}else a.name!==Q.name&&(v.value=m.stateIsDirty,_.value=L.value,u.value=A.EXECUTIONS,await e.push(Q))}return(b,w)=>{var $;return d(),S("div",null,[R("div",{class:I({"main-header":!0,expanded:!y(m).sidebarMenuCollapsed})},[Be(R("div",Vo,[($=J.value)!=null&&$.name?(d(),F(Lo,{key:0,workflow:J.value,"read-only":X.value},null,8,["workflow","read-only"])):ne("",!0),le.value?(d(),F(Fo,{key:1,items:T.value,"model-value":u.value,"onUpdate:modelValue":U},null,8,["items","model-value"])):ne("",!0)],512),[[st,!Y.value]])],2)])}}});export{Ta as default};
//# sourceMappingURL=MainHeader-Ch0Iz_7s.js.map
