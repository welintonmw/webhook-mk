import{G as W,l as p,m as g,T as d,r as se,e as x,Z as K,D as le,ag as c,M as _,O as i,U as r,S as y,R as h,u as l,p as n,F as Y,a7 as z,I as u,a2 as j}from"./vendor-Dv5OeN6t.js";import{_ as q}from"./n8n-4UEsHtUL.js";import{b as oe,e as ne,d as ie,E as re,dk as de,O as t,dl as H,w as ue,G as ce}from"./index-1OxaEeO3.js";const pe=W({name:"ExecutionsTime",props:["startTime"],data(){return{nowTime:-1,intervalTimer:null}},computed:{time(){if(!this.startTime)return"...";const b=this.nowTime-new Date(this.startTime).getTime();return this.$locale.displayTimer(b)}},mounted(){this.setNow(),this.intervalTimer=setInterval(()=>{this.setNow()},1e3)},beforeUnmount(){this.intervalTimer!==null&&clearInterval(this.intervalTimer)},methods:{setNow(){this.nowTime=new Date().getTime()}}});function me(b,E,$,C,I,U){return p(),g("span",null,d(b.time),1)}const Be=q(pe,[["render",me]]),fe={"data-test-id":"execution-filter-form"},be={for:"execution-filter-workflows"},ve={for:"execution-filter-tags"},xe={for:"execution-filter-status"},_e={for:"execution-filter-start-date"},ge={target:"_blank",href:"https://docs.n8n.io/workflows/executions/custom-executions-data/"},we={for:"execution-filter-saved-data-key"},Te={for:"execution-filter-saved-data-value"},R="YYYY-MM-DD HH:mm",ke=W({__name:"ExecutionsFilter",props:{workflows:{default:()=>[]},popoverPlacement:{default:"bottom"},teleported:{type:Boolean,default:!0}},emits:["filterChanged"],setup(b,{emit:E}){const $=oe(),C=ne(),{debounce:I}=ie(),U=ce(),M=b,w=E,Z=I(w,{debounceTime:500}),D=se(!1),T=x(()=>$.isEnterpriseFeatureEnabled(re.AdvancedExecutionFilters)),J=x(()=>!1),S=()=>({status:"all",workflowId:"all",tags:[],startDate:"",endDate:"",metadata:[{key:"",value:""}]}),a=K(S()),m=K(de(a).reduce((e,o)=>(e[o]=x({get(){return a[o]},set(v){a[o]=v,w("filterChanged",a)}}),e),{})),Q=x(()=>[{id:"all",name:t.baseText("executionsList.anyStatus")},{id:"error",name:t.baseText("executionsList.error")},{id:"canceled",name:t.baseText("executionsList.canceled")},{id:"running",name:t.baseText("executionsList.running")},{id:"success",name:t.baseText("executionsList.success")},{id:"waiting",name:t.baseText("executionsList.waiting")}]),k=x(()=>{let e=0;return a.status!=="all"&&e++,a.workflowId!=="all"&&M.workflows.length&&e++,H(a.tags)||e++,H(a.metadata)||e++,a.startDate&&e++,a.endDate&&e++,e}),B=(e,o,v)=>{a.metadata[e]||(a.metadata[e]={key:"",value:""}),a.metadata[e][o]=v,D.value||(U.track("User filtered executions with custom data"),D.value=!0),Z("filterChanged",a)},X=e=>{a.tags=e,w("filterChanged",a)},ee=()=>{Object.assign(a,S()),w("filterChanged",a)},L=()=>{C.goToUpgrade("custom-data-filter","upgrade-custom-data-filter")};return le(()=>{D.value=!1}),(e,o)=>{const v=c("n8n-badge"),N=c("n8n-button"),G=c("n8n-option"),P=c("n8n-select"),O=c("el-date-picker"),F=c("i18n-t"),te=c("n8n-icon"),V=c("n8n-tooltip"),A=c("n8n-input"),ae=c("n8n-popover");return p(),_(ae,{trigger:"click",placement:e.popoverPlacement,width:"440"},{reference:i(()=>[r(N,{icon:"filter",type:"tertiary",active:!!k.value,"data-test-id":"executions-filter-button"},{default:i(()=>[k.value?(p(),_(v,{key:0,theme:"primary",class:"mr-4xs","data-test-id":"execution-filter-badge"},{default:i(()=>[y(d(k.value),1)]),_:1})):h("",!0),y(" "+d(l(t).baseText("executionsList.filters")),1)]),_:1},8,["active"])]),default:i(()=>[n("div",fe,[e.workflows&&e.workflows.length>0?(p(),g("div",{key:0,class:u(e.$style.group)},[n("label",be,d(l(t).baseText("workflows.heading")),1),r(P,{id:"execution-filter-workflows",modelValue:m.workflowId,"onUpdate:modelValue":o[0]||(o[0]=s=>m.workflowId=s),placeholder:l(t).baseText("executionsFilter.selectWorkflow"),filterable:"","data-test-id":"executions-filter-workflows-select",teleported:e.teleported},{default:i(()=>[n("div",null,[(p(!0),g(Y,null,z(M.workflows,(s,f)=>(p(),_(G,{key:f,label:s.name,value:s.id},null,8,["label","value"]))),128))])]),_:1},8,["modelValue","placeholder","teleported"])],2)):h("",!0),J.value?(p(),g("div",{key:1,class:u(e.$style.group)},[n("label",ve,d(l(t).baseText("workflows.filters.tags")),1),r(ue,{id:"execution-filter-tags",placeholder:l(t).baseText("workflowOpen.filterWorkflows"),"model-value":a.tags,"create-enabled":!1,"data-test-id":"executions-filter-tags-select","onUpdate:modelValue":X},null,8,["placeholder","model-value"])],2)):h("",!0),n("div",{class:u(e.$style.group)},[n("label",xe,d(l(t).baseText("executionsList.status")),1),r(P,{id:"execution-filter-status",modelValue:m.status,"onUpdate:modelValue":o[1]||(o[1]=s=>m.status=s),placeholder:l(t).baseText("executionsFilter.selectStatus"),filterable:"","data-test-id":"executions-filter-status-select",teleported:e.teleported},{default:i(()=>[(p(!0),g(Y,null,z(Q.value,(s,f)=>(p(),_(G,{key:f,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","teleported"])],2),n("div",{class:u(e.$style.group)},[n("label",_e,d(l(t).baseText("executionsFilter.start")),1),n("div",{class:u(e.$style.dates)},[r(O,{id:"execution-filter-start-date",modelValue:m.startDate,"onUpdate:modelValue":o[2]||(o[2]=s=>m.startDate=s),type:"datetime",teleported:!1,format:R,placeholder:l(t).baseText("executionsFilter.startDate"),"data-test-id":"executions-filter-start-date-picker"},null,8,["modelValue","placeholder"]),n("span",{class:u(e.$style.divider)},"to",2),r(O,{id:"execution-filter-end-date",modelValue:m.endDate,"onUpdate:modelValue":o[3]||(o[3]=s=>m.endDate=s),type:"datetime",teleported:!1,format:R,placeholder:l(t).baseText("executionsFilter.endDate"),"data-test-id":"executions-filter-end-date-picker"},null,8,["modelValue","placeholder"])],2)],2),n("div",{class:u(e.$style.group)},[r(V,{placement:"right"},{content:i(()=>[r(F,{tag:"span",keypath:"executionsFilter.customData.docsTooltip"},{link:i(()=>[n("a",ge,d(l(t).baseText("executionsFilter.customData.docsTooltip.link")),1)]),_:1})]),default:i(()=>[n("span",{class:u(e.$style.label)},[y(d(l(t).baseText("executionsFilter.savedData"))+" ",1),r(te,{class:u(e.$style.tooltipIcon),icon:"question-circle",size:"small"},null,8,["class"])],2)]),_:1}),n("div",{class:u(e.$style.subGroup)},[n("label",we,d(l(t).baseText("executionsFilter.savedDataKey")),1),r(V,{disabled:T.value,placement:"top"},{content:i(()=>[r(F,{tag:"span",keypath:"executionsFilter.customData.inputTooltip"},{link:i(()=>[n("a",{href:"#","data-test-id":"executions-filter-view-plans-link",onClick:j(L,["prevent"])},d(l(t).baseText("executionsFilter.customData.inputTooltip.link")),1)]),_:1})]),default:i(()=>{var s;return[r(A,{id:"execution-filter-saved-data-key",name:"execution-filter-saved-data-key",type:"text",disabled:!T.value,placeholder:l(t).baseText("executionsFilter.savedDataKeyPlaceholder"),"model-value":(s=a.metadata[0])==null?void 0:s.key,"data-test-id":"execution-filter-saved-data-key-input","onUpdate:modelValue":o[4]||(o[4]=f=>B(0,"key",f))},null,8,["disabled","placeholder","model-value"])]}),_:1},8,["disabled"]),n("label",Te,d(l(t).baseText("executionsFilter.savedDataValue")),1),r(V,{disabled:T.value,placement:"top"},{content:i(()=>[r(F,{tag:"span",keypath:"executionsFilter.customData.inputTooltip"},{link:i(()=>[n("a",{href:"#",onClick:j(L,["prevent"])},d(l(t).baseText("executionsFilter.customData.inputTooltip.link")),1)]),_:1})]),default:i(()=>{var s;return[r(A,{id:"execution-filter-saved-data-value",name:"execution-filter-saved-data-value",type:"text",disabled:!T.value,placeholder:l(t).baseText("executionsFilter.savedDataValuePlaceholder"),"model-value":(s=a.metadata[0])==null?void 0:s.value,"data-test-id":"execution-filter-saved-data-value-input","onUpdate:modelValue":o[5]||(o[5]=f=>B(0,"value",f))},null,8,["disabled","placeholder","model-value"])]}),_:1},8,["disabled"])],2)],2),k.value?(p(),_(N,{key:2,class:u(e.$style.resetBtn),size:"large",text:"","data-test-id":"executions-filter-reset-button",onClick:ee},{default:i(()=>[y(d(l(t).baseText("executionsFilter.reset")),1)]),_:1},8,["class"])):h("",!0)])]),_:1},8,["placement"])}}}),ye="_group_1lywb_1",he="_label_1lywb_2",De="_subGroup_1lywb_8",Fe="_dates_1lywb_17",Ve="_divider_1lywb_25",Ee="_resetBtn_1lywb_30",$e="_tooltipIcon_1lywb_35",Ce={group:ye,label:he,subGroup:De,dates:Fe,divider:Ve,resetBtn:Ee,tooltipIcon:$e},Ie={$style:Ce},Le=q(ke,[["__cssModules",Ie],["__scopeId","data-v-e4981c3e"]]);export{Be as E,Le as a};
//# sourceMappingURL=ExecutionsFilter-0XcXH83H.js.map
