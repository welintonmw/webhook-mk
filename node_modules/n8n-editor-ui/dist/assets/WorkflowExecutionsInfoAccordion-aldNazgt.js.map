{"version":3,"file":"WorkflowExecutionsInfoAccordion-aldNazgt.js","sources":["../../src/components/executions/workflow/WorkflowExecutionsInfoAccordion.vue"],"sourcesContent":["<template>\n\t<n8n-info-accordion\n\t\t:class=\"[$style.accordion, 'mt-2xl']\"\n\t\t:title=\"$locale.baseText('executionsLandingPage.emptyState.accordion.title')\"\n\t\t:items=\"accordionItems\"\n\t\t:initially-expanded=\"shouldExpandAccordion\"\n\t\t:header-icon=\"accordionIcon\"\n\t\t@click:body=\"onAccordionClick\"\n\t\t@tooltip-click=\"onItemTooltipClick\"\n\t>\n\t\t<template #customContent>\n\t\t\t<footer class=\"mt-2xs\">\n\t\t\t\t{{ $locale.baseText('executionsLandingPage.emptyState.accordion.footer') }}\n\t\t\t\t<n8n-tooltip :disabled=\"!isNewWorkflow\">\n\t\t\t\t\t<template #content>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<n8n-link @click.prevent=\"onSaveWorkflowClick\">{{\n\t\t\t\t\t\t\t\t$locale.baseText('executionsLandingPage.emptyState.accordion.footer.tooltipLink')\n\t\t\t\t\t\t\t}}</n8n-link>\n\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t$locale.baseText('executionsLandingPage.emptyState.accordion.footer.tooltipText')\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<n8n-link\n\t\t\t\t\t\t:class=\"{ [$style.disabled]: isNewWorkflow }\"\n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t@click.prevent=\"openWorkflowSettings\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ $locale.baseText('executionsLandingPage.emptyState.accordion.footer.settingsLink') }}\n\t\t\t\t\t</n8n-link>\n\t\t\t\t</n8n-tooltip>\n\t\t\t</footer>\n\t\t</template>\n\t</n8n-info-accordion>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { mapStores } from 'pinia';\nimport { useRouter } from 'vue-router';\nimport { useRootStore } from '@/stores/root.store';\nimport { useSettingsStore } from '@/stores/settings.store';\nimport { useUIStore } from '@/stores/ui.store';\nimport { useWorkflowsStore } from '@/stores/workflows.store';\nimport { PLACEHOLDER_EMPTY_WORKFLOW_ID, WORKFLOW_SETTINGS_MODAL_KEY } from '@/constants';\nimport type { IWorkflowSettings } from 'n8n-workflow';\nimport { deepCopy } from 'n8n-workflow';\nimport { useWorkflowHelpers } from '@/composables/useWorkflowHelpers';\nimport { useNpsSurveyStore } from '@/stores/npsSurvey.store';\n\ninterface IWorkflowSaveSettings {\n\tsaveFailedExecutions: boolean;\n\tsaveSuccessfulExecutions: boolean;\n\tsaveTestExecutions: boolean;\n}\n\nexport default defineComponent({\n\tname: 'WorkflowExecutionsInfoAccordion',\n\tprops: {\n\t\tinitiallyExpanded: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup() {\n\t\tconst router = useRouter();\n\t\tconst workflowHelpers = useWorkflowHelpers({ router });\n\n\t\treturn {\n\t\t\tworkflowHelpers,\n\t\t};\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tdefaultValues: {\n\t\t\t\tsaveFailedExecutions: 'all',\n\t\t\t\tsaveSuccessfulExecutions: 'all',\n\t\t\t\tsaveManualExecutions: false,\n\t\t\t},\n\t\t\tworkflowSaveSettings: {\n\t\t\t\tsaveFailedExecutions: false,\n\t\t\t\tsaveSuccessfulExecutions: false,\n\t\t\t\tsaveTestExecutions: false,\n\t\t\t} as IWorkflowSaveSettings,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapStores(useRootStore, useSettingsStore, useUIStore, useWorkflowsStore, useNpsSurveyStore),\n\t\taccordionItems(): object[] {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: 'productionExecutions',\n\t\t\t\t\tlabel: this.$locale.baseText(\n\t\t\t\t\t\t'executionsLandingPage.emptyState.accordion.productionExecutions',\n\t\t\t\t\t),\n\t\t\t\t\ticon: this.productionExecutionsIcon.icon,\n\t\t\t\t\ticonColor: this.productionExecutionsIcon.color,\n\t\t\t\t\ttooltip:\n\t\t\t\t\t\tthis.productionExecutionsStatus === 'unknown'\n\t\t\t\t\t\t\t? this.$locale.baseText(\n\t\t\t\t\t\t\t\t\t'executionsLandingPage.emptyState.accordion.productionExecutionsWarningTooltip',\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t: null,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'manualExecutions',\n\t\t\t\t\tlabel: this.$locale.baseText('executionsLandingPage.emptyState.accordion.testExecutions'),\n\t\t\t\t\ticon: this.workflowSaveSettings.saveTestExecutions ? 'check' : 'times',\n\t\t\t\t\ticonColor: this.workflowSaveSettings.saveTestExecutions ? 'success' : 'danger',\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tshouldExpandAccordion(): boolean {\n\t\t\tif (!this.initiallyExpanded) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t!this.workflowSaveSettings.saveFailedExecutions ||\n\t\t\t\t!this.workflowSaveSettings.saveSuccessfulExecutions ||\n\t\t\t\t!this.workflowSaveSettings.saveTestExecutions\n\t\t\t);\n\t\t},\n\t\tproductionExecutionsIcon(): { icon: string; color: string } {\n\t\t\tif (this.productionExecutionsStatus === 'saving') {\n\t\t\t\treturn { icon: 'check', color: 'success' };\n\t\t\t} else if (this.productionExecutionsStatus === 'not-saving') {\n\t\t\t\treturn { icon: 'times', color: 'danger' };\n\t\t\t}\n\t\t\treturn { icon: 'exclamation-triangle', color: 'warning' };\n\t\t},\n\t\tproductionExecutionsStatus(): string {\n\t\t\tif (\n\t\t\t\tthis.workflowSaveSettings.saveSuccessfulExecutions ===\n\t\t\t\tthis.workflowSaveSettings.saveFailedExecutions\n\t\t\t) {\n\t\t\t\tif (this.workflowSaveSettings.saveSuccessfulExecutions) {\n\t\t\t\t\treturn 'saving';\n\t\t\t\t}\n\t\t\t\treturn 'not-saving';\n\t\t\t} else {\n\t\t\t\treturn 'unknown';\n\t\t\t}\n\t\t},\n\t\tworkflowSettings(): IWorkflowSettings {\n\t\t\tconst workflowSettings = deepCopy(this.workflowsStore.workflowSettings);\n\t\t\treturn workflowSettings;\n\t\t},\n\t\taccordionIcon(): { icon: string; color: string } | null {\n\t\t\tif (\n\t\t\t\t!this.workflowSaveSettings.saveTestExecutions ||\n\t\t\t\tthis.productionExecutionsStatus !== 'saving'\n\t\t\t) {\n\t\t\t\treturn { icon: 'exclamation-triangle', color: 'warning' };\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tcurrentWorkflowId(): string {\n\t\t\treturn this.workflowsStore.workflowId;\n\t\t},\n\t\tisNewWorkflow(): boolean {\n\t\t\treturn (\n\t\t\t\t!this.currentWorkflowId ||\n\t\t\t\tthis.currentWorkflowId === PLACEHOLDER_EMPTY_WORKFLOW_ID ||\n\t\t\t\tthis.currentWorkflowId === 'new'\n\t\t\t);\n\t\t},\n\t\tworkflowName(): string {\n\t\t\treturn this.workflowsStore.workflowName;\n\t\t},\n\t\tcurrentWorkflowTagIds(): string[] {\n\t\t\treturn this.workflowsStore.workflowTags;\n\t\t},\n\t},\n\twatch: {\n\t\tworkflowSettings(newSettings: IWorkflowSettings) {\n\t\t\tthis.updateSettings(newSettings);\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.defaultValues.saveFailedExecutions = this.settingsStore.saveDataErrorExecution;\n\t\tthis.defaultValues.saveSuccessfulExecutions = this.settingsStore.saveDataSuccessExecution;\n\t\tthis.defaultValues.saveManualExecutions = this.settingsStore.saveManualExecutions;\n\t\tthis.updateSettings(this.workflowSettings);\n\t},\n\tmethods: {\n\t\tupdateSettings(workflowSettings: IWorkflowSettings): void {\n\t\t\tthis.workflowSaveSettings.saveFailedExecutions =\n\t\t\t\tworkflowSettings.saveDataErrorExecution === undefined\n\t\t\t\t\t? this.defaultValues.saveFailedExecutions === 'all'\n\t\t\t\t\t: workflowSettings.saveDataErrorExecution === 'all';\n\t\t\tthis.workflowSaveSettings.saveSuccessfulExecutions =\n\t\t\t\tworkflowSettings.saveDataSuccessExecution === undefined\n\t\t\t\t\t? this.defaultValues.saveSuccessfulExecutions === 'all'\n\t\t\t\t\t: workflowSettings.saveDataSuccessExecution === 'all';\n\t\t\tthis.workflowSaveSettings.saveTestExecutions =\n\t\t\t\tworkflowSettings.saveManualExecutions === undefined\n\t\t\t\t\t? this.defaultValues.saveManualExecutions\n\t\t\t\t\t: (workflowSettings.saveManualExecutions as boolean);\n\t\t},\n\t\tonAccordionClick(event: MouseEvent): void {\n\t\t\tif (event.target instanceof HTMLAnchorElement) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.uiStore.openModal(WORKFLOW_SETTINGS_MODAL_KEY);\n\t\t\t}\n\t\t},\n\t\tonItemTooltipClick(item: string, event: MouseEvent): void {\n\t\t\tif (item === 'productionExecutions' && event.target instanceof HTMLAnchorElement) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.uiStore.openModal(WORKFLOW_SETTINGS_MODAL_KEY);\n\t\t\t}\n\t\t},\n\t\topenWorkflowSettings(): void {\n\t\t\tthis.uiStore.openModal(WORKFLOW_SETTINGS_MODAL_KEY);\n\t\t},\n\t\tasync onSaveWorkflowClick(): Promise<void> {\n\t\t\tlet currentId: string | undefined = undefined;\n\t\t\tif (this.currentWorkflowId !== PLACEHOLDER_EMPTY_WORKFLOW_ID) {\n\t\t\t\tcurrentId = this.currentWorkflowId;\n\t\t\t} else if (this.$route.params.name && this.$route.params.name !== 'new') {\n\t\t\t\tconst routeName = this.$route.params.name;\n\t\t\t\tcurrentId = Array.isArray(routeName) ? routeName[0] : routeName;\n\t\t\t}\n\t\t\tif (!currentId) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst saved = await this.workflowHelpers.saveCurrentWorkflow({\n\t\t\t\tid: currentId,\n\t\t\t\tname: this.workflowName,\n\t\t\t\ttags: this.currentWorkflowTagIds,\n\t\t\t});\n\t\t\tif (saved) {\n\t\t\t\tawait this.npsSurveyStore.fetchPromptsData();\n\t\t\t}\n\t\t},\n\t},\n});\n</script>\n\n<style module lang=\"scss\">\n.accordion {\n\tbackground: none;\n\twidth: 320px;\n\n\t// Accordion header\n\t& > div:nth-child(1) {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tpadding: var(--spacing-xs);\n\t\twidth: 100%;\n\t\tuser-select: none;\n\t\tcolor: var(--color-text-base) !important;\n\t}\n\n\t// Accordion description\n\t& > div:nth-child(2) {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\twidth: 100%;\n\t\tpadding: 0 var(--spacing-l) var(--spacing-s) !important;\n\n\t\tspan {\n\t\t\twidth: 100%;\n\t\t}\n\t}\n\n\tfooter {\n\t\ttext-align: left;\n\t\twidth: 100%;\n\t\tfont-size: var(--font-size-2xs);\n\t}\n\n\t.disabled a {\n\t\tcolor: currentColor;\n\t\tcursor: not-allowed;\n\t\topacity: 0.5;\n\t\ttext-decoration: none;\n\t}\n}\n</style>\n"],"names":["_sfc_main","defineComponent","router","useRouter","useWorkflowHelpers","mapStores","useRootStore","useSettingsStore","useUIStore","useWorkflowsStore","useNpsSurveyStore","deepCopy","PLACEHOLDER_EMPTY_WORKFLOW_ID","newSettings","workflowSettings","event","WORKFLOW_SETTINGS_MODAL_KEY","item","currentId","routeName","_component_n8n_info_accordion","_resolveComponent","_openBlock","_createBlock","accordionItems","_ctx","shouldExpandAccordion","onAccordionClick","onItemTooltipClick","_withCtx","_createElementVNode","_hoisted_1","_createTextVNode","isNewWorkflow","_createVNode","_component_n8n_tooltip","onSaveWorkflowClick","_withModifiers","_toDisplayString","_component_n8n_link","_normalizeClass","openWorkflowSettings"],"mappings":"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"}