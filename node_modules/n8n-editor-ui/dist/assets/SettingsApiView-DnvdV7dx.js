import{c$ as T,u as k,H as C,e as g,d0 as S,U as A,a as U,b as v,l as x,A as P}from"./index-1OxaEeO3.js";import{m as I}from"./pinia-sugP77Im.js";import{G as K,ag as t,l,m as h,p as s,U as i,O as a,S as n,T as o,J as E,I as r,M as b,R as M}from"./vendor-Dv5OeN6t.js";import{_ as D}from"./n8n-4UEsHtUL.js";import"./axios-Mm4CS0gO.js";import"./flatted-DN8lQ2XG.js";import"./@vueuse/core-BBHtM40w.js";import"./lodash-es-CZ1inz46.js";import"./@n8n/permissions-BxxteU-C.js";import"./dateformat-CIxnBJXX.js";import"./vue-i18n-Delvyc9x.js";import"./uuid-SoommWqA.js";import"./luxon-CLwAIbs0.js";import"./@n8n/codemirror-lang-sql-DBO6T13I.js";import"./@lezer/common-B6ct0j_v.js";import"./prettier-bS6l4Vb1.js";import"./@jsplumb/util-DS-9vq_E.js";import"./@jsplumb/core-CVBraiyY.js";import"./@jsplumb/common-CF-b-6-M.js";import"./@jsplumb/connector-bezier-BGU0Ovbw.js";import"./@jsplumb/browser-ui-BVF2KoJK.js";import"./codemirror-lang-html-n8n-CWDO6_kP.js";import"./@n8n/codemirror-lang-Dl0FW_KM.js";import"./esprima-next-nhoSXAeq.js";import"./fast-json-stable-stringify-BOfzoJX1.js";import"./timeago.js-CiyKClrF.js";import"./qrcode.vue-BGkPba5A.js";import"./vue3-touch-events-mV0oX_Sl.js";import"./chart.js-343vZi4M.js";const V=K({name:"SettingsApiView",components:{CopyInput:T},setup(){return{...k(),...C(),...g()}},data(){return{loading:!1,mounted:!1,apiKey:"",swaggerUIEnabled:!1,apiDocsURL:""}},mounted(){if(!this.isPublicApiEnabled)return;this.getApiKey();const e=this.rootStore.baseUrl,c=this.settingsStore.publicApiPath,p=this.settingsStore.publicApiLatestVersion;this.swaggerUIEnabled=this.settingsStore.isSwaggerUIEnabled,this.apiDocsURL=this.swaggerUIEnabled?`${e}${c}/v${p}/docs`:`https://${S}/api/api-reference/`},computed:{...I(x,v,U,A,g),currentUser(){return this.usersStore.currentUser},isTrialing(){return this.cloudPlanStore.userIsTrialing},isLoadingCloudPlans(){return this.cloudPlanStore.state.loadingPlan},isPublicApiEnabled(){return this.settingsStore.isPublicApiEnabled}},methods:{onUpgrade(){this.uiStore.goToUpgrade("settings-n8n-api","upgrade-api","redirect")},async showDeleteModal(){await this.confirm(this.$locale.baseText("settings.api.delete.description"),this.$locale.baseText("settings.api.delete.title"),{confirmButtonText:this.$locale.baseText("settings.api.delete.button"),cancelButtonText:this.$locale.baseText("generic.cancel")})===P&&await this.deleteApiKey()},async getApiKey(){try{this.apiKey=await this.settingsStore.getApiKey()||""}catch(e){this.showError(e,this.$locale.baseText("settings.api.view.error"))}finally{this.mounted=!0}},async createApiKey(){this.loading=!0;try{this.apiKey=await this.settingsStore.createApiKey()||""}catch(e){this.showError(e,this.$locale.baseText("settings.api.create.error"))}finally{this.loading=!1,this.$telemetry.track("User clicked create API key button")}},async deleteApiKey(){try{await this.settingsStore.deleteApiKey(),this.showMessage({title:this.$locale.baseText("settings.api.delete.toast"),type:"success"}),this.apiKey=""}catch(e){this.showError(e,this.$locale.baseText("settings.api.delete.error"))}finally{this.$telemetry.track("User clicked delete API key button")}},onCopy(){this.$telemetry.track("User clicked copy API key button")}}}),z="_container_1xc1f_1",L="_header_1xc1f_5",B="_card_1xc1f_14",N="_hint_1xc1f_25",R={container:z,header:L,card:B,delete:"_delete_1xc1f_18",hint:N},O={key:0},F={class:"mb-s"},G=["textContent"],H=["textContent"];function J(e,c,p,q,Q,W){const m=t("n8n-heading"),y=t("i18n-t"),f=t("n8n-info-tip"),d=t("n8n-link"),$=t("CopyInput"),_=t("n8n-card"),w=t("n8n-text"),u=t("n8n-action-box");return l(),h("div",{class:r(e.$style.container)},[s("div",{class:r(e.$style.header)},[i(m,{size:"2xlarge"},{default:a(()=>[n(o(e.$locale.baseText("settings.api"))+" ",1),s("span",{style:E({fontSize:"var(--font-size-s)",color:"var(--color-text-light)"})}," ("+o(e.$locale.baseText("generic.beta"))+") ",5)]),_:1})],2),e.apiKey?(l(),h("div",O,[s("p",F,[i(f,{bold:!1},{default:a(()=>[i(y,{keypath:"settings.api.view.info",tag:"span"},{apiAction:a(()=>[s("a",{href:"https://docs.n8n.io/api",target:"_blank",textContent:o(e.$locale.baseText("settings.api.view.info.api"))},null,8,G)]),webhookAction:a(()=>[s("a",{href:"https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.webhook/",target:"_blank",textContent:o(e.$locale.baseText("settings.api.view.info.webhook"))},null,8,H)]),_:1})]),_:1})]),i(_,{class:r(["mb-4xs",e.$style.card])},{default:a(()=>[s("span",{class:r(e.$style.delete)},[i(d,{bold:!0,onClick:e.showDeleteModal},{default:a(()=>[n(o(e.$locale.baseText("generic.delete")),1)]),_:1},8,["onClick"])],2),s("div",null,[i($,{label:e.$locale.baseText("settings.api.view.myKey"),value:e.apiKey,"copy-button-text":e.$locale.baseText("generic.clickToCopy"),"toast-title":e.$locale.baseText("settings.api.view.copy.toast"),"redact-value":!0,onCopy:e.onCopy},null,8,["label","value","copy-button-text","toast-title","onCopy"])])]),_:1},8,["class"]),s("div",{class:r(e.$style.hint)},[i(w,{size:"small"},{default:a(()=>[n(o(e.$locale.baseText(`settings.api.view.${e.swaggerUIEnabled?"tryapi":"more-details"}`)),1)]),_:1}),n(" "+o(" ")+" "),i(d,{to:e.apiDocsURL,"new-window":!0,size:"small"},{default:a(()=>[n(o(e.$locale.baseText(`settings.api.view.${e.swaggerUIEnabled?"apiPlayground":"external-docs"}`)),1)]),_:1},8,["to"])],2)])):!e.isPublicApiEnabled&&e.isTrialing?(l(),b(u,{key:1,"data-test-id":"public-api-upgrade-cta",heading:e.$locale.baseText("settings.api.trial.upgradePlan.title"),description:e.$locale.baseText("settings.api.trial.upgradePlan.description"),"button-text":e.$locale.baseText("settings.api.trial.upgradePlan.cta"),"onClick:button":e.onUpgrade},null,8,["heading","description","button-text","onClick:button"])):e.mounted&&!e.isLoadingCloudPlans?(l(),b(u,{key:2,"button-text":e.$locale.baseText(e.loading?"settings.api.create.button.loading":"settings.api.create.button"),description:e.$locale.baseText("settings.api.create.description"),"onClick:button":e.createApiKey},null,8,["button-text","description","onClick:button"])):M("",!0)],2)}const j={$style:R},Ae=D(V,[["render",J],["__cssModules",j]]);export{Ae as default};
//# sourceMappingURL=SettingsApiView-DnvdV7dx.js.map
