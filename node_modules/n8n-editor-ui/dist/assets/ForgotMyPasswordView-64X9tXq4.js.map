{"version":3,"file":"ForgotMyPasswordView-64X9tXq4.js","sources":["../../src/views/ForgotMyPasswordView.vue"],"sourcesContent":["<template>\n\t<AuthView :form=\"formConfig\" :form-loading=\"loading\" @submit=\"onSubmit\" />\n</template>\n\n<script lang=\"ts\">\nimport AuthView from './AuthView.vue';\nimport { useToast } from '@/composables/useToast';\n\nimport { defineComponent } from 'vue';\nimport type { IFormBoxConfig } from '@/Interface';\nimport { mapStores } from 'pinia';\nimport { useSettingsStore } from '@/stores/settings.store';\nimport { useUsersStore } from '@/stores/users.store';\n\nexport default defineComponent({\n\tname: 'ForgotMyPasswordView',\n\tcomponents: {\n\t\tAuthView,\n\t},\n\tsetup() {\n\t\treturn {\n\t\t\t...useToast(),\n\t\t};\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tloading: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapStores(useSettingsStore, useUsersStore),\n\t\tformConfig(): IFormBoxConfig {\n\t\t\tconst EMAIL_INPUTS: IFormBoxConfig['inputs'] = [\n\t\t\t\t{\n\t\t\t\t\tname: 'email',\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tlabel: this.$locale.baseText('auth.email'),\n\t\t\t\t\t\ttype: 'email',\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tvalidationRules: [{ name: 'VALID_EMAIL' }],\n\t\t\t\t\t\tautocomplete: 'email',\n\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tconst NO_SMTP_INPUTS: IFormBoxConfig['inputs'] = [\n\t\t\t\t{\n\t\t\t\t\tname: 'no-smtp-warning',\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tlabel: this.$locale.baseText('forgotPassword.noSMTPToSendEmailWarning'),\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tconst DEFAULT_FORM_CONFIG = {\n\t\t\t\ttitle: this.$locale.baseText('forgotPassword.recoverPassword'),\n\t\t\t\tredirectText: this.$locale.baseText('forgotPassword.returnToSignIn'),\n\t\t\t\tredirectLink: '/signin',\n\t\t\t};\n\n\t\t\tif (this.settingsStore.isSmtpSetup) {\n\t\t\t\treturn {\n\t\t\t\t\t...DEFAULT_FORM_CONFIG,\n\t\t\t\t\tbuttonText: this.$locale.baseText('forgotPassword.getRecoveryLink'),\n\t\t\t\t\tinputs: EMAIL_INPUTS,\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...DEFAULT_FORM_CONFIG,\n\t\t\t\tinputs: NO_SMTP_INPUTS,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tasync onSubmit(values: { email: string }) {\n\t\t\ttry {\n\t\t\t\tthis.loading = true;\n\t\t\t\tawait this.usersStore.sendForgotPasswordEmail(values);\n\n\t\t\t\tthis.showMessage({\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\ttitle: this.$locale.baseText('forgotPassword.recoveryEmailSent'),\n\t\t\t\t\tmessage: this.$locale.baseText('forgotPassword.emailSentIfExists', {\n\t\t\t\t\t\tinterpolate: { email: values.email },\n\t\t\t\t\t}),\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tlet message = this.$locale.baseText('forgotPassword.smtpErrorContactAdministrator');\n\t\t\t\tif (error.httpStatusCode) {\n\t\t\t\t\tconst { httpStatusCode: status } = error;\n\t\t\t\t\tif (status === 429) {\n\t\t\t\t\t\tmessage = this.$locale.baseText('forgotPassword.tooManyRequests');\n\t\t\t\t\t} else if (error.httpStatusCode === 422) {\n\t\t\t\t\t\tmessage = this.$locale.baseText(error.message);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.showMessage({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\ttitle: this.$locale.baseText('forgotPassword.sendingEmailError'),\n\t\t\t\t\t\tmessage,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.loading = false;\n\t\t},\n\t},\n});\n</script>\n"],"names":["_sfc_main","defineComponent","AuthView","useToast","mapStores","useSettingsStore","useUsersStore","EMAIL_INPUTS","NO_SMTP_INPUTS","DEFAULT_FORM_CONFIG","values","error","message","status","_resolveComponent","_openBlock","_createBlock","_component_AuthView","onSubmit"],"mappings":"0nCAcA,MAAAA,EAAeC,EAAgB,CAC9B,KAAM,uBACN,WAAY,CACX,SAAAC,CACD,EACA,OAAQ,CACA,MAAA,CACN,GAAGC,EAAS,CAAA,CAEd,EACA,MAAO,CACC,MAAA,CACN,QAAS,EAAA,CAEX,EACA,SAAU,CACT,GAAGC,EAAUC,EAAkBC,CAAa,EAC5C,YAA6B,CAC5B,MAAMC,EAAyC,CAC9C,CACC,KAAM,QACN,WAAY,CACX,MAAO,KAAK,QAAQ,SAAS,YAAY,EACzC,KAAM,QACN,SAAU,GACV,gBAAiB,CAAC,CAAE,KAAM,cAAe,EACzC,aAAc,QACd,WAAY,EACb,CACD,CAAA,EAGKC,EAA2C,CAChD,CACC,KAAM,kBACN,WAAY,CACX,MAAO,KAAK,QAAQ,SAAS,yCAAyC,EACtE,KAAM,MACP,CACD,CAAA,EAGKC,EAAsB,CAC3B,MAAO,KAAK,QAAQ,SAAS,gCAAgC,EAC7D,aAAc,KAAK,QAAQ,SAAS,+BAA+B,EACnE,aAAc,SAAA,EAGX,OAAA,KAAK,cAAc,YACf,CACN,GAAGA,EACH,WAAY,KAAK,QAAQ,SAAS,gCAAgC,EAClE,OAAQF,CAAA,EAGH,CACN,GAAGE,EACH,OAAQD,CAAA,CAEV,CACD,EACA,QAAS,CACR,MAAM,SAASE,EAA2B,CACrC,GAAA,CACH,KAAK,QAAU,GACT,MAAA,KAAK,WAAW,wBAAwBA,CAAM,EAEpD,KAAK,YAAY,CAChB,KAAM,UACN,MAAO,KAAK,QAAQ,SAAS,kCAAkC,EAC/D,QAAS,KAAK,QAAQ,SAAS,mCAAoC,CAClE,YAAa,CAAE,MAAOA,EAAO,KAAM,CAAA,CACnC,CAAA,CACD,QACOC,EAAO,CACf,IAAIC,EAAU,KAAK,QAAQ,SAAS,8CAA8C,EAClF,GAAID,EAAM,eAAgB,CACnB,KAAA,CAAE,eAAgBE,CAAW,EAAAF,EAC/BE,IAAW,IACJD,EAAA,KAAK,QAAQ,SAAS,gCAAgC,EACtDD,EAAM,iBAAmB,MACnCC,EAAU,KAAK,QAAQ,SAASD,EAAM,OAAO,GAG9C,KAAK,YAAY,CAChB,KAAM,QACN,MAAO,KAAK,QAAQ,SAAS,kCAAkC,EAC/D,QAAAC,CAAA,CACA,CACF,CACD,CACA,KAAK,QAAU,EAChB,CACD,CACD,CAAC,kCA3GAE,EAA0E,UAAA,EAA5C,OAAAC,EAAA,EAAqBC,EAAAC,EAAA,CAAG,KAAQC,EAAAA,WAAAA,eAAAA,EAAAA"}