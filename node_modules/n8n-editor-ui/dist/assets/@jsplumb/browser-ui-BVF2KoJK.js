import{c as oe,a as nn,C as rn,b as ke,A as In,d as yt,E as jn,S as P,e as He,f as Mt,T as Ln,I as Rn,g as Fn,h as sn,i as an,R as Hn,j as Vn,k as Bn,l as Un,m as Wn,n as Yn,o as Zn,p as Xn,q as Qe,r as $n,s as Jn,t as Ae,N as xe,O as Kn,B as zn,u as Nt,v as st,w as qn,F as wt,x as Q,y as ee,z as at,D as ot,G as lt,H as on,J as ln,K as Qn,L as ei,M as ti,P as ni,Q as Gt,U as ii}from"./core-CVBraiyY.js";import{r as ri,u as Je,s as si,i as pe,e as R,f as T,a as It,w as je,g as un,m as jt,b as ai,c as oi,d as cn,h as li,j as ui,l as ut,k as Le,n as ci,o as hn,p as hi,q as Et}from"./util-DS-9vq_E.js";import{F as ve,T as dn,U as fn,W as di}from"./common-CF-b-6-M.js";function ge(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ge=function(a){return typeof a}:ge=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ge(r)}function O(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function Lt(r,a){for(var n=0;n<a.length;n++){var i=a[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function M(r,a,n){return a&&Lt(r.prototype,a),n&&Lt(r,n),r}function u(r,a,n){return a in r?Object.defineProperty(r,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[a]=n,r}function Ke(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),a&&ct(r,a)}function N(r){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},N(r)}function ct(r,a){return ct=Object.setPrototypeOf||function(i,e){return i.__proto__=e,i},ct(r,a)}function fi(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function vi(r,a){return a&&(typeof a=="object"||typeof a=="function")?a:f(r)}function ze(r){var a=fi();return function(){var i=N(r),e;if(a){var t=N(this).constructor;e=Reflect.construct(i,arguments,t)}else e=i.apply(this,arguments);return vi(this,e)}}function gi(r,a){for(;!Object.prototype.hasOwnProperty.call(r,a)&&(r=N(r),r!==null););return r}function G(r,a,n){return typeof Reflect<"u"&&Reflect.get?G=Reflect.get:G=function(e,t,s){var o=gi(e,t);if(o){var l=Object.getOwnPropertyDescriptor(o,t);return l.get?l.get.call(s):l.value}},G(r,a,n||r)}function pi(r,a){return mi(r)||Ei(r,a)||vn(r,a)||Ti()}function Rt(r){return _i(r)||yi(r)||vn(r)||Ci()}function _i(r){if(Array.isArray(r))return ht(r)}function mi(r){if(Array.isArray(r))return r}function yi(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ei(r,a){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i=[],e=!0,t=!1,s,o;try{for(n=n.call(r);!(e=(s=n.next()).done)&&(i.push(s.value),!(a&&i.length===a));e=!0);}catch(l){t=!0,o=l}finally{try{!e&&n.return!=null&&n.return()}finally{if(t)throw o}}return i}}function vn(r,a){if(r){if(typeof r=="string")return ht(r,a);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(r,a)}}function ht(r,a){(a==null||a>r.length)&&(a=r.length);for(var n=0,i=new Array(a);n<a;n++)i[n]=r[n];return i}function Ci(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ti(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function le(r,a,n){n=n||r.parentNode;for(var i=n.querySelectorAll(a),e=0;e<i.length;e++)if(i[e]===r)return!0;return!1}function Oe(r,a){r.stopPropagation?r.stopPropagation():r.returnValue=!1,!a&&r.preventDefault&&r.preventDefault()}function K(r,a,n,i){if(i&&le(r,a,n))return r;for(r=r.parentNode;r!=null&&r!==n;){if(le(r,a))return r;r=r.parentNode}}function w(r){return r.srcElement||r.target}function Si(r,a,n){a=Et(a),typeof r.className.baseVal<"u"?r.className.baseVal=a:r.className=a;try{var i=r.classList;if(i!=null){for(;i.length>0;)i.remove(i.item(0));for(var e=0;e<n.length;e++)n[e]&&i.add(n[e])}}catch(t){ut("WARN: cannot set class list",t)}}function Ct(r){return r.className!=null?typeof r.className.baseVal>"u"?r.className:r.className.baseVal:""}function gn(r,a,n){var i=a==null?[]:Array.isArray(a)?a:a.split(/\s+/),e=n==null?[]:Array.isArray(n)?n:n.split(/\s+/),t=Ct(r),s=t.split(/\s+/),o=function(h,d){for(var c=0;c<d.length;c++)if(h)s.indexOf(d[c])===-1&&s.push(d[c]);else{var _=s.indexOf(d[c]);_!==-1&&s.splice(_,1)}};o(!0,i),o(!1,e),Si(r,s.join(" "),s)}function Me(r){return!pe(r)&&!Array.isArray(r)&&r.length!=null&&r.documentElement==null&&r.nodeType==null}function Di(r){return Ct(r)}function se(r,a){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var s=Et(t).split(/\s+/);T(s,function(o){e.classList.add(o)})}else gn(e,t)};Me(r)?T(r,function(i){return n(i,a)}):n(r,a)}function ki(r,a){return r.classList?r.classList.contains(a):Ct(r).indexOf(a)!==-1}function dt(r,a){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var s=Et(t).split(/\s+/);s.forEach(function(o){e.classList.remove(o)})}else gn(e,null,t)};Me(r)?T(r,function(i){return n(i,a)}):n(r,a)}function Pi(r,a){var n=this,i=function(t,s){t!=null&&s!=null&&s.length>0&&(t.classList?t.classList.toggle(s):n.hasClass(t,s)?n.removeClass(t,s):n.addClass(t,s))};Me(r)?T(r,function(e){return i(e,a)}):i(r,a)}function pn(r,a,n,i){return _n(null,r,a,n,i)}function _n(r,a,n,i,e){var t=r==null?document.createElement(a):document.createElementNS(r,a),s;n=n||{};for(s in n)t.style[s]=n[s];i&&(t.className=i),e=e||{};for(s in e)t.setAttribute(s,""+e[s]);return t}function fe(r){var a=r.getBoundingClientRect(),n=document.body,i=document.documentElement,e=window.pageYOffset||i.scrollTop||n.scrollTop,t=window.pageXOffset||i.scrollLeft||n.scrollLeft,s=i.clientTop||n.clientTop||0,o=i.clientLeft||n.clientLeft||0,l=a.top+e-s,h=a.left+t-o;return{x:Math.round(h),y:Math.round(l)}}function bi(r){return{w:r.offsetWidth,h:r.offsetHeight}}function Ai(r){try{return{w:parseFloat(r.width.baseVal.value),h:parseFloat(r.height.baseVal.value)}}catch{return{w:0,h:0}}}function xi(r){try{return{x:parseFloat(r.x.baseVal.value),y:parseFloat(r.y.baseVal.value)}}catch{return{x:0,y:0}}}function Re(r,a){var n=a.getContainer().getBoundingClientRect(),i=r.getBoundingClientRect(),e=a.currentZoom;return{x:(i.left-n.left)/e,y:(i.top-n.top)/e}}function me(r,a){var n=r.getBoundingClientRect(),i=a.currentZoom;return{w:n.width/i,h:n.height/i}}var ue;(function(r){r.SVG="SVG",r.HTML="HTML"})(ue||(ue={}));function ft(r){return r instanceof SVGElement?ue.SVG:ue.HTML}function Oi(r){return ft(r)===ue.SVG}var Ft={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},ye="stroke-dasharray",et="dashstyle",Mi="fill",Ni="stroke",wi="stroke-width",Gi="strokeWidth",mn="svg",vt="path",gt={svg:"http://www.w3.org/2000/svg"};function Y(r,a){for(var n in a)r.setAttribute(n,""+a[n])}function Z(r,a){return a=a||{},a.version="1.1",a.xmlns=gt.svg,_n(gt.svg,r,null,null,a)}function yn(r){return"position:absolute;left:"+r[0]+"px;top:"+r[1]+"px"}function pt(r,a,n){if(a.setAttribute(Mi,n.fill?n.fill:xe),a.setAttribute(Ni,n.stroke?n.stroke:xe),n.strokeWidth&&a.setAttribute(wi,n.strokeWidth),n[et]&&n[Gi]&&!n[ye]){var i=n[et].indexOf(",")===-1?" ":",",e=n[et].split(i),t="";T(e,function(o){t+=Math.floor(o*n.strokeWidth)+i}),a.setAttribute(ye,t)}else n[ye]&&a.setAttribute(ye,n[ye]);for(var s in Ft)n[s]&&a.setAttribute(Ft[s],n[s])}function Ve(r,a,n){r.childNodes.length>n?r.insertBefore(a,r.childNodes[n]):r.appendChild(a)}var Ds={attr:Y,node:Z,ns:gt};function D(r,a,n){var i=[r,a];return i.join(":")}var Ht="data-jtk-container",Ii="data-jtk-group-content",Fe="data-jtk-enabled",tt="data-jtk-scope",ce="endpoint",X="element",$="connection",En="div",I="click",z="contextmenu",W="dblclick",V="dbltap",ji="focus",A="mousedown",Tt="mouseenter",St="mouseexit",ae="mousemove",x="mouseup",j="mouseout",L="mouseover",B="tap",Li="touchstart",Ri="touchend",Fi="touchmove",Hi="drag:move",Vi="drag:stop",Bi="drag:start",Ye="revert",Ui="connection:abort",Vt="connection:drag",Bt=D(X,I),Wi=D(X,W),Ut=D(X,V),Yi=D(X,j),Zi=D(X,L),Xi=D(X,ae),$i=D(X,x),Ji=D(X,A),Ki=D(X,z),Wt=D(X,B),zi=D(ce,I),qi=D(ce,W),Qi=D(ce,j),er=D(ce,L),tr=D(ce,x),nr=D(ce,A),ir=D($,I),rr=D($,W),sr=D($,V),ar=D($,j),or=D($,L),lr=D($,x),ur=D($,A),cr=D($,z),hr=D($,B),Yt="position",F=oe(rn),ie=oe(ke),dr=nn(In),fr=nn(Ii),J=oe(yt),Ee,Ce;function vr(r,a,n,i,e,t,s){return new Touch({target:r,identifier:Je(),pageX:a,pageY:n,screenX:i,screenY:e,clientX:t||i,clientY:s||e})}function gr(){var r=[];return r.push.apply(r,arguments),r.item=function(a){return this[a]},r}function pr(r,a,n,i,e,t,s){return gr(vr(r,a,n,i,e,t,s))}function _e(r,a,n){n=n||r.parentNode;for(var i=n.querySelectorAll(a),e=0;e<i.length;e++)if(i[e]===r)return!0;return!1}function Ne(r){return r.srcElement||r.target}function _t(r,a,n,i){if(i){var e=r.composedPath?r.composedPath():r.path;if(typeof e<"u"&&e.indexOf)return{path:e,end:e.indexOf(n)};var t={path:[],end:-1},s=function o(l){t.path.push(l),l===n?t.end=t.path.length-1:l.parentNode!=null&&o(l.parentNode)};return s(a),t}else return{path:[a],end:1}}function _r(r,a){var n=0,i;for(n=0,i=r.length;n<i&&r[n][0]!==a;n++);n<r.length&&r.splice(n,1)}var mr=1;function Pe(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints!=null&&navigator.maxTouchPoints>0}function Be(){return"onmousedown"in document.documentElement}var q=(Ee={},u(Ee,A,Li),u(Ee,x,Ri),u(Ee,ae,Fi),Ee),yr="page",Er="screen",Cr="client";function Dt(r,a){if(r==null)return{x:0,y:0};var n=Cn(r),i=Dr(n,0);return{x:i[a+"X"],y:i[a+"Y"]}}function Ze(r){return Dt(r,yr)}function Tr(r){return Dt(r,Er)}function Sr(r){return Dt(r,Cr)}function Dr(r,a){return r.item?r.item(a):r[a]}function Cn(r){return r.touches&&r.touches.length>0?r.touches:r.changedTouches&&r.changedTouches.length>0?r.changedTouches:r.targetTouches&&r.targetTouches.length>0?r.targetTouches:[r]}function kr(r){return Cn(r).length}function Xe(r,a,n,i,e){if(Sn(r,a,n),i.__tauid=n.__tauid,r.addEventListener)r.addEventListener(a,n,!1,e);else if(r.attachEvent){var t=a+n.__tauid;r["e"+t]=n,r[t]=function(){r["e"+t]&&r["e"+t](window.event)},r.attachEvent("on"+a,r[t])}}function we(r,a,n){var i=this;n!=null&&Tn(r,function(e){if(Pr(e,a,n),n.__tauid!=null){if(e.removeEventListener)e.removeEventListener(a,n,!1),Pe()&&q[a]&&e.removeEventListener(q[a],n,!1);else if(i.detachEvent){var t=a+n.__tauid;e[t]&&e.detachEvent("on"+a,e[t]),e[t]=null,e["e"+t]=null}}n.__taTouchProxy&&we(r,n.__taTouchProxy[1],n.__taTouchProxy[0])})}function Tn(r,a){if(r!=null)for(var n=typeof r=="string"?document.querySelectorAll(r):r.length!=null?r:[r],i=0;i<n.length;i++)a(n[i])}function Sn(r,a,n){var i=mr++;return r.__ta=r.__ta||{},r.__ta[a]=r.__ta[a]||{},r.__ta[a][i]=n,n.__tauid=i,i}function Pr(r,a,n){if(r.__ta&&r.__ta[a]&&delete r.__ta[a][n.__tauid],n.__taExtra){for(var i=0;i<n.__taExtra.length;i++)we(r,n.__taExtra[i][0],n.__taExtra[i][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}var br=/:not\(([^)]+)\)/;function $e(r,a,n,i){if(r==null)return n;var e=r.split(","),t=[],s=[];T(e,function(l){var h=l.match(br);h!=null?s.push(h[1]):t.push(l)}),s.length>0&&t.length===0&&t.push(di);var o=function l(h){l.__tauid=n.__tauid;var d=Ne(h),c=!1,_=d,p=_t(h,d,a,r!=null);if(p.end!=-1)for(var v=0;!c&&v<p.end;v++){_=p.path[v];for(var y=0;y<s.length;y++)if(_e(_,s[y],a))return;for(var g=0;!c&&g<t.length;g++)if(_e(_,t[g],a)){n.apply(_,[h,_]),c=!0;break}}};return Ar(n,i,o),o}function Ar(r,a,n){r.__taExtra=r.__taExtra||[],r.__taExtra.push([a,n])}var Ue=function(a,n,i,e,t){if(Pe()&&q[n]){var s=$e(e,a,i,q[n]);Xe(a,q[n],s,i,t)}n===ji&&a.getAttribute(Gt)==null&&a.setAttribute(Gt,"1"),Xe(a,n,$e(e,a,i,n),i,t)},nt=(Ce={},u(Ce,B,{touches:1,taps:1}),u(Ce,V,{touches:1,taps:2}),u(Ce,z,{touches:2,taps:1}),Ce);function Zt(r,a,n,i){for(var e in n.__tamee[r])n.__tamee[r].hasOwnProperty(e)&&n.__tamee[r][e].apply(i,[a])}var xr=function(){function r(){O(this,r)}return M(r,null,[{key:"generate",value:function(n,i){return function(e,t,s,o){if(t==z&&Be())Ue(e,t,s,o);else{if(e.__taTapHandler==null){var l=e.__taTapHandler={tap:[],dbltap:[],down:!1,taps:0,downSelectors:[]},h=function(v){for(var y=Ne(v),g=_t(v,y,e,o!=null),E=!1,m=0;m<g.end;m++){if(E)return;y=g.path[m];for(var C=0;C<l.downSelectors.length;C++)if(l.downSelectors[C]==null||_e(y,l.downSelectors[C],e)){l.down=!0,setTimeout(c,n),setTimeout(_,i),E=!0;break}}},d=function(v){if(l.down){var y=Ne(v),g,E;l.taps++;var m=kr(v);for(var C in nt)if(nt.hasOwnProperty(C)){var S=nt[C];if(S.touches===m&&(S.taps===1||S.taps===l.taps))for(var k=0;k<l[C].length;k++){E=_t(v,y,e,l[C][k][1]!=null);for(var b=0;b<E.end;b++)if(g=E.path[b],l[C][k][1]==null||_e(g,l[C][k][1],e)){l[C][k][0].apply(g,[v,g]);break}}}}},c=function(){l.down=!1},_=function(){l.taps=0};e.__taTapHandler.downHandler=h,e.__taTapHandler.upHandler=d,Ue(e,A,h),Ue(e,x,d)}e.__taTapHandler.downSelectors.push(o),e.__taTapHandler[t].push([s,o]),s.__taUnstore=function(){e.__taTapHandler!=null&&(ri(e.__taTapHandler.downSelectors,function(p){return p===o}),_r(e.__taTapHandler[t],s),e.__taTapHandler.downSelectors.length===0&&(we(e,A,e.__taTapHandler.downHandler),we(e,x,e.__taTapHandler.upHandler),delete e.__taTapHandler))}}}}}]),r}(),Or=function(){function r(){O(this,r)}return M(r,null,[{key:"generate",value:function(){var n=[];return function(i,e,t,s){if(!i.__tamee){i.__tamee={over:!1,mouseenter:[],mouseexit:[]};var o=function(d){var c=Ne(d);(s==null&&c==i&&!i.__tamee.over||_e(c,s,i)&&(c.__tamee==null||!c.__tamee.over))&&(Zt(Tt,d,i,c),c.__tamee=c.__tamee||{},c.__tamee.over=!0,n.push(c))},l=function(d){for(var c=Ne(d),_=0;_<n.length;_++)c==n[_]&&!_e(d.relatedTarget||d.toElement,"*",c)&&(c.__tamee.over=!1,n.splice(_,1),Zt(St,d,i,c))};Xe(i,L,$e(s,i,o,L),o),Xe(i,j,$e(s,i,l,j),l)}t.__taUnstore=function(){delete i.__tamee[e][t.__tauid]},Sn(i,e,t),i.__tamee[e][t.__tauid]=t}}}]),r}(),Dn=function(){function r(a){O(this,r),u(this,"clickThreshold",void 0),u(this,"dblClickThreshold",void 0),u(this,"tapHandler",void 0),u(this,"mouseEnterExitHandler",void 0),a=a||{},this.clickThreshold=a.clickThreshold||250,this.dblClickThreshold=a.dblClickThreshold||450,this.mouseEnterExitHandler=Or.generate(),this.tapHandler=xr.generate(this.clickThreshold,this.dblClickThreshold)}return M(r,[{key:"_doBind",value:function(n,i,e,t,s){if(e!=null){var o=n;i===B||i===V||i===z?this.tapHandler(o,i,e,t,s):i===Tt||i==St?this.mouseEnterExitHandler(o,i,e,t,s):Ue(o,i,e,t,s)}}},{key:"on",value:function(n,i,e,t,s){var o=t==null?null:e,l=t??e;return this._doBind(n,i,l,o,s),this}},{key:"off",value:function(n,i,e){return we(n,i,e),this}},{key:"trigger",value:function(n,i,e,t,s){var o=Be()&&(typeof MouseEvent>"u"||e==null||e.constructor===MouseEvent),l=Pe()&&!Be()&&q[i]?q[i]:i,h=!(Pe()&&!Be()&&q[i]),d=Ze(e),c=Tr(e),_=Sr(e);return Tn(n,function(p){var v;e=e||{screenX:c.x,screenY:c.y,clientX:_.x,clientY:_.y};var y=function(S){t&&(S.payload=t)},g={TouchEvent:function(S){var k=pr(p,d.x,d.y,c.x,c.y,_.x,_.y),b=S.initTouchEvent||S.initEvent;b(l,!0,!0,window,null,c.x,c.y,_.x,_.y,!1,!1,!1,!1,k,k,k,1,0)},MouseEvents:function(S){S.initMouseEvent(l,!0,!0,window,s??1,c.x,c.y,_.x,_.y,!1,!1,!1,!1,1,p)}},E=!h&&!o&&Pe()&&q[i],m=E?"TouchEvent":"MouseEvents";v=document.createEvent(m),g[m](v),y(v),p.dispatchEvent(v)}),this}}]),r}();function Mr(r,a,n){if(le(a,n,r))return a;for(var i=a.parentNode;i!=null&&i!==r;){if(le(i,n,r))return i;i=i.parentNode}}function Nr(r){return typeof r=="function"?(r._katavorioId=Je(),r._katavorioId):r}function Xt(r,a,n){var i=a.parentNode,e=r.getSize(i),t=r.getSize(a),s=n.x,o=s+t.w,l=n.y,h=l+t.h;return o>0&&s<e.w&&h>0&&l<e.h}function wr(r,a,n){for(var i=null,e=a.getAttribute("katavorio-draggable"),t=e!=null?"[katavorio-draggable='"+e+"'] ":"",s=0;s<r.length;s++)if(i=Mr(a,n,t+r[s].selector),i!=null){if(r[s].filter){var o=le(n,r[s].filter,i),l=r[s].filterExclude===!0;if(l&&!o||o)return null}return[r[s],i]}return null}var kn="start",Pn="beforeStart",bn="drag",Gr="drop",Ir="over",jr="out",An="stop",xn="katavorio-draggable",Lr=xn,Rr=10,Fr=10,it=function(){return!0},Hr=function(){return!1},Se={delegatedDraggable:"katavorio-delegated-draggable",draggable:Lr,drag:"katavorio-drag",selected:"katavorio-drag-selected",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},U;(function(r){r.absolutePosition="absolutePosition",r.transform="transform",r.xyAttributes="xyAttributes"})(U||(U={}));var kt=new Map;kt.set(U.absolutePosition,function(r,a){r.style.left="".concat(a.x,"px"),r.style.top="".concat(a.y,"px")});kt.set(U.xyAttributes,function(r,a){r.setAttribute("x","".concat(a.x)),r.setAttribute("y","".concat(a.y))});var Pt=new Map;Pt.set(U.absolutePosition,function(r){return{x:r.offsetLeft,y:r.offsetTop}});Pt.set(U.xyAttributes,function(r){return{x:parseFloat(r.getAttribute("x")),y:parseFloat(r.getAttribute("y"))}});var bt=new Map;bt.set(U.absolutePosition,function(r,a){r.style.width="".concat(a.w,"px"),r.style.height="".concat(a.h,"px")});bt.set(U.xyAttributes,function(r,a){r.setAttribute("width","".concat(a.w)),r.setAttribute("height","".concat(a.h))});var At=new Map;At.set(U.absolutePosition,function(r){return{w:r.offsetWidth,h:r.offsetHeight}});At.set(U.xyAttributes,function(r){return{w:parseFloat(r.getAttribute("width")),h:parseFloat(r.getAttribute("height"))}});var rt=[An,kn,bn,Gr,Ir,jr,Pn],Vr=function(){},he=function(a,n){if(a!=null){a=!pe(a)&&a.tagName==null&&a.length!=null?a:[a];for(var i=0;i<a.length;i++)n.apply(a[i],[a[i]])}},Br=function(a,n,i){var e=a.srcElement||a.target;return!le(e,i.getInputFilterSelector(),n)},Ur=function(){function r(a,n){O(this,r),this.el=a,this.manager=n,u(this,"_class",void 0),u(this,"uuid",Je()),u(this,"enabled",!0),u(this,"scopes",[]),u(this,"eventManager",void 0),this.eventManager=n.eventManager}return M(r,[{key:"setEnabled",value:function(n){this.enabled=n}},{key:"isEnabled",value:function(){return this.enabled}},{key:"toggleEnabled",value:function(){this.enabled=!this.enabled}},{key:"addScope",value:function(n){var i={};he(this.scopes,function(t){i[t]=!0}),he(n?n.split(/\s+/):[],function(t){i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"removeScope",value:function(n){var i={};he(this.scopes,function(t){i[t]=!0}),he(n?n.split(/\s+/):[],function(t){delete i[t]}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"toggleScope",value:function(n){var i={};he(this.scopes,function(t){i[t]=!0}),he(n?n.split(/\s+/):[],function(t){i[t]?delete i[t]:i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}}]),r}();function Wr(r){return{w:r.parentNode.offsetWidth+r.parentNode.scrollLeft,h:r.parentNode.offsetHeight+r.parentNode.scrollTop}}var be;(function(r){r.notNegative="notNegative",r.parent="parent",r.parentEnclosed="parentEnclosed"})(be||(be={}));var Yr=function(r){Ke(n,r);var a=ze(n);function n(i,e,t){var s;if(O(this,n),s=a.call(this,i,t),u(f(s),"_class",void 0),u(f(s),"rightButtonCanDrag",void 0),u(f(s),"consumeStartEvent",void 0),u(f(s),"clone",void 0),u(f(s),"scroll",void 0),u(f(s),"trackScroll",void 0),u(f(s),"_downAt",void 0),u(f(s),"_posAtDown",void 0),u(f(s),"_pagePosAtDown",void 0),u(f(s),"_pageDelta",{x:0,y:0}),u(f(s),"_moving",void 0),u(f(s),"_lastPosition",void 0),u(f(s),"_lastScrollValues",{x:0,y:0}),u(f(s),"_initialScroll",{x:0,y:0}),u(f(s),"_size",void 0),u(f(s),"_currentParentPosition",void 0),u(f(s),"_ghostParentPosition",void 0),u(f(s),"_dragEl",void 0),u(f(s),"_multipleDrop",void 0),u(f(s),"_ghostProxyOffsets",void 0),u(f(s),"_ghostDx",void 0),u(f(s),"_ghostDy",void 0),u(f(s),"_isConstrained",!1),u(f(s),"_ghostProxyParent",void 0),u(f(s),"_useGhostProxy",void 0),u(f(s),"_ghostProxyFunction",void 0),u(f(s),"_activeSelectorParams",void 0),u(f(s),"_availableSelectors",[]),u(f(s),"_canDrag",void 0),u(f(s),"_consumeFilteredEvents",void 0),u(f(s),"_parent",void 0),u(f(s),"_ignoreZoom",void 0),u(f(s),"_filters",{}),u(f(s),"_constrainRect",void 0),u(f(s),"_elementToDrag",void 0),u(f(s),"downListener",void 0),u(f(s),"moveListener",void 0),u(f(s),"upListener",void 0),u(f(s),"scrollTracker",void 0),u(f(s),"listeners",{start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]}),s._class=s.manager.css.draggable,se(s.el,s._class),s.downListener=s._downListener.bind(f(s)),s.upListener=s._upListener.bind(f(s)),s.moveListener=s._moveListener.bind(f(s)),s.rightButtonCanDrag=e.rightButtonCanDrag===!0,s.consumeStartEvent=e.consumeStartEvent!==!1,s._dragEl=s.el,s.clone=e.clone===!0,s.scroll=e.scroll===!0,s.trackScroll=e.trackScroll!==!1,s._multipleDrop=e.multipleDrop!==!1,s._canDrag=e.canDrag||it,s._consumeFilteredEvents=e.consumeFilteredEvents,s._parent=e.parent,s._ignoreZoom=e.ignoreZoom===!0,s._ghostProxyParent=e.ghostProxyParent,s.trackScroll&&(s.scrollTracker=s._trackScroll.bind(f(s)),document.addEventListener("scroll",s.scrollTracker)),e.ghostProxy===!0?s._useGhostProxy=it:e.ghostProxy&&typeof e.ghostProxy=="function"?s._useGhostProxy=e.ghostProxy:s._useGhostProxy=function(l,h){return s._activeSelectorParams&&s._activeSelectorParams.useGhostProxy?s._activeSelectorParams.useGhostProxy(l,h):!1},e.makeGhostProxy?s._ghostProxyFunction=e.makeGhostProxy:s._ghostProxyFunction=function(l){return s._activeSelectorParams&&s._activeSelectorParams.makeGhostProxy?s._activeSelectorParams.makeGhostProxy(l):l.cloneNode(!0)},e.selector){var o=s.el.getAttribute(xn);o==null&&(o=""+new Date().getTime(),s.el.setAttribute("katavorio-draggable",o)),s._availableSelectors.push(e)}return s.eventManager.on(s.el,A,s.downListener),s}return M(n,[{key:"_trackScroll",value:function(e){if(this._moving){var t={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},s=t.x-this._lastScrollValues.x,o=t.y-this._lastScrollValues.y,l={x:s+this._lastPosition.x,y:o+this._lastPosition.y},h=l.x-this._downAt.x,d=l.y-this._downAt.y,c=this._ignoreZoom?1:this.manager.getZoom();this._dragEl&&this._dragEl.parentNode&&(h+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,d+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),h/=c,d/=c,this.moveBy(h,d,e),this._lastPosition=l,this._lastScrollValues=t}}},{key:"on",value:function(e,t){this.listeners[e]&&this.listeners[e].push(t)}},{key:"off",value:function(e,t){if(this.listeners[e]){for(var s=[],o=0;o<this.listeners[e].length;o++)this.listeners[e][o]!==t&&s.push(this.listeners[e][o]);this.listeners[e]=s}}},{key:"_upListener",value:function(e){this._downAt&&(this._downAt=null,this.eventManager.off(document,ae,this.moveListener),this.eventManager.off(document,x,this.upListener),dt(document.body,Se.noSelect),this.unmark(e),this.stop(e),this._moving=!1,this.clone?(this._dragEl&&this._dragEl.parentNode&&this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=null):this._activeSelectorParams&&this._activeSelectorParams.revertFunction&&this._activeSelectorParams.revertFunction(this._dragEl,this.manager.getPosition(this._dragEl))===!0&&(this.manager.setPosition(this._dragEl,this._posAtDown),this._dispatch(Ye,this._dragEl)))}},{key:"_downListener",value:function(e){if(!e.defaultPrevented){var t=this.rightButtonCanDrag||e.which!==3&&e.button!==2;if(t&&this.isEnabled()&&this._canDrag()){var s=this._testFilter(e)&&Br(e,this.el,this.manager);if(s){this._activeSelectorParams=null,this._elementToDrag=null,this._availableSelectors.length===0&&console.log("JSPLUMB: no available drag selectors");var o=e.target||e.srcElement,l=wr(this._availableSelectors,this.el,o);if(l!=null&&(this._activeSelectorParams=l[0],this._elementToDrag=l[1]),this._activeSelectorParams==null||this._elementToDrag==null)return;var h=this._activeSelectorParams.dragInit?this._activeSelectorParams.dragInit(this._elementToDrag,e):null;if(h!=null&&(this._elementToDrag=h),this.clone)if(this._dragEl=this._elementToDrag.cloneNode(!0),se(this._dragEl,Se.clonedDrag),this._dragEl.setAttribute("id",null),this._dragEl.style.position="absolute",this._parent!=null){var d=this.manager.getPosition(this.el);this._dragEl.style.left=d.x+"px",this._dragEl.style.top=d.y+"px",this._parent.appendChild(this._dragEl)}else{var c=fe(this._elementToDrag);this._dragEl.style.left=c.x+"px",this._dragEl.style.top=c.y+"px",document.body.appendChild(this._dragEl)}else this._dragEl=this._elementToDrag;this.consumeStartEvent&&Oe(e),this._downAt=Ze(e),this._dragEl&&this._dragEl.parentNode&&(this._initialScroll={x:this._dragEl.parentNode.scrollLeft,y:this._dragEl.parentNode.scrollTop}),this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=fe(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),this.eventManager.on(document,ae,this.moveListener),this.eventManager.on(document,x,this.upListener),se(document.body,Se.noSelect),this._dispatch(Pn,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size})}else this._consumeFilteredEvents&&Oe(e)}}}},{key:"_moveListener",value:function(e){if(this._downAt){if(!this._moving){var t=this._dispatch(kn,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size});if(t!==!1){if(!this._downAt)return;this.mark(t),this._moving=!0}else this.abort()}if(this._downAt){var s=Ze(e),o=s.x-this._downAt.x,l=s.y-this._downAt.y,h=this._ignoreZoom?1:this.manager.getZoom();this._lastPosition={x:s.x,y:s.y},this._lastScrollValues={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},this._dragEl&&this._dragEl.parentNode&&(o+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,l+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),o/=h,l/=h,this.moveBy(o,l,e)}}}},{key:"getDragDelta",value:function(){return this._posAtDown!=null&&this._downAt!=null?{x:this._downAt.x-this._posAtDown.x,y:this._downAt.y-this._posAtDown.y}:{x:0,y:0}}},{key:"mark",value:function(e){this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=fe(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),se(this._dragEl,this.manager.css.drag),this._constrainRect=Wr(this._dragEl),this._ghostDx=0,this._ghostDy=0}},{key:"unmark",value:function(e){this._isConstrained&&this._useGhostProxy(this._elementToDrag,this._dragEl)?(this._ghostProxyOffsets={x:this._dragEl.offsetLeft-this._ghostDx,y:this._dragEl.offsetTop-this._ghostDy},this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag):this._ghostProxyOffsets=null,dt(this._dragEl,this.manager.css.drag),this._isConstrained=!1}},{key:"moveBy",value:function(e,t,s){var o=this.toGrid({x:this._posAtDown.x+e,y:this._posAtDown.y+t}),l=this._doConstrain(o,this._dragEl,this._constrainRect,this._size,s);if(l!=null){if(this._useGhostProxy(this.el,this._dragEl))if(o.x!==l.x||o.y!==l.y){if(!this._isConstrained){var h=this._ghostProxyFunction(this._elementToDrag);se(h,Se.ghostProxy),this._ghostProxyParent?(this._ghostProxyParent.appendChild(h),this._currentParentPosition=fe(this._elementToDrag.parentNode),this._ghostParentPosition=fe(this._ghostProxyParent),this._ghostDx=this._currentParentPosition.x-this._ghostParentPosition.x,this._ghostDy=this._currentParentPosition.y-this._ghostParentPosition.y):this._elementToDrag.parentNode.appendChild(h),this._dragEl=h,this._isConstrained=!0}l=o}else this._isConstrained&&(this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag,this._isConstrained=!1,this._currentParentPosition=null,this._ghostParentPosition=null,this._ghostDx=0,this._ghostDy=0);this.manager.setPosition(this._dragEl,{x:l.x+this._ghostDx,y:l.y+this._ghostDy}),this._dispatch(bn,{el:this.el,pos:l,e:s,drag:this,size:this._size,originalPos:this._posAtDown})}}},{key:"abort",value:function(){this._downAt!=null&&this._upListener()}},{key:"getDragElement",value:function(e){return e?this._elementToDrag||this.el:this._dragEl||this.el}},{key:"stop",value:function(e,t){if(t||this._moving){var s=[],o=this.manager.getPosition(this._dragEl);s.push([this._dragEl,o,this,this._size]),this._dispatch(An,{el:this._dragEl,pos:this._ghostProxyOffsets||o,finalPos:o,e,drag:this,selection:s,size:this._size,originalPos:{x:this._posAtDown.x,y:this._posAtDown.y}})}else this._moving||this._activeSelectorParams.dragAbort&&this._activeSelectorParams.dragAbort(this._elementToDrag)}},{key:"_dispatch",value:function(e,t){var s=null;if(this._activeSelectorParams&&this._activeSelectorParams[e])s=this._activeSelectorParams[e](t);else if(this.listeners[e])for(var o=0;o<this.listeners[e].length;o++)try{var l=this.listeners[e][o](t);l!=null&&(s=l)}catch{}return s}},{key:"resolveGrid",value:function(){var e={grid:null,thresholdX:Rr/2,thresholdY:Fr/2};return this._activeSelectorParams!=null&&this._activeSelectorParams.grid!=null&&(e.grid=this._activeSelectorParams.grid,this._activeSelectorParams.snapThreshold!=null&&(e.thresholdX=this._activeSelectorParams.snapThreshold,e.thresholdY=this._activeSelectorParams.snapThreshold)),e}},{key:"toGrid",value:function(e){var t=this.resolveGrid(),s=t.grid,o=t.thresholdX,l=t.thresholdY;if(s==null)return e;var h=s?s.w/2:o,d=s?s.h/2:l;return si(e,s,h,d)}},{key:"setUseGhostProxy",value:function(e){this._useGhostProxy=e?it:Hr}},{key:"_doConstrain",value:function(e,t,s,o,l){return this._activeSelectorParams!=null&&this._activeSelectorParams.constrainFunction&&typeof this._activeSelectorParams.constrainFunction=="function"?this._activeSelectorParams.constrainFunction(e,t,s,o,l):e}},{key:"_testFilter",value:function(e){for(var t in this._filters){var s=this._filters[t],o=s[0](e);if(s[1]&&(o=!o),!o)return!1}return!0}},{key:"addFilter",value:function(e,t){var s=this;if(e){var o=Nr(e);this._filters[o]=[function(l){var h=l.srcElement||l.target,d;return pe(e)?d=le(h,e,s.el):typeof e=="function"&&(d=e(l,s.el)),d},t!==!1]}}},{key:"removeFilter",value:function(e){var t=typeof e=="function"?e._katavorioId:e;delete this._filters[t]}},{key:"clearAllFilters",value:function(){this._filters={}}},{key:"addSelector",value:function(e,t){e.selector&&(t?this._availableSelectors.unshift(e):this._availableSelectors.push(e))}},{key:"destroy",value:function(){this.eventManager.off(this.el,A,this.downListener),this.eventManager.off(document,ae,this.moveListener),this.eventManager.off(document,x,this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null,this.scrollTracker!=null&&document.removeEventListener("scroll",this.scrollTracker)}}]),n}(Ur),Zr=["input","textarea","select","button","option"],Xr=Zr.join(","),$r=function(){function r(a){O(this,r),u(this,"eventManager",void 0),u(this,"zoom",1),u(this,"css",{}),u(this,"inputFilterSelector",void 0),u(this,"positioningStrategy",void 0),u(this,"_positionSetter",void 0),u(this,"_positionGetter",void 0),u(this,"_sizeSetter",void 0),u(this,"_sizeGetter",void 0),a=a||{},this.inputFilterSelector=a.inputFilterSelector||Xr,this.eventManager=new Dn,this.zoom=a.zoom||1,this.positioningStrategy=a.positioningStrategy||U.absolutePosition,this._positionGetter=Pt.get(this.positioningStrategy),this._positionSetter=kt.get(this.positioningStrategy),this._sizeGetter=At.get(this.positioningStrategy),this._sizeSetter=bt.get(this.positioningStrategy);var n=a.css||{};R(this.css,n)}return M(r,[{key:"getPosition",value:function(n){return this._positionGetter(n)}},{key:"setPosition",value:function(n,i){this._positionSetter(n,i)}},{key:"getSize",value:function(n){return this._sizeGetter(n)}},{key:"getZoom",value:function(){return this.zoom}},{key:"setZoom",value:function(n){this.zoom=n}},{key:"_prepareParams",value:function(n){n=n||{};var i={events:{}},e;for(e in n)i[e]=n[e];for(e=0;e<rt.length;e++)i.events[rt[e]]=n[rt[e]]||Vr;return i}},{key:"getInputFilterSelector",value:function(){return this.inputFilterSelector}},{key:"setInputFilterSelector",value:function(n){return this.inputFilterSelector=n,this}},{key:"draggable",value:function(n,i){if(n._katavorioDrag==null){var e=this._prepareParams(i),t=new Yr(n,e,this);return se(n,Se.delegatedDraggable),n._katavorioDrag=t,t}else return n._katavorioDrag}},{key:"destroyDraggable",value:function(n){n._katavorioDrag&&(n._katavorioDrag.destroy(),delete n._katavorioDrag)}}]),r}(),We="jtk-drag-selected",Jr=function(){function r(a){O(this,r),this.instance=a,u(this,"_dragSelection",[]),u(this,"_dragSizes",new Map),u(this,"_dragElements",new Map),u(this,"_dragElementStartPositions",new Map),u(this,"_dragElementPositions",new Map),u(this,"__activeSet",void 0)}return M(r,[{key:"_activeSet",get:function(){return this.__activeSet==null?this._dragSelection:this.__activeSet}},{key:"length",get:function(){return this._dragSelection.length}},{key:"filterActiveSet",value:function(n){var i=this;this.__activeSet=[],T(this._dragSelection,function(e){n(e)&&i.__activeSet.push(e)})}},{key:"clear",value:function(){var n=this;this.reset(),T(this._dragSelection,function(i){return n.instance.removeClass(i.jel,We)}),this._dragSelection.length=0}},{key:"reset",value:function(){this._dragElementStartPositions.clear(),this._dragElementPositions.clear(),this._dragSizes.clear(),this._dragElements.clear(),this.__activeSet=null}},{key:"initialisePositions",value:function(){var n=this;T(this._activeSet,function(i){var e=n.instance.viewport.getPosition(i.id),t={x:parseInt(""+i.jel.offsetLeft,10),y:parseInt(""+i.jel.offsetTop,10)};n._dragElementStartPositions.set(i.id,t),n._dragElementPositions.set(i.id,t),n._dragSizes.set(i.id,{w:e.w,h:e.h})})}},{key:"updatePositions",value:function(n,i,e){var t=this,s=n.x-i.x,o=n.y-i.y;T(this._activeSet,function(l){var h=t._dragElementStartPositions.get(l.id);if(h){var d=h.x+s,c=h.y+o,_=t._dragSizes.get(l.id),p={x:d,y:c,w:_.w,h:_.h};if(l.jel._jsPlumbParentGroup&&l.jel._jsPlumbParentGroup.constrain){var v={w:l.jel.parentNode.offsetWidth+l.jel.parentNode.scrollLeft,h:l.jel.parentNode.offsetHeight+l.jel.parentNode.scrollTop};p.x=Math.max(p.x,0),p.y=Math.max(p.y,0),p.x=Math.min(p.x,v.w-_.w),p.y=Math.min(p.y,v.h-_.h)}t._dragElementPositions.set(l.id,{x:d,y:c}),l.jel.style.left=p.x+"px",l.jel.style.top=p.y+"px",e(l.jel,l.id,_,p)}})}},{key:"each",value:function(n){var i=this;T(this._activeSet,function(e){var t=i._dragSizes.get(e.id),s=i._dragElementPositions.get(e.id),o=i._dragElementStartPositions.get(e.id);n(e.jel,e.id,s,t,o)})}},{key:"add",value:function(n,i){var e=n;i=i||this.instance.getId(e);var t=It(this._dragSelection,function(s){return s.id===i});t===-1&&(this.instance.addClass(n,We),this._dragSelection.push({id:i,jel:e}))}},{key:"remove",value:function(n){var i=this,e=n;this._dragSelection=this._dragSelection.filter(function(t){var s=t.jel!==e;return s||i.instance.removeClass(t.jel,We),s})}},{key:"toggle",value:function(n){var i=n,e=It(this._dragSelection,function(t){return t.jel===i});e!==-1?this.remove(i):this.add(n)}}]),r}(),Kr="jtk-delegated-draggable",zr="jtk-draggable",qr="jtk-drag",Qr="jtk-ghost-proxy",te="jtk-drag-active",es="jtk-dragged",ne="jtk-drag-hover",ts=function(){function r(a,n,i){var e=this;O(this,r),this.instance=a,this.dragSelection=n,u(this,"collicat",void 0),u(this,"drag",void 0),u(this,"_draggables",{}),u(this,"_dlist",[]),u(this,"_elementsWithEndpoints",{}),u(this,"_draggablesForElements",{}),u(this,"handlers",[]),u(this,"_trackScroll",void 0),u(this,"_filtersToAdd",[]),this.collicat=new $r({zoom:this.instance.currentZoom,css:{noSelect:this.instance.dragSelectClass,delegatedDraggable:Kr,draggable:zr,drag:qr,selected:We,active:te,hover:ne,ghostProxy:Qr}}),this.instance.bind(jn,function(t){e.collicat.setZoom(t)}),i=i||{},this._trackScroll=i.trackScroll!==!1}return M(r,[{key:"addHandler",value:function(n,i){var e=this,t=R({selector:n.selector},i||{});t.start=je(t.start,function(l){return n.onStart(l)},!1),t.drag=je(t.drag,function(l){return n.onDrag(l)}),t.stop=je(t.stop,function(l){return n.onStop(l)});var s=(n.onBeforeStart||function(l){}).bind(n);if(t.beforeStart=je(t.beforeStart,function(l){return s(l)}),t.dragInit=function(l,h){return n.onDragInit(l,h)},t.dragAbort=function(l){return n.onDragAbort(l)},n.useGhostProxy&&(t.useGhostProxy=n.useGhostProxy,t.makeGhostProxy=n.makeGhostProxy),t.constrainFunction==null&&t.containment!=null)switch(t.containment){case be.notNegative:{t.constrainFunction=function(l,h,d,c){return{x:Math.max(0,Math.min(l.x)),y:Math.max(0,Math.min(l.y))}};break}case be.parent:{var o=t.containmentPadding||5;t.constrainFunction=function(l,h,d,c){var _=l.x<0?0:l.x>d.w-o?d.w-o:l.x,p=l.y<0?0:l.y>d.h-o?d.h-o:l.y;return{x:_,y:p}};break}case be.parentEnclosed:{t.constrainFunction=function(l,h,d,c){var _=l.x<0?0:l.x+c.w>d.w?d.w-c.w:l.x,p=l.y<0?0:l.y+c.h>d.h?d.h-c.h:l.y;return{x:_,y:p}};break}}this.drag==null?(t.trackScroll=this._trackScroll,this.drag=this.collicat.draggable(this.instance.getContainer(),t),T(this._filtersToAdd,function(l){return e.drag.addFilter(l[0],l[1])}),this.drag.on(Ye,function(l){e.instance.revalidate(l)})):this.drag.addSelector(t),this.handlers.push({handler:n,options:t}),n.init(this.drag)}},{key:"addSelector",value:function(n,i){this.drag&&this.drag.addSelector(n,i)}},{key:"addFilter",value:function(n,i){this.drag==null?this._filtersToAdd.push([n,i===!0]):this.drag.addFilter(n,i)}},{key:"removeFilter",value:function(n){this.drag!=null&&this.drag.removeFilter(n)}},{key:"setFilters",value:function(n){var i=this;T(n,function(e){i.drag.addFilter(e[0],e[1])})}},{key:"reset",value:function(){var n=[];if(T(this.handlers,function(t){t.handler.reset()}),this.handlers.length=0,this.drag!=null){var i=this.drag._filters;for(var e in i)n.push([e,i[e][1]]);this.collicat.destroyDraggable(this.instance.getContainer())}return delete this.drag,n}},{key:"setOption",value:function(n,i){var e=un(this.handlers,function(t){return t.handler===n});e!=null&&R(e.options,i||{})}}]),r}();function ns(r,a){return pe(a)?{id:a,active:!0}:{id:a.id,active:a.active}}function is(r,a){var n=hn(r.members,function(i){return i.el===a});return n!==null?n.active===!0:!1}function rs(r){for(var a=[],n=r._jsPlumbParentGroup;n!=null;)a.push(n.el),n=n.group;return a}var mt=function(){function r(a,n){O(this,r),this.instance=a,this._dragSelection=n,u(this,"selector","> "+P+":not("+oe(yt)+")"),u(this,"_dragOffset",null),u(this,"_groupLocations",[]),u(this,"_intersectingGroups",[]),u(this,"_currentDragParentGroup",null),u(this,"_dragGroupByElementIdMap",{}),u(this,"_dragGroupMap",{}),u(this,"_currentDragGroup",null),u(this,"_currentDragGroupOffsets",new Map),u(this,"_currentDragGroupSizes",new Map),u(this,"_currentDragGroupOriginalPositions",new Map),u(this,"_dragPayload",null),u(this,"drag",void 0),u(this,"originalPosition",void 0)}return M(r,[{key:"onDragInit",value:function(n){return null}},{key:"onDragAbort",value:function(n){return null}},{key:"getDropGroup",value:function(){var n=null;if(this._intersectingGroups.length>0){var i=this._intersectingGroups[0].groupLoc.group,e=this._intersectingGroups[0].intersectingElement,t=e._jsPlumbParentGroup;t!==i&&(t==null||!t.overrideDrop(e,i))&&(n=this._intersectingGroups[0])}return n}},{key:"onStop",value:function(n){var i,e=this,t=n.drag.getDragElement(),s=this.getDropGroup(),o=[];o.push({el:t,id:this.instance.getId(t),pos:n.finalPos,originalGroup:t._jsPlumbParentGroup,redrawResult:null,originalPos:n.originalPos,reverted:!1,dropGroup:s!=null?s.groupLoc.group:null});function l(v,y,g,E,m){var C=g.x,S=g.y;if(v._jsPlumbParentGroup&&v._jsPlumbParentGroup.constrain){var k={w:v.parentNode.offsetWidth+v.parentNode.scrollLeft,h:v.parentNode.offsetHeight+v.parentNode.scrollTop};C=Math.max(C,0),S=Math.max(S,0),C=Math.min(C,k.w-E.w),S=Math.min(S,k.h-E.h),g.x=C,g.y=S}o.push({el:v,id:y,pos:g,originalPos:m,originalGroup:v._jsPlumbParentGroup,redrawResult:null,reverted:!1,dropGroup:s==null?void 0:s.groupLoc.group})}if(this._dragSelection.each(function(v,y,g,E,m){v!==n.el&&l(v,y,{x:g.x,y:g.y},E,m)}),(i=this._currentDragGroup)===null||i===void 0||i.members.forEach(function(v){if(v.el!==n.el){var y=e._currentDragGroupOffsets.get(v.elId),g=e._currentDragGroupSizes.get(v.elId),E={x:n.finalPos.x+y[0].x,y:n.finalPos.y+y[0].y};l(v.el,v.elId,E,g,e._currentDragGroupOriginalPositions.get(v.elId))}}),T(o,function(v){var y=v.originalGroup!=null,g=y&&Xt(e.instance,v.el,v.pos),E={x:0,y:0};if(y&&!g){if(s==null){var m=e._pruneOrOrphan(v,!0,!0);m.pos!=null?v.pos=m.pos.pos:!m.pruned&&v.originalGroup.revert&&(v.pos=v.originalPos,v.reverted=!0)}}else y&&g&&(E=e._computeOffsetByParentGroup(v.originalGroup));s!=null&&!g?e.instance.groupManager.addToGroup(s.groupLoc.group,!1,v.el):v.dropGroup=null,v.reverted&&e.instance.setPosition(v.el,v.pos),v.redrawResult=e.instance.setElementPosition(v.el,v.pos.x+E.x,v.pos.y+E.y),e.instance.removeClass(v.el,es),e.instance.select({source:v.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.sourceElementDraggingClass,!0),e.instance.select({target:v.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.targetElementDraggingClass,!0)}),o[0].originalGroup!=null){var h=t._jsPlumbParentGroup;if(h!==o[0].originalGroup){var d=n.drag.getDragElement(!0);if(o[0].originalGroup.ghost){var c=this.instance.getPosition(this.instance.getGroupContentArea(h)),_=this.instance.getPosition(this.instance.getGroupContentArea(o[0].originalGroup)),p={x:_.x+n.pos.x-c.x,y:_.y+n.pos.y-c.y};d.style.left=p.x+"px",d.style.top=p.y+"px",this.instance.revalidate(d)}}}this.instance.fire(Vi,{elements:o,e:n.e,el:t,payload:this._dragPayload}),this._cleanup()}},{key:"_cleanup",value:function(){var n=this;T(this._groupLocations,function(i){n.instance.removeClass(i.el,te),n.instance.removeClass(i.el,ne)}),this._currentDragParentGroup=null,this._groupLocations.length=0,this.instance.hoverSuspended=!1,this._dragOffset=null,this._dragSelection.reset(),this._dragPayload=null,this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroupOriginalPositions.clear(),this._currentDragGroup=null}},{key:"reset",value:function(){}},{key:"init",value:function(n){this.drag=n}},{key:"onDrag",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getId(e),s=n.pos,o=this.instance.viewport.getPosition(t),l={x:s.x,y:s.y};this._intersectingGroups.length=0,this._dragOffset!=null&&(l.x+=this._dragOffset.x,l.y+=this._dragOffset.y);var h=function(_,p,v){if(v){var y=new Set;T(i._groupLocations,function(g){!y.has(g.group.id)&&cn(p,g.r)?(g.group!==i._currentDragParentGroup&&i.instance.addClass(g.el,ne),i._intersectingGroups.push({groupLoc:g,intersectingElement:n.drag.getDragElement(!0),d:0}),T(i.instance.groupManager.getAncestors(g.group),function(E){return y.add(E.id)})):i.instance.removeClass(g.el,ne)})}i.instance.setElementPosition(_,p.x,p.y),i.instance.fire(Hi,{el:_,e:n.e,pos:{x:p.x,y:p.y},originalPosition:i.originalPosition,payload:i._dragPayload})},d={x:l.x,y:l.y,w:o.w,h:o.h};h(e,d,!0),this._dragSelection.updatePositions(s,this.originalPosition,function(c,_,p,v){h(c,v,!1)}),this._currentDragGroupOffsets.forEach(function(c,_){var p=i._currentDragGroupSizes.get(_),v={x:d.x+c[0].x,y:d.y+c[0].y,w:p.w,h:p.h};c[1].style.left=v.x+"px",c[1].style.top=v.y+"px",h(c[1],v,!1)})}},{key:"_computeOffsetByParentGroup",value:function(n){var i=this.instance.getPosition(n.el),e=n.contentArea;if(e!==n.el){var t=this.instance.getPosition(e);i.x+=t.x,i.y+=t.y}if(n.el._jsPlumbParentGroup){var s=this._computeOffsetByParentGroup(n.el._jsPlumbParentGroup);i.x+=s.x,i.y+=s.y}return i}},{key:"onStart",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getPosition(e);this.originalPosition={x:n.pos.x,y:n.pos.y},e._jsPlumbParentGroup&&(this._dragOffset=this._computeOffsetByParentGroup(e._jsPlumbParentGroup),this._currentDragParentGroup=e._jsPlumbParentGroup);var s=!0,o=e.getAttribute(He);if((this.instance.elementsDraggable===!1||o!=null&&o!==ve)&&(s=!1),s){this._groupLocations.length=0,this._intersectingGroups.length=0,this.instance.hoverSuspended=!0;var l=n.drag.getDragElement(!0),h=l.querySelectorAll(P),d=rs(l),c=[];Array.prototype.push.apply(c,h),Array.prototype.push.apply(c,d),this._dragSelection.filterActiveSet(function(y){return c.indexOf(y.jel)===-1}),this._dragSelection.initialisePositions();var _=function(g,E,m){if(!g._isJsPlumbGroup||i.instance.allowNestedGroups){var C=!g._jsPlumbParentGroup,S=C||g._jsPlumbParentGroup.dropOverride!==!0,k=!C&&(g._jsPlumbParentGroup.ghost||g._jsPlumbParentGroup.constrain!==!0);(C||S&&k)&&(T(i.instance.groupManager.getGroups(),function(b){var Ge=g._jsPlumbGroup;if(b.droppable!==!1&&b.enabled!==!1&&g._jsPlumbGroup!==b&&!i.instance.groupManager.isDescendant(b,Ge)){var qe=b.el,Nn=i.instance.getId(qe),Ie=i.instance.viewport.getPosition(Nn),wn={x:Ie.x,y:Ie.y,w:Ie.w,h:Ie.h},Gn={el:qe,r:wn,group:b};i._groupLocations.push(Gn),b!==i._currentDragParentGroup&&i.instance.addClass(qe,te)}}),i._groupLocations.sort(function(b,Ge){return i.instance.groupManager.isDescendant(b.group,Ge.group)?-1:i.instance.groupManager.isAncestor(Ge.group,b.group)?1:0}))}return i.instance.select({source:g}).addClass(i.instance.elementDraggingClass+" "+i.instance.sourceElementDraggingClass,!0),i.instance.select({target:g}).addClass(i.instance.elementDraggingClass+" "+i.instance.targetElementDraggingClass,!0),i.instance.fire(Bi,{el:g,e:n.e,originalPosition:i.originalPosition,pos:i.originalPosition,dragGroup:E,dragGroupMemberSpec:m})},p=this.instance.getId(e);this._currentDragGroup=this._dragGroupByElementIdMap[p],this._currentDragGroup&&!is(this._currentDragGroup,e)&&(this._currentDragGroup=null);var v=_(e);if(v===!1)return this._cleanup(),!1;this._dragPayload=v,this._currentDragGroup!=null&&(this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroup.members.forEach(function(y){var g=i.instance.viewport.getPosition(y.elId);i._currentDragGroupOffsets.set(y.elId,[{x:g.x-t.x,y:g.y-t.y},y.el]),i._currentDragGroupSizes.set(y.elId,g),i._currentDragGroupOriginalPositions.set(y.elId,{x:g.x,y:g.y}),_(y.el,i._currentDragGroup,y)}))}return s}},{key:"addToDragGroup",value:function(n){var i=this,e=ns(this.instance,n),t=this._dragGroupMap[e.id];t==null&&(t={id:e.id,members:new Set},this._dragGroupMap[e.id]=t);for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];this.removeFromDragGroup.apply(this,o),T(o,function(h){var d=i.instance.getId(h);t.members.add({elId:d,el:h,active:e.active}),i._dragGroupByElementIdMap[d]=t})}},{key:"removeFromDragGroup",value:function(){for(var n=this,i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];T(e,function(s){var o=n.instance.getId(s),l=n._dragGroupByElementIdMap[o];if(l!=null){var h=new Set;l.members.forEach(function(d){d.el!==s&&h.add(d)}),l.members=h,delete n._dragGroupByElementIdMap[o]}})}},{key:"setDragGroupState",value:function(n){for(var i=this,e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];var o=t.map(function(l){return i.instance.getId(l)});T(o,function(l){var h=i._dragGroupByElementIdMap[l];if(h!=null){var d=hn(h.members,function(c){return c.elId===l});d!=null&&(d.active=n)}})}},{key:"clearDragGroup",value:function(n){var i=this,e=this._dragGroupMap[n];e!=null&&(e.members.forEach(function(t){delete i._dragGroupByElementIdMap[t.elId]}),e.members.clear())}},{key:"_pruneOrOrphan",value:function(n,i,e){var t=n.el,s={pruned:!1,pos:null};if(e||!Xt(this.instance,t,n.pos)){var o=t._jsPlumbParentGroup;o.prune?(t._isJsPlumbGroup?this.instance.removeGroup(t._jsPlumbGroup):o.remove(n.el,!0),s.pruned=!0):o.orphan&&(s.pos=this.instance.groupManager.orphan(n.el,i),t._isJsPlumbGroup?o.removeGroup(t._jsPlumbGroup):o.remove(n.el))}return s}}]),r}();function ss(r,a,n,i,e,t){var s=ii(t,i,e),o={paintStyle:r.getPaintStyle(),preparedAnchor:s,element:i,scope:r.scope,cssClass:[an,r.cssClass].join(" ")};a!=null&&(hi(a,on)?o.existingEndpoint=a:o.endpoint=a);var l=t._internal_newEndpoint(o);return t._paintEndpoint(l,{}),l}function as(r,a,n,i,e){for(var t=r.target||r.srcElement,s=!1,o=i.getSelector(a,n),l=0;l<o.length;l++)if(o[l]===t){s=!0;break}return e?!s:s}var os=oe(te,ne),$t="sourceSelectorEndpoint",Jt=function(){function r(a){O(this,r),this.instance=a,u(this,"jpc",void 0),u(this,"existingJpc",void 0),u(this,"_originalAnchorSpec",void 0),u(this,"ep",void 0),u(this,"endpointRepresentation",void 0),u(this,"canvasElement",void 0),u(this,"_activeDefinition",void 0),u(this,"placeholderInfo",{id:null,element:null}),u(this,"floatingIndex",void 0),u(this,"floatingId",void 0),u(this,"floatingElement",void 0),u(this,"floatingEndpoint",void 0),u(this,"floatingAnchor",void 0),u(this,"_stopped",void 0),u(this,"inPlaceCopy",void 0),u(this,"endpointDropTargets",[]),u(this,"currentDropTarget",null),u(this,"payload",void 0),u(this,"floatingConnections",{}),u(this,"_forceReattach",void 0),u(this,"_forceDetach",void 0),u(this,"mousedownHandler",void 0),u(this,"mouseupHandler",void 0),u(this,"selector",oe(ke));var n=a.getContainer();this.mousedownHandler=this._mousedownHandler.bind(this),this.mouseupHandler=this._mouseupHandler.bind(this),a.on(n,A,P,this.mousedownHandler),a.on(n,x,[P,oe(ke)].join(","),this.mouseupHandler)}return M(r,[{key:"_resolveDragParent",value:function(n,i){var e=this.instance.getContainer(),t=K(i,P,e,!0);if(n.parentSelector!=null){var s=K(i,n.parentSelector,e,!0);return s!=null&&(t=K(s.parentNode,P,e,!1)),s||t}else return t}},{key:"_mousedownHandler",value:function(n){var i,e;if(!(n.which===3||n.button===2)){var t=n.target||n.srcElement;if(e=this._getSourceDefinition(n),!(e!=null&&(i=this._resolveDragParent(e.def.def,t),i==null||i.getAttribute(Fe)===ve))&&e){var s=n.currentTarget,o;if(t.getAttribute(Fe)!==ve){if(Oe(n),this._activeDefinition=e,o=e.def.def,o.canAcceptNewConnection!=null&&!o.canAcceptNewConnection(i,n))return!1;var l=zt(n,i,this.instance.currentZoom),h={element:i};if(R(h,o),h.isTemporarySource=!0,o.scope)h.scope=o.scope;else{var d=t.getAttribute(tt);d!=null&&(h.scope=d)}var c=o.parameterExtractor?o.parameterExtractor(i,t,n):{};if(h=jt(h,c),h.maxConnections!=null&&h.maxConnections>=0){var _=this.instance.select({source:i}).length;if(_>=h.maxConnections)return Oe(n),o.onMaxConnections&&o.onMaxConnections({element:i,maxConnections:h.maxConnections},n),n.stopImmediatePropagation&&n.stopImmediatePropagation(),!1}if(o.anchorPositionFinder){var p=o.anchorPositionFinder(i,l,o,n);p!=null&&(h.anchor=p)}this._originalAnchorSpec=h.anchor||(this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors[0]:this.instance.defaults.anchor);var v=this.instance.router.prepareAnchor(this._originalAnchorSpec),y=[l.x,l.y,0,0];if(v.locations.length>0)y[2]=v.locations[0].ox,y[3]=v.locations[0].oy;else if(v.isContinuous){var g=l.x<.5?l.x:1-l.x,E=l.y<.5?l.y:1-l.y;y[2]=g<E?l.x<.5?-1:1:0,y[3]=E<g?l.y<.5?-1:1:0}h.anchor=y,h.deleteOnEmpty=!0,this.ep=this.instance._internal_newEndpoint(h);var m={};if(o.extract){for(var C in o.extract){var S=t.getAttribute(C);S&&(m[o.extract[C]]=S)}this.ep.mergeParameters(m)}if(h.uniqueEndpoint){var k=this.ep.elementId,b=this.instance.getManagedData(k,$t,e.id);b==null?(this.instance.setManagedData(k,$t,e.id,this.ep),this.ep.deleteOnEmpty=!1):this.ep.finalEndpoint=b}s._jsPlumbOrphanedEndpoints=s._jsPlumbOrphanedEndpoints||[],s._jsPlumbOrphanedEndpoints.push(this.ep),this.instance.trigger(this.ep.endpoint.canvas,A,n,m)}}}}},{key:"_mouseupHandler",value:function(n){var i=n.currentTarget||n.srcElement;i._jsPlumbOrphanedEndpoints&&(ai(i._jsPlumbOrphanedEndpoints,this.instance._maybePruneEndpoint.bind(this.instance)),i._jsPlumbOrphanedEndpoints.length=0),this._activeDefinition=null}},{key:"onDragInit",value:function(n){var i=Re(n,this.instance),e=me(n,this.instance);return this._makeDraggablePlaceholder(i,e),this.placeholderInfo.element.jtk=n.jtk,this.placeholderInfo.element}},{key:"onDragAbort",value:function(n){this._cleanupDraggablePlaceholder()}},{key:"_makeDraggablePlaceholder",value:function(n,i){this.placeholderInfo=this.placeholderInfo||{};var e=pn(En,{position:"absolute"});this.instance._appendElementToContainer(e);var t=this.instance.getId(e);return this.instance.setPosition(e,n),e.style.width=i.w+"px",e.style.height=i.h+"px",this.instance.manage(e),this.placeholderInfo.id=t,this.placeholderInfo.element=e,e}},{key:"_cleanupDraggablePlaceholder",value:function(){this.placeholderInfo.element&&(this.instance.unmanage(this.placeholderInfo.element,!0),delete this.placeholderInfo.element,delete this.placeholderInfo.id)}},{key:"reset",value:function(){var n=this.instance.getContainer();this.instance.off(n,x,this.mouseupHandler),this.instance.off(n,A,this.mousedownHandler)}},{key:"init",value:function(n){}},{key:"startNewConnectionDrag",value:function(n,i){this.jpc=this.instance._newConnection({sourceEndpoint:this.ep,targetEndpoint:this.floatingEndpoint,source:this.ep.element,target:this.placeholderInfo.element,paintStyle:this.ep.connectorStyle,hoverPaintStyle:this.ep.connectorHoverStyle,connector:this.ep.connector,overlays:this.ep.connectorOverlays,type:this.ep.edgeType,cssClass:this.ep.connectorClass,hoverClass:this.ep.connectorHoverClass,scope:n,data:i}),this.jpc.pending=!0,this.jpc.addClass(this.instance.draggingClass),this.ep.addClass(this.instance.draggingClass),this.instance.fire(Vt,this.jpc)}},{key:"startExistingConnectionDrag",value:function(){this.existingJpc=!0,this.instance.setHover(this.jpc,!1);var n=this.jpc.endpoints[0].id===this.ep.id?0:1;this.ep.detachFromConnection(this.jpc,null,!0),this.floatingEndpoint.addConnection(this.jpc),this.instance.fire(Vt,this.jpc),this.instance.sourceOrTargetChanged(this.jpc.endpoints[n].elementId,this.placeholderInfo.id,this.jpc,this.placeholderInfo.element,n),this.jpc.suspendedEndpoint=this.jpc.endpoints[n],this.jpc.suspendedElement=this.jpc.endpoints[n].element,this.jpc.suspendedElementId=this.jpc.endpoints[n].elementId,this.jpc.suspendedElementType=n===0?Mt:Ln,this.instance.setHover(this.jpc.suspendedEndpoint,!1),this.floatingEndpoint.referenceEndpoint=this.jpc.suspendedEndpoint,this.floatingEndpoint.mergeParameters(this.jpc.suspendedEndpoint.parameters),this.jpc.endpoints[n]=this.floatingEndpoint,this.jpc.addClass(this.instance.draggingClass),this.floatingId=this.placeholderInfo.id,this.floatingIndex=n,this.instance._refreshEndpoint(this.ep)}},{key:"_shouldStartDrag",value:function(){var n=!0;this.ep.enabled||(n=!1),this.jpc==null&&!this.ep.isSource&&!this.ep.isTemporarySource&&(n=!1),this.ep.isSource&&this.ep.isFull()&&!(this.jpc!=null&&this.ep.dragAllowedWhenFull)&&(n=!1),this.jpc!=null&&!this.jpc.isDetachable(this.ep)&&(this.ep.isFull()?n=!1:this.jpc=null);var i={},e=this.instance.checkCondition(this.jpc==null?Rn:Fn,{endpoint:this.ep,source:this.ep.element,sourceId:this.ep.elementId,connection:this.jpc});return e===!1?n=!1:ge(e)==="object"?(i=e,R(i,this.payload||{})):i=this.payload||{},[n,i]}},{key:"_createFloatingEndpoint",value:function(n){var i=this.ep.endpoint;if(this.ep.edgeType!=null){var e=this.instance._deriveEndpointAndAnchorSpec(this.ep.edgeType);i=e.endpoints[1]}this.floatingEndpoint=ss(this.ep,i,n,this.placeholderInfo.element,this.placeholderInfo.id,this.instance),this.floatingAnchor=this.floatingEndpoint._anchor,this.floatingEndpoint.deleteOnEmpty=!0,this.floatingElement=this.floatingEndpoint.endpoint.canvas,this.floatingId=this.instance.getId(this.floatingElement)}},{key:"_populateTargets",value:function(n,i){var e=this,t=this.jpc&&this.jpc.endpoints[0]===this.ep,s,o=this.instance.getContainer().querySelectorAll([".",ke,"[",sn,this.ep.scope,"]:not(.",an,")"].join(""));if(T(o,function(c){if((e.jpc!=null||c!==n)&&c!==e.floatingElement&&(e.jpc!=null||!c.jtk.endpoint.isFull())&&(t&&c.jtk.endpoint.isSource||!t&&c.jtk.endpoint.isTarget)){var _=Re(c,e.instance),p=me(c,e.instance);s={x:_.x,y:_.y,w:p.w,h:p.h},e.endpointDropTargets.push({el:c,targetEl:c,r:s,endpoint:c.jtk.endpoint,def:null}),e.instance.addClass(c,te)}}),t){var l=un(this.instance.sourceSelectors,function(c){return c.isEnabled()&&(c.def.def.scope==null||c.def.def.scope===e.ep.scope)});if(l!=null){var h=this._findTargetZones(l);T(h,function(c){if(c.getAttribute(Fe)!==ve){var _=c.getAttribute(tt);if(_!=null&&_!==e.ep.scope)return;var p={r:null,el:c};p.targetEl=K(c,P,e.instance.getContainer(),!0);var v=Re(p.el,e.instance),y=me(p.el,e.instance);p.r={x:v.x,y:v.y,w:y.w,h:y.h},l.def.def.rank!=null&&(p.rank=l.def.def.rank),p.def=l.def,e.endpointDropTargets.push(p),e.instance.addClass(p.targetEl,te)}})}}else{var d=oi(this.instance.targetSelectors,function(c){return c.isEnabled()});d.forEach(function(c){var _=e._findTargetZones(c);T(_,function(p){if(p.getAttribute(Fe)!==ve){var v=p.getAttribute(tt);if(v!=null&&v!==e.ep.scope)return;var y={r:null,el:p};if(c.def.def.parentSelector!=null&&(y.targetEl=K(p,c.def.def.parentSelector,e.instance.getContainer(),!0)),y.targetEl==null&&(y.targetEl=K(p,P,e.instance.getContainer(),!0)),(c.def.def.allowLoopback===!1||e._activeDefinition&&e._activeDefinition.def.def.allowLoopback===!1)&&y.targetEl===e.ep.element||c.def.def.canAcceptNewConnection!=null&&!c.def.def.canAcceptNewConnection(y.targetEl,i))return;var g=c.def.def.maxConnections;if(g!=null&&g!==-1&&e.instance.select({target:y.targetEl}).length>=g)return;var E=Re(p,e.instance),m=me(p,e.instance);y.r={x:E.x,y:E.y,w:m.w,h:m.h},y.def=c.def,c.def.def.rank!=null&&(y.rank=c.def.def.rank),e.endpointDropTargets.push(y),e.instance.addClass(y.targetEl,te)}})})}this.endpointDropTargets.sort(function(c,_){if(c.targetEl._isJsPlumbGroup&&!_.targetEl._isJsPlumbGroup)return 1;if(!c.targetEl._isJsPlumbGroup&&_.targetEl._isJsPlumbGroup)return-1;if(c.targetEl._isJsPlumbGroup&&_.targetEl._isJsPlumbGroup){if(e.instance.groupManager.isAncestor(c.targetEl._jsPlumbGroup,_.targetEl._jsPlumbGroup))return-1;if(e.instance.groupManager.isAncestor(_.targetEl._jsPlumbGroup,c.targetEl._jsPlumbGroup))return 1}else if(c.rank!=null&&_.rank!=null){if(c.rank>_.rank)return-1;if(c.rank<_.rank)return 1}else return 0})}},{key:"_findTargetZones",value:function(n){var i;if(n.redrop===Hn){var e=this.instance.targetSelectors.map(function(s){return s.selector});e.push.apply(e,Rt(this.instance.sourceSelectors.map(function(s){return s.selector}))),e.push(P),i=e.join(",")}else if(n.redrop===Vn)i=n.selector;else if(n.redrop===Bn)i=this.instance.sourceSelectors.map(function(s){return s.selector}).join(",");else if(n.redrop===Un)i=this.instance.targetSelectors.map(function(s){return s.selector}).join(",");else if(n.redrop===Wn){var t=this.instance.targetSelectors.map(function(s){return s.selector});t.push.apply(t,Rt(this.instance.sourceSelectors.map(function(s){return s.selector}))),i=t.join(",")}return this.instance.getContainer().querySelectorAll(i)}},{key:"onStart",value:function(n){this.endpointDropTargets.length=0,this.currentDropTarget=null,this._stopped=!1;var i=n.drag.getDragElement();if(this.ep=i.jtk.endpoint,!this.ep)return!1;this.endpointRepresentation=this.ep.endpoint,this.canvasElement=this.endpointRepresentation.canvas,this.jpc=this.ep.connectorSelector();var e=this._shouldStartDrag(),t=pi(e,2),s=t[0],o=t[1];if(s===!1)return this._stopped=!0,!1;this.instance.setHover(this.ep,!1),this.instance.isConnectionBeingDragged=!0,this.jpc&&!this.ep.isFull()&&this.ep.isSource&&(this.jpc=null),this._createFloatingEndpoint(this.canvasElement),this._populateTargets(this.canvasElement,n.e),this.jpc==null?this.startNewConnectionDrag(this.ep.scope,o):this.startExistingConnectionDrag(),this._registerFloatingConnection(this.placeholderInfo,this.jpc),this.instance.currentlyDragging=!0}},{key:"onBeforeStart",value:function(n){this.payload=n.e.payload||{}}},{key:"onDrag",value:function(n){if(this._stopped)return!0;if(this.placeholderInfo.element){var i=me(this.floatingElement,this.instance);this.instance.setElementPosition(this.placeholderInfo.element,n.pos.x,n.pos.y);for(var e={x:n.pos.x,y:n.pos.y,w:i.w,h:i.h},t,s,o,l=0;l<this.endpointDropTargets.length;l++)if(cn(e,this.endpointDropTargets[l].r)){t=this.endpointDropTargets[l];break}if(t!==this.currentDropTarget&&this.currentDropTarget!=null&&(s=this._getFloatingAnchorIndex(),this.instance.removeClass(this.currentDropTarget.el,ne),this.currentDropTarget.endpoint&&(this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.out()),t!=null&&(this.instance.addClass(t.el,ne),s=this._getFloatingAnchorIndex(),t.endpoint!=null))if(o=t.endpoint.isSource&&s===0||t.endpoint.isTarget&&s!==0||this.jpc.suspendedEndpoint&&t.endpoint.referenceEndpoint&&t.endpoint.referenceEndpoint.id===this.jpc.suspendedEndpoint.id,o){var h=this.instance.checkCondition(Yn,{sourceEndpoint:this.jpc.endpoints[s],targetEndpoint:t.endpoint.endpoint,connection:this.jpc});h?(t.endpoint.endpoint.addClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)):(t.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.addClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.over(t.endpoint),this.instance._paintConnection(this.jpc)}else t=null;this.currentDropTarget=t}}},{key:"_maybeCleanup",value:function(n){n._mtNew&&n.connections.length===0?this.instance.deleteEndpoint(n):delete n._mtNew}},{key:"_reattachOrDiscard",value:function(n){var i=this.jpc.suspendedEndpoint!=null,e=this._getFloatingAnchorIndex();return i&&this._shouldReattach()?(e===0?(this.jpc.source=this.jpc.suspendedElement,this.jpc.sourceId=this.jpc.suspendedElementId):(this.jpc.target=this.jpc.suspendedElement,this.jpc.targetId=this.jpc.suspendedElementId),this._doForceReattach(e),!0):(this._discard(e,n),!1)}},{key:"onStop",value:function(n){var i=this,e=n.e;this.instance.isConnectionBeingDragged=!1,this.instance.currentlyDragging=!1;var t=Zn(ne,te),s=this.instance.getContainer().querySelectorAll(os);if(T(s,function(_){i.instance.removeClass(_,t)}),this.jpc&&this.jpc.endpoints!=null){var o=this.jpc.suspendedEndpoint!=null,l=this._getFloatingAnchorIndex(),h=this.jpc.suspendedEndpoint,d;if(this.currentDropTarget!=null)if(d=this._getDropEndpoint(n,this.jpc),d==null)this._reattachOrDiscard(n.e);else if(h&&h.id===d.id)this._doForceReattach(l);else if(!d.enabled)this._reattachOrDiscard(n.e);else if(d.isFull())d.fire(Xn,{endpoint:this,connection:this.jpc,maxConnections:this.instance.defaults.maxConnections},e),this._reattachOrDiscard(n.e);else{l===0?(this.jpc.source=d.element,this.jpc.sourceId=d.elementId):(this.jpc.target=d.element,this.jpc.targetId=d.elementId);var c=!0;o&&this.jpc.suspendedEndpoint.id!==d.id&&(!this.jpc.isDetachAllowed(this.jpc)||!this.jpc.endpoints[l].isDetachAllowed(this.jpc)||!this.jpc.suspendedEndpoint.isDetachAllowed(this.jpc)||!this.instance.checkCondition("beforeDetach",this.jpc))&&(c=!1),c=c&&d.isDropAllowed(this.jpc.sourceId,this.jpc.targetId,this.jpc.scope,this.jpc,d),c?this._drop(d,l,e,c):this._reattachOrDiscard(n.e)}else this._reattachOrDiscard(n.e);this.instance._refreshEndpoint(this.ep),this.ep.removeClass(this.instance.draggingClass),this._cleanupDraggablePlaceholder(),this.jpc.removeClass(this.instance.draggingClass),delete this.jpc.suspendedEndpoint,delete this.jpc.suspendedElement,delete this.jpc.suspendedElementType,delete this.jpc.suspendedElementId,delete this.jpc.suspendedIndex,delete this.floatingId,delete this.floatingIndex,delete this.floatingElement,delete this.floatingEndpoint,delete this.floatingAnchor,delete this.jpc.pending,d!=null&&this._maybeCleanup(d)}}},{key:"_getSourceDefinition",value:function(n){for(var i,e=this.instance.getContainer(),t=0;t<this.instance.sourceSelectors.length;t++)if(i=this.instance.sourceSelectors[t],i.isEnabled()){var s=as(n,e,i.selector,this.instance,i.exclude);if(s!==!1)return i}}},{key:"_getDropEndpoint",value:function(n,i){var e;if(this.currentDropTarget.endpoint==null){var t=this.currentDropTarget.def,s=n.e.target||n.e.srcElement;if(t==null)return null;var o=this.currentDropTarget.targetEl,l=zt(n.e,o,this.instance.currentZoom),h=this.instance._deriveEndpointAndAnchorSpec(i.getType().join(" "),!0),d=h.endpoints?R(n,{endpoint:t.def.endpoint||h.endpoints[1],cssClass:t.def.cssClass||"",source:t.def.source===!0,target:t.def.target===!0}):n,c=this.instance.validAnchorsSpec(h.anchors)?h.anchors:this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors:null,_=t.def.anchor,p=t.def.anchorPositionFinder?t.def.anchorPositionFinder(o,l,t.def,n.e):null,v=p??_??(c!=null&&c[1]!=null?c[1]:null);v!=null&&(d=R(d,{anchor:v})),t.def.portId!=null&&(d.portId=t.def.portId);var y=t.def.parameterExtractor?t.def.parameterExtractor(this.currentDropTarget.el,s,n.e):{};if(d=jt(d,y),d.element=o,e=this.instance._internal_newEndpoint(d),e._mtNew=!0,e.deleteOnEmpty=!0,t.def.parameters&&e.mergeParameters(t.def.parameters),t.def.extract){var g={};for(var E in t.def.extract){var m=this.currentDropTarget.el.getAttribute(E);m&&(g[t.def.extract[E]]=m)}e.mergeParameters(g)}}else e=this.currentDropTarget.endpoint;return e&&(e.removeClass(this.instance.endpointDropAllowedClass),e.removeClass(this.instance.endpointDropForbiddenClass)),e}},{key:"_doForceReattach",value:function(n){this.floatingEndpoint.detachFromConnection(this.jpc,null,!0),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint,this.instance.setHover(this.jpc,!1),this.jpc._forceDetach=!0,this.jpc.suspendedEndpoint.addConnection(this.jpc),this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.suspendedEndpoint.elementId,this.jpc,this.jpc.suspendedEndpoint.element,n),this.instance.deleteEndpoint(this.floatingEndpoint),this.instance.repaint(this.jpc.source),delete this.jpc._forceDetach}},{key:"_shouldReattach",value:function(){if(this.jpc.isReattach()||this.jpc._forceReattach)return!0;var n=this.jpc.suspendedEndpoint,i=this.jpc.suspendedElementType==Mt?1:0,e=this.jpc.endpoints[i];return!li(!0,!1,[[n,Qe,[this.jpc]],[e,Qe,[this.jpc]],[this.jpc,Qe,[this.jpc]],[this.instance,$n,[Jn,this.jpc]]])}},{key:"_discard",value:function(n,i){this.jpc.pending?this.instance.fire(Ui,this.jpc,i):(n===0?(this.jpc.source=this.jpc.suspendedEndpoint.element,this.jpc.sourceId=this.jpc.suspendedEndpoint.elementId):(this.jpc.target=this.jpc.suspendedEndpoint.element,this.jpc.targetId=this.jpc.suspendedEndpoint.elementId),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint),this.floatingEndpoint&&this.floatingEndpoint.detachFromConnection(this.jpc),this.instance.deleteConnection(this.jpc,{originalEvent:i,force:!0})}},{key:"_drop",value:function(n,i,e,t){if(this.jpc.endpoints[i].detachFromConnection(this.jpc),this.jpc.suspendedEndpoint&&this.jpc.suspendedEndpoint.detachFromConnection(this.jpc),this.jpc.endpoints[i]=n,n.addConnection(this.jpc),this.jpc.suspendedEndpoint){var s=this.jpc.suspendedEndpoint.elementId;this.instance.fireMoveEvent({index:i,originalSourceId:i===0?s:this.jpc.sourceId,newSourceId:i===0?n.elementId:this.jpc.sourceId,originalTargetId:i===1?s:this.jpc.targetId,newTargetId:i===1?n.elementId:this.jpc.targetId,originalEndpoint:this.jpc.suspendedEndpoint,connection:this.jpc,newEndpoint:n},e)}if(i===1?this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.targetId,this.jpc,this.jpc.target,1):this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.sourceId,this.jpc,this.jpc.source,0),this.jpc.endpoints[0].finalEndpoint){var o=this.jpc.endpoints[0];o.detachFromConnection(this.jpc),this.jpc.endpoints[0]=this.jpc.endpoints[0].finalEndpoint,this.jpc.endpoints[0].addConnection(this.jpc)}ui(t)&&this.jpc.mergeData(t),this._originalAnchorSpec&&(this.jpc.endpoints[0].setAnchor(this._originalAnchorSpec),this._originalAnchorSpec=null),this.instance._finaliseConnection(this.jpc,null,e),this.instance.setHover(this.jpc,!1),this.instance.revalidate(this.jpc.endpoints[0].element)}},{key:"_registerFloatingConnection",value:function(n,i){this.floatingConnections[n.id]=i}},{key:"_getFloatingAnchorIndex",value:function(){return this.floatingIndex==null?1:this.floatingIndex}}]),r}(),Kt=function(r){Ke(n,r);var a=ze(n);function n(i,e){var t;return O(this,n),t=a.call(this,i,e),t.instance=i,t.dragSelection=e,u(f(t),"selector",[">",dr,P].join(" ")),u(f(t),"doRevalidate",void 0),t.doRevalidate=t._revalidate.bind(f(t)),t}return M(n,[{key:"reset",value:function(){this.drag.off(Ye,this.doRevalidate)}},{key:"_revalidate",value:function(e){this.instance.revalidate(e)}},{key:"init",value:function(e){this.drag=e,e.on(Ye,this.doRevalidate)}},{key:"useGhostProxy",value:function(e,t){var s=t._jsPlumbParentGroup;return s==null?!1:s.ghost===!0}},{key:"makeGhostProxy",value:function(e){var t=e,s=t.cloneNode(!0);return s._jsPlumbParentGroup=t._jsPlumbParentGroup,s}}]),n}(mt),xt=function(){function r(a,n){O(this,r),this.instance=a,this.overlay=n,u(this,"htmlElementOverlay",void 0),this.htmlElementOverlay=n}return M(r,null,[{key:"getElement",value:function(n,i,e){if(n.canvas==null){if(e&&i){n.canvas=e(i);var t=n.instance.overlayClass+" "+(n.cssClass?n.cssClass:"");n.instance.addClass(n.canvas,t)}else n.canvas=pn(En,{},n.instance.overlayClass+" "+(n.cssClass?n.cssClass:""));n.instance.setAttribute(n.canvas,"jtk-overlay-id",n.id);for(var s in n.attributes)n.instance.setAttribute(n.canvas,s,n.attributes[s]);n.canvas.style.position=Ae,n.instance._appendElement(n.canvas,n.instance.getContainer()),n.instance.getId(n.canvas);var o="translate(-50%, -50%)";n.canvas.style.webkitTransform=o,n.canvas.style.mozTransform=o,n.canvas.style.msTransform=o,n.canvas.style.oTransform=o,n.canvas.style.transform=o,n.isVisible()||(n.canvas.style.display=xe),n.canvas.jtk={overlay:n}}return n.canvas}},{key:"destroy",value:function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas),delete n.canvas,delete n.cachedDimensions}},{key:"_getDimensions",value:function(n,i){return(n.cachedDimensions==null||i)&&(n.cachedDimensions={w:1,h:1}),n.cachedDimensions}}]),r}();function De(r){if(r.path==null){var a=R({"jtk-overlay-id":r.id},r.attributes);r.path=Z(vt,a);var n=r.instance.overlayClass+" "+(r.cssClass?r.cssClass:"");r.instance.addClass(r.path,n),r.path.jtk={overlay:r}}var i=r.path.parentNode;if(i==null){if(r.component instanceof st){var e=r.component.connector;i=e!=null?e.canvas:null}else if(r.component instanceof ln){var t=r.component.endpoint;i=t!=null?t.canvas:t}i!=null&&Ve(i,r.path,1)}return r.path}function ls(r,a,n,i){De(r);var e=[0,0];i.xmin<0&&(e[0]=-i.xmin),i.ymin<0&&(e[1]=-i.ymin);var t={d:a,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+e[0]+","+e[1]+")","pointer-events":"visibleStroke"};Y(r.path,t)}function us(r,a){var n=r;n.path!=null&&n.path.parentNode!=null&&n.path.parentNode.removeChild(n.path),n.bgPath!=null&&n.bgPath.parentNode!=null&&n.bgPath.parentNode.removeChild(n.bgPath),delete n.path,delete n.bgPath}(function(r){Ke(n,r);var a=ze(n);function n(){var i;O(this,n);for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return i=a.call.apply(a,[this].concat(t)),u(f(i),"path",void 0),i}return n})(Kn);var On=function(){function r(){O(this,r)}return M(r,null,[{key:"paint",value:function(n,i,e,t){if(e!=null){var s=[n.x,n.y],o=[n.w,n.h];if(t!=null&&(t.xmin<0&&(s[0]+=t.xmin),t.ymin<0&&(s[1]+=t.ymin),o[0]=t.xmax+(t.xmin<0?-t.xmin:0),o[1]=t.ymax+(t.ymin<0?-t.ymin:0)),isFinite(o[0])&&isFinite(o[1])){var l={width:""+(o[0]||0),height:""+(o[1]||0)};i.containerType===ue.HTML?Y(n.canvas,R(l,{style:yn([s[0],s[1]])})):Y(n.canvas,R(l,{x:s[0],y:s[1]}))}}}}]),r}();function cs(r,a,n,i){hs(r,a),On.paint(a,r,n,i);var e="",t=[0,0];if(i.xmin<0&&(t[0]=-i.xmin),i.ymin<0&&(t[1]=-i.ymin),a.segments.length>0){e=r.getPathData(a);var s={d:e,transform:"translate("+t[0]+","+t[1]+")","pointer-events":"visibleStroke"},o=null;if(n.outlineStroke){var l=n.outlineWidth||1,h=n.strokeWidth+2*l;o=R({},n),o.stroke=n.outlineStroke,o.strokeWidth=h,a.bgPath==null?(a.bgPath=Z(vt,s),r.addClass(a.bgPath,r.connectorOutlineClass),Ve(a.canvas,a.bgPath,0)):Y(a.bgPath,s),pt(a.canvas,a.bgPath,o)}var d=a;d.path==null?(d.path=Z(vt,s),Ve(d.canvas,d.path,n.outlineStroke?1:0)):(d.path.parentNode!==d.canvas&&Ve(d.canvas,d.path,n.outlineStroke?1:0),Y(a.path,s)),pt(a.canvas,a.path,n)}}function hs(r,a){if(a.canvas!=null)return a.canvas;var n=Z(mn,{style:"",width:"0",height:"0","pointer-events":xe,position:Ae});return a.canvas=n,r._appendElement(a.canvas,r.getContainer()),a.cssClass!=null&&r.addClass(n,a.cssClass),r.addClass(n,r.connectorClass),n.jtk=n.jtk||{},n.jtk.connector=a,n}var ds=function(){function r(){O(this,r)}return M(r,null,[{key:"getEndpointElement",value:function(n){if(n.canvas!=null)return n.canvas;var i=Z(mn,{style:"",width:"0",height:"0","pointer-events":"all",position:Ae});n.canvas=i;var e=n.classes.join(" ");n.instance.addClass(i,e);for(var t=n.endpoint.scope.split(/\s/),s=0;s<t.length;s++)n.instance.setAttribute(i,sn+t[s],dn);return n.instance._appendElementToContainer(i),n.cssClass!=null&&n.instance.addClass(i,n.cssClass),n.instance.addClass(i,n.instance.endpointClass),i.jtk=i.jtk||{},i.jtk.endpoint=n.endpoint,i.style.display=n.endpoint.visible!==!1?zn:xe,i}},{key:"paint",value:function(n,i,e){if(n.endpoint.deleted!==!0){this.getEndpointElement(n),On.paint(n,n.instance,e);var t=R({},e);t.outlineStroke&&(t.stroke=t.outlineStroke),n.node==null?(n.node=i.makeNode(n,t),n.canvas.appendChild(n.node)):i.updateNode!=null&&i.updateNode(n,n.node),pt(n.canvas,n.node,t)}}}]),r}(),Mn={};function Ot(r,a){Mn[r]=a}function zt(r,a,n){var i=a,e=ge(a.getBoundingClientRect)!==fn?a.getBoundingClientRect():{left:0,top:0,width:0,height:0},t=document.body,s=document.documentElement,o=window.pageYOffset||s.scrollTop||t.scrollTop,l=window.pageXOffset||s.scrollLeft||t.scrollLeft,h=s.clientTop||t.clientTop||0,d=s.clientLeft||t.clientLeft||0,c=0,_=0,p=e.top+o-h+c*n,v=e.left+l-d+_*n,y=Ze(r),g=e.width||i.offsetWidth*n,E=e.height||i.offsetHeight*n,m=(y.x-v)/g,C=(y.y-p)/E;return{x:m,y:C}}function de(r){return at(r)||ot(r)||lt(r)}function qt(r,a){r.canvas&&(r.canvas.style.display=a?"block":"none")}function Qt(r){r.canvas&&r.canvas.parentNode.removeChild(r.canvas),delete r.canvas}function Te(r){return r.canvas}function H(r){return xt.getElement(r)}function re(r){return xt.getElement(r,r.component,function(a){var n=r.create(a);return r.instance.addClass(n,r.instance.overlayClass),n})}function fs(r,a,n,i){var e=r.x,t=r.y;return a._jsPlumbParentGroup&&a._jsPlumbParentGroup.constrain&&(e=Math.max(r.x,0),t=Math.max(r.y,0),e=Math.min(e,n.w-i.w),t=Math.min(t,n.h-i.h)),{x:e,y:t}}var vs=function(r){Ke(n,r);var a=ze(n);function n(i,e){var t;if(O(this,n),t=a.call(this,i,e),t._instanceIndex=i,u(f(t),"containerType",null),u(f(t),"dragSelection",void 0),u(f(t),"dragManager",void 0),u(f(t),"_connectorClick",void 0),u(f(t),"_connectorDblClick",void 0),u(f(t),"_connectorTap",void 0),u(f(t),"_connectorDblTap",void 0),u(f(t),"_endpointClick",void 0),u(f(t),"_endpointDblClick",void 0),u(f(t),"_overlayClick",void 0),u(f(t),"_overlayDblClick",void 0),u(f(t),"_overlayTap",void 0),u(f(t),"_overlayDblTap",void 0),u(f(t),"_connectorMouseover",void 0),u(f(t),"_connectorMouseout",void 0),u(f(t),"_endpointMouseover",void 0),u(f(t),"_endpointMouseout",void 0),u(f(t),"_connectorContextmenu",void 0),u(f(t),"_connectorMousedown",void 0),u(f(t),"_connectorMouseup",void 0),u(f(t),"_endpointMousedown",void 0),u(f(t),"_endpointMouseup",void 0),u(f(t),"_overlayMouseover",void 0),u(f(t),"_overlayMouseout",void 0),u(f(t),"_elementClick",void 0),u(f(t),"_elementTap",void 0),u(f(t),"_elementDblTap",void 0),u(f(t),"_elementMouseenter",void 0),u(f(t),"_elementMouseexit",void 0),u(f(t),"_elementMousemove",void 0),u(f(t),"_elementMouseup",void 0),u(f(t),"_elementMousedown",void 0),u(f(t),"_elementContextmenu",void 0),u(f(t),"_resizeObserver",void 0),u(f(t),"eventManager",void 0),u(f(t),"draggingClass","jtk-dragging"),u(f(t),"elementDraggingClass","jtk-element-dragging"),u(f(t),"hoverClass","jtk-hover"),u(f(t),"sourceElementDraggingClass","jtk-source-element-dragging"),u(f(t),"targetElementDraggingClass","jtk-target-element-dragging"),u(f(t),"hoverSourceClass","jtk-source-hover"),u(f(t),"hoverTargetClass","jtk-target-hover"),u(f(t),"dragSelectClass","jtk-drag-select"),u(f(t),"managedElementsSelector",void 0),u(f(t),"elementsDraggable",void 0),u(f(t),"elementDragHandler",void 0),u(f(t),"groupDragOptions",void 0),u(f(t),"elementDragOptions",void 0),u(f(t),"svg",{node:function(o,l){return Z(o,l)},attr:function(o,l){return Y(o,l)},pos:function(o){return yn(o)}}),e=e||{},t.containerType=ft(t.getContainer()),t.elementsDraggable=e&&e.elementsDraggable!==!1,t.managedElementsSelector=e?e.managedElementsSelector||P:P,t.eventManager=new Dn,t.dragSelection=new Jr(f(t)),t.dragManager=new ts(f(t),t.dragSelection),t.dragManager.addHandler(new Jt(f(t))),t.groupDragOptions={constrainFunction:fs},t.dragManager.addHandler(new Kt(f(t),t.dragSelection),t.groupDragOptions),t.elementDragHandler=new mt(f(t),t.dragSelection),t.elementDragOptions=e&&e.dragOptions||{},t.dragManager.addHandler(t.elementDragHandler,t.elementDragOptions),e&&e.dragOptions&&e.dragOptions.filter&&t.dragManager.addFilter(e.dragOptions.filter),t._createEventListeners(),t._attachEventDelegates(),e.resizeObserver!==!1)try{t._resizeObserver=new ResizeObserver(function(s){var o=s.filter(function(l){var h=t.getAttribute(l.target,Nt);if(h!=null){var d=t.viewport._elementMap.get(h);return d?d.w!==l.contentRect.width||d.h!==l.contentRect.height:!1}else return!1});o.forEach(function(l){return t.revalidate(l.target)})})}catch{ut("WARN: ResizeObserver could not be attached.")}return t}return M(n,[{key:"fireOverlayMethod",value:function(e,t,s){var o=e.component instanceof st?$:ce,l=D(o,t);s._jsPlumbOverlay=e,e.fire(t,{e:s,overlay:e}),this.fire(l,e.component,s)}},{key:"addDragFilter",value:function(e,t){this.dragManager.addFilter(e,t)}},{key:"removeDragFilter",value:function(e){this.dragManager.removeFilter(e)}},{key:"setDragGrid",value:function(e){this.dragManager.setOption(this.elementDragHandler,{grid:e})}},{key:"setDragConstrainFunction",value:function(e){this.dragManager.setOption(this.elementDragHandler,{constrainFunction:e})}},{key:"_removeElement",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"_appendElement",value:function(e,t){t&&t.appendChild(e)}},{key:"_appendElementToGroup",value:function(e,t){this.getGroupContentArea(e).appendChild(t)}},{key:"_appendElementToContainer",value:function(e){this._appendElement(e,this.getContainer())}},{key:"_getAssociatedElements",value:function(e){var t=[];if(e.nodeType!==3&&e.nodeType!==8){var s=e.querySelectorAll(P);Array.prototype.push.apply(t,s)}return t.filter(function(o){return o.nodeType!==3&&o.nodeType!==8})}},{key:"shouldFireEvent",value:function(e,t,s){return!0}},{key:"getClass",value:function(e){return Di(e)}},{key:"addClass",value:function(e,t){se(e,t)}},{key:"hasClass",value:function(e,t){return ki(e,t)}},{key:"removeClass",value:function(e,t){dt(e,t)}},{key:"toggleClass",value:function(e,t){Pi(e,t)}},{key:"setAttribute",value:function(e,t,s){e.setAttribute(t,s)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"setAttributes",value:function(e,t){for(var s in t)e.setAttribute(s,t[s])}},{key:"removeAttribute",value:function(e,t){e.removeAttribute&&e.removeAttribute(t)}},{key:"on",value:function(e,t,s,o){var l=this,h=function(c){o==null?l.eventManager.on(c,t,s):l.eventManager.on(c,t,s,o)};return Me(e)?T(e,function(d){return h(d)}):h(e),this}},{key:"off",value:function(e,t,s){var o=this;return Me(e)?T(e,function(l){return o.eventManager.off(l,t,s)}):this.eventManager.off(e,t,s),this}},{key:"trigger",value:function(e,t,s,o,l){this.eventManager.trigger(e,t,s,o,l)}},{key:"getOffsetRelativeToRoot",value:function(e){return fe(e)}},{key:"getOffset",value:function(e){for(var t=e,s=this.getContainer(),o=this.getPosition(t),l=e!==s&&t.offsetParent!==s?t.offsetParent:null,h=function(p){p!=null&&p!==document.body&&(p.scrollTop>0||p.scrollLeft>0)&&(o.x-=p.scrollLeft,o.y-=p.scrollTop)};l!=null;)o.x+=l.offsetLeft,o.y+=l.offsetTop,h(l),l=l.offsetParent===s?null:l.offsetParent;if(s!=null&&(s.scrollTop>0||s.scrollLeft>0)){var d=t.offsetParent!=null?this.getStyle(t.offsetParent,Yt):qn,c=this.getStyle(t,Yt);c!==Ae&&c!==wt&&d!==Ae&&d!==wt&&(o.x-=s.scrollLeft,o.y-=s.scrollTop)}return o}},{key:"getSize",value:function(e){var t=e;if(t.offsetWidth!=null)return bi(e);if(t.width&&t.width.baseVal)return Ai(t)}},{key:"getPosition",value:function(e){var t=e;if(t.offsetLeft!=null)return{x:parseFloat(t.offsetLeft),y:parseFloat(t.offsetTop)};if(t.x&&t.x.baseVal)return xi(t)}},{key:"getStyle",value:function(e,t){return ge(window.getComputedStyle)!==fn?getComputedStyle(e,null).getPropertyValue(t):e.currentStyle[t]}},{key:"getGroupContentArea",value:function(e){var t=this.getSelector(e.el,fr);return t&&t.length>0?t[0]:e.el}},{key:"getSelector",value:function(e,t){var s=null;if(arguments.length===1){if(!pe(e)){var o=document.createDocumentFragment();return o.appendChild(e),Le(o.childNodes)}s=Le(document.querySelectorAll(e))}else s=Le(e.querySelectorAll(t));return s}},{key:"setPosition",value:function(e,t){var s=e;s.style.left=t.x+"px",s.style.top=t.y+"px"}},{key:"setDraggable",value:function(e,t){t?this.removeAttribute(e,He):this.setAttribute(e,He,dn)}},{key:"isDraggable",value:function(e){var t=this.getAttribute(e,He);return t==null||t===ve}},{key:"toggleDraggable",value:function(e){var t=this.isDraggable(e);return this.setDraggable(e,!t),!t}},{key:"_createEventListeners",value:function(){var e=function(E,m){if(!m.defaultPrevented&&m._jsPlumbOverlay==null){var C=K(w(m),F,this.getContainer(),!0);this.fire(E,C.jtk.connector.connection,m)}};this._connectorClick=e.bind(this,ir),this._connectorDblClick=e.bind(this,rr),this._connectorTap=e.bind(this,hr),this._connectorDblTap=e.bind(this,sr);var t=function(E,m){var C=w(m).parentNode;if(C.jtk&&C.jtk.connector){var S=C.jtk.connector,k=S.connection;this.setConnectorHover(S,E),E?(this.addClass(k.source,this.hoverSourceClass),this.addClass(k.target,this.hoverTargetClass)):(this.removeClass(k.source,this.hoverSourceClass),this.removeClass(k.target,this.hoverTargetClass)),this.fire(E?or:ar,C.jtk.connector.connection,m)}};this._connectorMouseover=t.bind(this,!0),this._connectorMouseout=t.bind(this,!1);var s=function(E,m){var C=w(m).parentNode;C.jtk&&C.jtk.connector&&this.fire(E?lr:ur,C.jtk.connector.connection,m)};this._connectorMouseup=s.bind(this,!0),this._connectorMousedown=s.bind(this,!1),this._connectorContextmenu=(function(g){var E=w(g).parentNode;E.jtk&&E.jtk.connector&&this.fire(cr,E.jtk.connector.connection,g)}).bind(this);var o=function(E,m,C){!m.defaultPrevented&&m._jsPlumbOverlay==null&&this.fire(E,C.jtk.endpoint,m)};this._endpointClick=o.bind(this,zi),this._endpointDblClick=o.bind(this,qi);var l=function(E,m){var C=w(m);C.jtk&&C.jtk.endpoint&&(this.setEndpointHover(C.jtk.endpoint,E),this.fire(E?er:Qi,C.jtk.endpoint,m))};this._endpointMouseover=l.bind(this,!0),this._endpointMouseout=l.bind(this,!1);var h=function(E,m){var C=w(m);C.jtk&&C.jtk.endpoint&&this.fire(E?tr:nr,C.jtk.endpoint,m)};this._endpointMouseup=h.bind(this,!0),this._endpointMousedown=h.bind(this,!1);var d=(function(g,E){var m=K(w(E),J,this.getContainer(),!0),C=m.jtk.overlay;C&&this.fireOverlayMethod(C,g,E)}).bind(this);this._overlayClick=d.bind(this,I),this._overlayDblClick=d.bind(this,W),this._overlayTap=d.bind(this,B),this._overlayDblTap=d.bind(this,V);var c=function(E,m){var C=K(w(m),J,this.getContainer(),!0),S=C.jtk.overlay;S&&this.setOverlayHover(S,E)};this._overlayMouseover=c.bind(this,!0),this._overlayMouseout=c.bind(this,!1);var _=function(E,m,C){m.defaultPrevented||this.fire(m.detail===1?Bt:Wi,C,m)};this._elementClick=_.bind(this,Bt);var p=function(E,m,C){m.defaultPrevented||this.fire(Wt,C,m)};this._elementTap=p.bind(this,Wt);var v=function(E,m,C){m.defaultPrevented||this.fire(Ut,C,m)};this._elementDblTap=v.bind(this,Ut);var y=function(E,m){this.fire(E?Zi:Yi,w(m),m)};this._elementMouseenter=y.bind(this,!0),this._elementMouseexit=y.bind(this,!1),this._elementMousemove=(function(g){this.fire(Xi,w(g),g)}).bind(this),this._elementMouseup=(function(g){this.fire($i,w(g),g)}).bind(this),this._elementMousedown=(function(g){this.fire(Ji,w(g),g)}).bind(this),this._elementContextmenu=(function(g){this.fire(Ki,w(g),g)}).bind(this)}},{key:"_attachEventDelegates",value:function(){var e=this.getContainer();this.eventManager.on(e,I,J,this._overlayClick),this.eventManager.on(e,W,J,this._overlayDblClick),this.eventManager.on(e,B,J,this._overlayTap),this.eventManager.on(e,V,J,this._overlayDblTap),this.eventManager.on(e,I,F,this._connectorClick),this.eventManager.on(e,W,F,this._connectorDblClick),this.eventManager.on(e,B,F,this._connectorTap),this.eventManager.on(e,V,F,this._connectorDblTap),this.eventManager.on(e,I,ie,this._endpointClick),this.eventManager.on(e,W,ie,this._endpointDblClick),this.eventManager.on(e,I,this.managedElementsSelector,this._elementClick),this.eventManager.on(e,B,this.managedElementsSelector,this._elementTap),this.eventManager.on(e,V,this.managedElementsSelector,this._elementDblTap),this.eventManager.on(e,L,F,this._connectorMouseover),this.eventManager.on(e,j,F,this._connectorMouseout),this.eventManager.on(e,z,F,this._connectorContextmenu),this.eventManager.on(e,x,F,this._connectorMouseup),this.eventManager.on(e,A,F,this._connectorMousedown),this.eventManager.on(e,L,ie,this._endpointMouseover),this.eventManager.on(e,j,ie,this._endpointMouseout),this.eventManager.on(e,x,ie,this._endpointMouseup),this.eventManager.on(e,A,ie,this._endpointMousedown),this.eventManager.on(e,L,J,this._overlayMouseover),this.eventManager.on(e,j,J,this._overlayMouseout),this.eventManager.on(e,L,P,this._elementMouseenter),this.eventManager.on(e,j,P,this._elementMouseexit),this.eventManager.on(e,ae,P,this._elementMousemove),this.eventManager.on(e,x,P,this._elementMouseup),this.eventManager.on(e,A,P,this._elementMousedown),this.eventManager.on(e,z,P,this._elementContextmenu)}},{key:"_detachEventDelegates",value:function(){var e=this.getContainer();e&&(this.eventManager.off(e,I,this._connectorClick),this.eventManager.off(e,W,this._connectorDblClick),this.eventManager.off(e,B,this._connectorTap),this.eventManager.off(e,V,this._connectorDblTap),this.eventManager.off(e,I,this._endpointClick),this.eventManager.off(e,W,this._endpointDblClick),this.eventManager.off(e,I,this._overlayClick),this.eventManager.off(e,W,this._overlayDblClick),this.eventManager.off(e,B,this._overlayTap),this.eventManager.off(e,V,this._overlayDblTap),this.eventManager.off(e,I,this._elementClick),this.eventManager.off(e,B,this._elementTap),this.eventManager.off(e,V,this._elementDblTap),this.eventManager.off(e,L,this._connectorMouseover),this.eventManager.off(e,j,this._connectorMouseout),this.eventManager.off(e,z,this._connectorContextmenu),this.eventManager.off(e,x,this._connectorMouseup),this.eventManager.off(e,A,this._connectorMousedown),this.eventManager.off(e,L,this._endpointMouseover),this.eventManager.off(e,j,this._endpointMouseout),this.eventManager.off(e,x,this._endpointMouseup),this.eventManager.off(e,A,this._endpointMousedown),this.eventManager.off(e,L,this._overlayMouseover),this.eventManager.off(e,j,this._overlayMouseout),this.eventManager.off(e,Tt,this._elementMouseenter),this.eventManager.off(e,St,this._elementMouseexit),this.eventManager.off(e,ae,this._elementMousemove),this.eventManager.off(e,x,this._elementMouseup),this.eventManager.off(e,A,this._elementMousedown),this.eventManager.off(e,z,this._elementContextmenu))}},{key:"setContainer",value:function(e){var t=this;if(e===document||e===document.body)throw new Error("Cannot set document or document.body as container element");this._detachEventDelegates();var s;this.dragManager!=null&&(s=this.dragManager.reset()),this.setAttribute(e,Ht,Je().replace("-",""));var o=this.getContainer();if(o!=null){o.removeAttribute(Ht);var l=Le(o.childNodes).filter(function(h){return h!=null&&(t.hasClass(h,rn)||t.hasClass(h,ke)||t.hasClass(h,yt)||h.getAttribute&&h.getAttribute(Nt)!=null)});T(l,function(h){e.appendChild(h)})}G(N(n.prototype),"setContainer",this).call(this,e),this.containerType=ft(e),this.eventManager!=null&&this._attachEventDelegates(),this.dragManager!=null&&(this.dragManager.addHandler(new Jt(this)),this.dragManager.addHandler(new Kt(this,this.dragSelection),this.groupDragOptions),this.elementDragHandler=new mt(this,this.dragSelection),this.dragManager.addHandler(this.elementDragHandler,this.elementDragOptions),s!=null&&this.dragManager.setFilters(s))}},{key:"reset",value:function(){G(N(n.prototype),"reset",this).call(this),this._resizeObserver&&this._resizeObserver.disconnect();var e=this.getContainer(),t=e.querySelectorAll([P,ie,F,J].join(","));T(t,function(s){return s.parentNode&&s.parentNode.removeChild(s)})}},{key:"destroy",value:function(){this._detachEventDelegates(),this.dragManager!=null&&this.dragManager.reset(),this.clearDragSelection(),G(N(n.prototype),"destroy",this).call(this)}},{key:"unmanage",value:function(e,t){this._resizeObserver!=null&&this._resizeObserver.unobserve(e),this.removeFromDragSelection(e),G(N(n.prototype),"unmanage",this).call(this,e,t)}},{key:"addToDragSelection",value:function(){for(var e=this,t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];T(s,function(l){return e.dragSelection.add(l)})}},{key:"clearDragSelection",value:function(){this.dragSelection.clear()}},{key:"removeFromDragSelection",value:function(){for(var e=this,t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];T(s,function(l){return e.dragSelection.remove(l)})}},{key:"toggleDragSelection",value:function(){for(var e=this,t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];T(s,function(l){return e.dragSelection.toggle(l)})}},{key:"addToDragGroup",value:function(e){for(var t,s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];(t=this.elementDragHandler).addToDragGroup.apply(t,[e].concat(o))}},{key:"removeFromDragGroup",value:function(){var e;(e=this.elementDragHandler).removeFromDragGroup.apply(e,arguments)}},{key:"setDragGroupState",value:function(e){for(var t,s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];(t=this.elementDragHandler).setDragGroupState.apply(t,[e].concat(o))}},{key:"clearDragGroup",value:function(e){this.elementDragHandler.clearDragGroup(e)}},{key:"consume",value:function(e,t){Oe(e,t)}},{key:"rotate",value:function(e,t,s){var o=this.getId(e);return this._managedElements[o]?(this._managedElements[o].el.style.transform="rotate("+t+"deg)",this._managedElements[o].el.style.transformOrigin="center center",G(N(n.prototype),"rotate",this).call(this,e,t,s)):{c:new Set,e:new Set}}},{key:"addOverlayClass",value:function(e,t){if(Q(e))e.instance.addClass(H(e),t);else if(de(e))e.instance.addClass(De(e),t);else if(ee(e))e.instance.addClass(re(e),t);else throw"Could not add class to overlay of type ["+e.type+"]"}},{key:"removeOverlayClass",value:function(e,t){if(Q(e))e.instance.removeClass(H(e),t);else if(de(e))e.instance.removeClass(De(e),t);else if(ee(e))e.instance.removeClass(re(e),t);else throw"Could not remove class from overlay of type ["+e.type+"]"}},{key:"_paintOverlay",value:function(e,t,s){if(Q(e)){H(e);var o=e.component.getXY();e.canvas.style.left=o.x+t.d.minx+"px",e.canvas.style.top=o.y+t.d.miny+"px"}else if(de(e)){var l=isNaN(t.d.cxy.x)||isNaN(t.d.cxy.y)?"M 0 0":"M"+t.d.hxy.x+","+t.d.hxy.y+" L"+t.d.tail[0].x+","+t.d.tail[0].y+" L"+t.d.cxy.x+","+t.d.cxy.y+" L"+t.d.tail[1].x+","+t.d.tail[1].y+" Z";ls(e,l,t,s)}else if(ee(e)){re(e);var h=e.component.getXY();e.canvas.style.left=h.x+t.d.minx+"px",e.canvas.style.top=h.y+t.d.miny+"px"}else throw"Could not paint overlay of type ["+e.type+"]"}},{key:"setOverlayVisible",value:function(e,t){var s=t?"block":"none";function o(l){l!=null&&(l.style.display=s)}Q(e)?o(H(e)):ee(e)?o(re(e)):de(e)&&o(e.path)}},{key:"reattachOverlay",value:function(e,t){Q(e)?e.instance._appendElement(H(e),this.getContainer()):ee(e)?e.instance._appendElement(re(e),this.getContainer()):de(e)&&this._appendElement(De(e),t.connector.canvas)}},{key:"setOverlayHover",value:function(e,t){var s;Q(e)?s=H(e):ee(e)?s=re(e):de(e)&&(s=De(e)),s!=null&&(this.hoverClass!=null&&(t?this.addClass(s,this.hoverClass):this.removeClass(s,this.hoverClass)),this.setHover(e.component,t))}},{key:"destroyOverlay",value:function(e){if(Q(e)){var t=H(e);t.parentNode.removeChild(t),delete e.canvas,delete e.cachedDimensions}else if(at(e)||ot(e)||lt(e))us(e);else if(ee(e)){var s=re(e);s.parentNode.removeChild(s),delete e.canvas,delete e.cachedDimensions}}},{key:"drawOverlay",value:function(e,t,s,o){if(Q(e)||ee(e)){var l=xt._getDimensions(e);if(l!=null&&l.w!=null&&l.h!=null){var h={x:0,y:0};if(o)h={x:o.x,y:o.y};else if(t instanceof on){var d=Array.isArray(e.location)?e.location:[e.location,e.location];h={x:d[0]*t.w,y:d[1]*t.h}}else{var c=e.location,_=!1;(pe(e.location)||e.location<0||e.location>1)&&(c=parseInt(""+e.location,10),_=!0),h=t.pointOnPath(c,_)}var p=h.x-l.w/2,v=h.y-l.h/2;return{component:e,d:{minx:p,miny:v,td:l,cxy:h},xmin:p,xmax:p+l.w,ymin:v,ymax:v+l.h}}else return{xmin:0,xmax:0,ymin:0,ymax:0}}else{if(at(e)||ot(e)||lt(e))return e.draw(t,s,o);throw"Could not draw overlay of type ["+e.type+"]"}}},{key:"updateLabel",value:function(e){if(ci(e.label)){var t=e.label(this);t!=null?H(e).innerText=t:H(e).innerText=""}else e.labelText==null&&(e.labelText=e.label,e.labelText!=null?H(e).innerText=e.labelText:H(e).innerText="")}},{key:"setHover",value:function(e,t){e._hover=t,e instanceof ln&&e.endpoint!=null?this.setEndpointHover(e,t,-1):e instanceof st&&e.connector!=null&&this.setConnectorHover(e.connector,t)}},{key:"paintConnector",value:function(e,t,s){cs(this,e,t,s)}},{key:"setConnectorHover",value:function(e,t,s){if(t===!1||!this.currentlyDragging&&!this.isHoverSuspended()){var o=e.canvas;o!=null&&(e.hoverClass!=null&&(t?this.addClass(o,e.hoverClass):this.removeClass(o,e.hoverClass)),t?this.addClass(o,this.hoverClass):this.removeClass(o,this.hoverClass)),e.connection.hoverPaintStyle!=null&&(e.connection.paintStyleInUse=t?e.connection.hoverPaintStyle:e.connection.paintStyle,this._suspendDrawing||this._paintConnection(e.connection)),e.connection.endpoints[0]!==s&&this.setEndpointHover(e.connection.endpoints[0],t,0,!0),e.connection.endpoints[1]!==s&&this.setEndpointHover(e.connection.endpoints[1],t,1,!0)}}},{key:"destroyConnector",value:function(e){e.connector!=null&&Qt(e.connector)}},{key:"addConnectorClass",value:function(e,t){e.canvas&&this.addClass(e.canvas,t)}},{key:"removeConnectorClass",value:function(e,t){e.canvas&&this.removeClass(e.canvas,t)}},{key:"getConnectorClass",value:function(e){return e.canvas?e.canvas.className.baseVal:""}},{key:"setConnectorVisible",value:function(e,t){qt(e,t)}},{key:"applyConnectorType",value:function(e,t){if(e.canvas&&t.cssClass){var s=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(e.canvas,s.join(" "))}}},{key:"addEndpointClass",value:function(e,t){var s=Te(e.endpoint);s!=null&&this.addClass(s,t)}},{key:"applyEndpointType",value:function(e,t){if(t.cssClass){var s=Te(e.endpoint);if(s){var o=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(s,o.join(" "))}}}},{key:"destroyEndpoint",value:function(e){var t=this.endpointAnchorClassPrefix+(e.currentAnchorClass?"-"+e.currentAnchorClass:"");this.removeClass(e.element,t),Qt(e.endpoint)}},{key:"renderEndpoint",value:function(e,t){var s=Mn[e.endpoint.type];s!=null?ds.paint(e.endpoint,s,t):ut("jsPlumb: no endpoint renderer found for type ["+e.endpoint.type+"]")}},{key:"removeEndpointClass",value:function(e,t){var s=Te(e.endpoint);s!=null&&this.removeClass(s,t)}},{key:"getEndpointClass",value:function(e){var t=Te(e.endpoint);return t!=null?t.className:""}},{key:"setEndpointHover",value:function(e,t,s,o){if(e!=null&&(t===!1||!this.currentlyDragging&&!this.isHoverSuspended())){var l=Te(e.endpoint);if(l!=null&&(e.hoverClass!=null&&(t?this.addClass(l,e.hoverClass):this.removeClass(l,e.hoverClass)),s===0||s===1)){var h=s===0?this.hoverSourceClass:this.hoverTargetClass;t?this.addClass(l,h):this.removeClass(l,h)}if(e.hoverPaintStyle!=null&&(e.paintStyleInUse=t?e.hoverPaintStyle:e.paintStyle,this._suspendDrawing||this.renderEndpoint(e,e.paintStyleInUse)),!o)for(var d=0;d<e.connections.length;d++)this.setConnectorHover(e.connections[d].connector,t,e)}}},{key:"setEndpointVisible",value:function(e,t){qt(e.endpoint,t)}},{key:"setGroupVisible",value:function(e,t){for(var s=e.el.querySelectorAll(P),o=0;o<s.length;o++)t?this.show(s[o],!0):this.hide(s[o],!0)}},{key:"deleteConnection",value:function(e,t){return e!=null&&e.deleted!==!0?(e.endpoints[0].deleted!==!0&&this.setEndpointHover(e.endpoints[0],!1,0,!0),e.endpoints[1].deleted!==!0&&this.setEndpointHover(e.endpoints[1],!1,1,!0),G(N(n.prototype),"deleteConnection",this).call(this,e,t)):!1}},{key:"addSourceSelector",value:function(e,t,s){return this.addDragFilter(e),G(N(n.prototype),"addSourceSelector",this).call(this,e,t,s)}},{key:"removeSourceSelector",value:function(e){this.removeDragFilter(e.selector),G(N(n.prototype),"removeSourceSelector",this).call(this,e)}},{key:"manage",value:function(e,t,s){if(this.containerType===ue.SVG&&!Oi(e))throw new Error("ERROR: cannot manage non-svg element when container is an SVG element.");var o=G(N(n.prototype),"manage",this).call(this,e,t,s);return o!=null&&this._resizeObserver!=null&&this._resizeObserver.observe(o.el),o}}]),n}(Qn),gs="circle",ps=function(){Ot(ei.type,{makeNode:function(n,i){return Z(gs,{cx:n.w/2,cy:n.h/2,r:n.radius})},updateNode:function(n,i){Y(i,{cx:""+n.w/2,cy:""+n.h/2,r:""+n.radius})}})},_s="rect",ms=function(){Ot(ti.type,{makeNode:function(n,i){return Z(_s,{width:n.w,height:n.h})},updateNode:function(n,i){Y(i,{width:n.w,height:n.h})}})},en={width:10,height:0,fill:"transparent",stroke:"transparent"},ys=function(){Ot(ni.type,{makeNode:function(n,i){return Z("rect",en)},updateNode:function(n,i){Y(i,en)}})};ps();ys();ms();var tn=0;function Es(){var r=tn+1;return tn++,r}function ks(r){return new vs(Es(),r)}function Ps(r){var a=function n(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?r():setTimeout(n,9)};a()}export{ar as E,or as a,er as b,pn as c,Qi as d,zi as e,Ui as f,Ps as g,Hi as h,Vt as i,ks as n,Ot as r,Ds as s};
//# sourceMappingURL=browser-ui-BVF2KoJK.js.map
