{"version":3,"mappings":"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","names":["RunDataJsonActions","defineAsyncComponent","__vitePreload","_sfc_main","defineComponent","VueJsonPretty","Draggable","MappingPill","TextWithHighlights","externalHooks","useExternalHooks","selectedJsonPath","ref","nonExistingJsonPath","draggingPath","displayMode","mapStores","useNDVStore","useWorkflowsStore","executionDataToJson","el","shorten","path","subPath","getMappedExpression","mappingTelemetry","telemetryPayload","value","isString","_resolveComponent","_ctx","_createBlock","_Suspense","_withCtx","_createCommentVNode","_component_RunDataJsonActions","jsonData","paneType","_component_Draggable","onDragStart","onDragEnd","canDrop","_openBlock","_component_MappingPill","_createVNode","_component_VueJsonPretty","_cache","$event","getContent","search","node","$style","mappingEnabled","_normalizeClass","_component_TextWithHighlights","getListItemName"],"ignoreList":[],"sources":["../../src/components/RunDataJson.vue"],"sourcesContent":["<template>\n\t<div :class=\"[$style.jsonDisplay, { [$style.highlight]: highlight }]\">\n\t\t<Suspense>\n\t\t\t<RunDataJsonActions\n\t\t\t\tv-if=\"!editMode.enabled\"\n\t\t\t\t:node=\"node\"\n\t\t\t\t:push-ref=\"pushRef\"\n\t\t\t\t:display-mode=\"displayMode\"\n\t\t\t\t:distance-from-active=\"distanceFromActive\"\n\t\t\t\t:selected-json-path=\"selectedJsonPath\"\n\t\t\t\t:json-data=\"jsonData\"\n\t\t\t\t:pane-type=\"paneType\"\n\t\t\t/>\n\t\t</Suspense>\n\t\t<Draggable\n\t\t\ttype=\"mapping\"\n\t\t\ttarget-data-key=\"mappable\"\n\t\t\t:disabled=\"!mappingEnabled\"\n\t\t\t@dragstart=\"onDragStart\"\n\t\t\t@dragend=\"onDragEnd\"\n\t\t>\n\t\t\t<template #preview=\"{ canDrop, el }\">\n\t\t\t\t<MappingPill v-if=\"el\" :html=\"getShortKey(el)\" :can-drop=\"canDrop\" />\n\t\t\t</template>\n\t\t\t<VueJsonPretty\n\t\t\t\t:data=\"jsonData\"\n\t\t\t\t:deep=\"10\"\n\t\t\t\t:show-length=\"true\"\n\t\t\t\t:selected-value=\"selectedJsonPath\"\n\t\t\t\troot-path=\"\"\n\t\t\t\tselectable-type=\"single\"\n\t\t\t\tclass=\"json-data\"\n\t\t\t\t@update:selected-value=\"selectedJsonPath = $event\"\n\t\t\t>\n\t\t\t\t<template #renderNodeKey=\"{ node }\">\n\t\t\t\t\t<TextWithHighlights\n\t\t\t\t\t\t:content=\"getContent(node.key)\"\n\t\t\t\t\t\t:search=\"search\"\n\t\t\t\t\t\tdata-target=\"mappable\"\n\t\t\t\t\t\t:data-value=\"getJsonParameterPath(node.path)\"\n\t\t\t\t\t\t:data-name=\"node.key\"\n\t\t\t\t\t\t:data-path=\"node.path\"\n\t\t\t\t\t\t:data-depth=\"node.level\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t[$style.mappable]: mappingEnabled,\n\t\t\t\t\t\t\t[$style.dragged]: draggingPath === node.path,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t<template #renderNodeValue=\"{ node }\">\n\t\t\t\t\t<TextWithHighlights\n\t\t\t\t\t\tv-if=\"isNaN(node.index)\"\n\t\t\t\t\t\t:content=\"getContent(node.content)\"\n\t\t\t\t\t\t:search=\"search\"\n\t\t\t\t\t/>\n\t\t\t\t\t<TextWithHighlights\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\t:content=\"getContent(node.content)\"\n\t\t\t\t\t\t:search=\"search\"\n\t\t\t\t\t\tdata-target=\"mappable\"\n\t\t\t\t\t\t:data-value=\"getJsonParameterPath(node.path)\"\n\t\t\t\t\t\t:data-name=\"getListItemName(node.path)\"\n\t\t\t\t\t\t:data-path=\"node.path\"\n\t\t\t\t\t\t:data-depth=\"node.level\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t[$style.mappable]: mappingEnabled,\n\t\t\t\t\t\t\t[$style.dragged]: draggingPath === node.path,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\tclass=\"ph-no-capture\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</VueJsonPretty>\n\t\t</Draggable>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineAsyncComponent, defineComponent, ref } from 'vue';\nimport type { PropType } from 'vue';\nimport VueJsonPretty from 'vue-json-pretty';\nimport type { IDataObject, INodeExecutionData } from 'n8n-workflow';\nimport Draggable from '@/components/Draggable.vue';\nimport { executionDataToJson } from '@/utils/nodeTypesUtils';\nimport { isString } from '@/utils/typeGuards';\nimport { shorten } from '@/utils/typesUtils';\nimport type { INodeUi } from '@/Interface';\nimport { mapStores } from 'pinia';\nimport { useNDVStore } from '@/stores/ndv.store';\nimport MappingPill from './MappingPill.vue';\nimport { getMappedExpression } from '@/utils/mappingUtils';\nimport { useWorkflowsStore } from '@/stores/workflows.store';\nimport { nonExistingJsonPath } from '@/constants';\nimport { useExternalHooks } from '@/composables/useExternalHooks';\nimport TextWithHighlights from './TextWithHighlights.vue';\n\nconst RunDataJsonActions = defineAsyncComponent(\n\tasync () => await import('@/components/RunDataJsonActions.vue'),\n);\n\nexport default defineComponent({\n\tname: 'RunDataJson',\n\tcomponents: {\n\t\tVueJsonPretty,\n\t\tDraggable,\n\t\tRunDataJsonActions,\n\t\tMappingPill,\n\t\tTextWithHighlights,\n\t},\n\tprops: {\n\t\teditMode: {\n\t\t\ttype: Object as PropType<{ enabled?: boolean; value?: string }>,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t\tpushRef: {\n\t\t\ttype: String,\n\t\t},\n\t\tpaneType: {\n\t\t\ttype: String,\n\t\t},\n\t\tnode: {\n\t\t\ttype: Object as PropType<INodeUi>,\n\t\t\trequired: true,\n\t\t},\n\t\tinputData: {\n\t\t\ttype: Array as PropType<INodeExecutionData[]>,\n\t\t\trequired: true,\n\t\t},\n\t\tmappingEnabled: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\tdistanceFromActive: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\trunIndex: {\n\t\t\ttype: Number,\n\t\t},\n\t\ttotalRuns: {\n\t\t\ttype: Number,\n\t\t},\n\t\tsearch: {\n\t\t\ttype: String,\n\t\t},\n\t},\n\tsetup() {\n\t\tconst externalHooks = useExternalHooks();\n\n\t\tconst selectedJsonPath = ref(nonExistingJsonPath);\n\t\tconst draggingPath = ref<null | string>(null);\n\t\tconst displayMode = ref('json');\n\n\t\treturn {\n\t\t\texternalHooks,\n\t\t\tselectedJsonPath,\n\t\t\tdraggingPath,\n\t\t\tdisplayMode,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapStores(useNDVStore, useWorkflowsStore),\n\t\tjsonData(): IDataObject[] {\n\t\t\treturn executionDataToJson(this.inputData);\n\t\t},\n\t\thighlight(): boolean {\n\t\t\treturn this.ndvStore.highlightDraggables;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetShortKey(el: HTMLElement): string {\n\t\t\tif (!el) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn shorten(el.dataset.name || '', 16, 2);\n\t\t},\n\t\tgetJsonParameterPath(path: string): string {\n\t\t\tconst subPath = path.replace(/^(\\[\"?\\d\"?])/, ''); // remove item position\n\n\t\t\treturn getMappedExpression({\n\t\t\t\tnodeName: this.node.name,\n\t\t\t\tdistanceFromActive: this.distanceFromActive,\n\t\t\t\tpath: subPath,\n\t\t\t});\n\t\t},\n\t\tonDragStart(el: HTMLElement) {\n\t\t\tif (el?.dataset.path) {\n\t\t\t\tthis.draggingPath = el.dataset.path;\n\t\t\t}\n\n\t\t\tthis.ndvStore.resetMappingTelemetry();\n\t\t},\n\t\tonDragEnd(el: HTMLElement) {\n\t\t\tthis.draggingPath = null;\n\t\t\tconst mappingTelemetry = this.ndvStore.mappingTelemetry;\n\t\t\tconst telemetryPayload = {\n\t\t\t\tsrc_node_type: this.node.type,\n\t\t\t\tsrc_field_name: el.dataset.name || '',\n\t\t\t\tsrc_nodes_back: this.distanceFromActive,\n\t\t\t\tsrc_run_index: this.runIndex,\n\t\t\t\tsrc_runs_total: this.totalRuns,\n\t\t\t\tsrc_field_nest_level: el.dataset.depth || 0,\n\t\t\t\tsrc_view: 'json',\n\t\t\t\tsrc_element: el,\n\t\t\t\tsuccess: false,\n\t\t\t\t...mappingTelemetry,\n\t\t\t};\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tvoid this.externalHooks.run('runDataJson.onDragEnd', telemetryPayload);\n\t\t\t\tthis.$telemetry.track('User dragged data for mapping', telemetryPayload, {\n\t\t\t\t\twithPostHog: true,\n\t\t\t\t});\n\t\t\t}, 1000); // ensure dest data gets set if drop\n\t\t},\n\t\tgetContent(value: unknown): string {\n\t\t\treturn isString(value) ? `\"${value}\"` : JSON.stringify(value);\n\t\t},\n\t\tgetListItemName(path: string): string {\n\t\t\treturn path.replace(/^(\\[\"?\\d\"?]\\.?)/g, '');\n\t\t},\n\t},\n});\n</script>\n\n<style lang=\"scss\" module>\n.jsonDisplay {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tpadding-left: var(--spacing-s);\n\tright: 0;\n\toverflow-y: auto;\n\tline-height: 1.5;\n\tword-break: normal;\n\theight: 100%;\n\tpadding-bottom: var(--spacing-3xl);\n\n\t&:hover {\n\t\t/* Shows .actionsGroup element from <run-data-json-actions /> child component */\n\t\t> div:first-child {\n\t\t\topacity: 1;\n\t\t}\n\t}\n\n\t.mappable {\n\t\tcursor: grab;\n\n\t\t&:hover {\n\t\t\tbackground-color: var(--color-json-highlight);\n\t\t}\n\t}\n\n\t&.highlight .mappable,\n\t.dragged {\n\t\t&,\n\t\t&:hover {\n\t\t\tbackground-color: var(--color-primary-tint-2);\n\t\t\tcolor: var(--color-primary);\n\t\t}\n\t}\n}\n</style>\n\n<style lang=\"scss\">\n.vjs-tree {\n\tcolor: var(--color-json-default);\n\t--color-line-break: var(--color-code-line-break);\n}\n\n.vjs-tree-node {\n\t&:hover {\n\t\tbackground-color: transparent;\n\t}\n\n\t&.is-highlight {\n\t\tbackground-color: var(--color-json-highlight);\n\t}\n}\n\n.vjs-key,\n.vjs-value {\n\t> span {\n\t\tcolor: var(--color-text-dark);\n\t\tline-height: 1.7;\n\t\tborder-radius: var(--border-radius-base);\n\t}\n}\n\n.vjs-value {\n\t> span {\n\t\tpadding: 0 var(--spacing-5xs) 0 var(--spacing-5xs);\n\t\tmargin-left: var(--spacing-5xs);\n\t}\n}\n\n.vjs-tree .vjs-value-null {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-null);\n\t}\n}\n\n.vjs-tree .vjs-value-boolean {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-boolean);\n\t}\n}\n\n.vjs-tree .vjs-value-number {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-number);\n\t}\n}\n\n.vjs-tree .vjs-value-string {\n\t&,\n\tspan {\n\t\tcolor: var(--color-json-string);\n\t}\n}\n\n.vjs-tree .vjs-key {\n\tcolor: var(--color-json-key);\n}\n\n.vjs-tree .vjs-tree__brackets {\n\tcolor: var(--color-json-brackets);\n}\n\n.vjs-tree .vjs-tree__brackets:hover {\n\tcolor: var(--color-json-brackets-hover);\n}\n\n.vjs-tree .vjs-tree__content.has-line {\n\tborder-left: 1px dotted var(--color-json-line);\n}\n</style>\n"],"file":"assets/RunDataJson-CMcOD-78.js"}