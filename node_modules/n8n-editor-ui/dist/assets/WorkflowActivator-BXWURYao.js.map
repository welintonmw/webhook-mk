{"version":3,"file":"WorkflowActivator-BXWURYao.js","sources":["../../src/components/WorkflowActivator.vue"],"sourcesContent":["<template>\n\t<div class=\"workflow-activator\">\n\t\t<div :class=\"$style.activeStatusText\" data-test-id=\"workflow-activator-status\">\n\t\t\t<n8n-text\n\t\t\t\tv-if=\"workflowActive\"\n\t\t\t\t:color=\"couldNotBeStarted ? 'danger' : 'success'\"\n\t\t\t\tsize=\"small\"\n\t\t\t\tbold\n\t\t\t>\n\t\t\t\t{{ $locale.baseText('workflowActivator.active') }}\n\t\t\t</n8n-text>\n\t\t\t<n8n-text v-else color=\"text-base\" size=\"small\" bold>\n\t\t\t\t{{ $locale.baseText('workflowActivator.inactive') }}\n\t\t\t</n8n-text>\n\t\t</div>\n\t\t<n8n-tooltip :disabled=\"!disabled\" placement=\"bottom\">\n\t\t\t<template #content>\n\t\t\t\t<div>\n\t\t\t\t\t{{ $locale.baseText('workflowActivator.thisWorkflowHasNoTriggerNodes') }}\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<el-switch\n\t\t\t\tv-loading=\"updatingWorkflowActivation\"\n\t\t\t\t:model-value=\"workflowActive\"\n\t\t\t\t:title=\"\n\t\t\t\t\tworkflowActive\n\t\t\t\t\t\t? $locale.baseText('workflowActivator.deactivateWorkflow')\n\t\t\t\t\t\t: $locale.baseText('workflowActivator.activateWorkflow')\n\t\t\t\t\"\n\t\t\t\t:disabled=\"disabled || updatingWorkflowActivation\"\n\t\t\t\t:active-color=\"getActiveColor\"\n\t\t\t\tinactive-color=\"#8899AA\"\n\t\t\t\tdata-test-id=\"workflow-activate-switch\"\n\t\t\t\t@update:model-value=\"activeChanged\"\n\t\t\t>\n\t\t\t</el-switch>\n\t\t</n8n-tooltip>\n\n\t\t<div v-if=\"couldNotBeStarted\" class=\"could-not-be-started\">\n\t\t\t<n8n-tooltip placement=\"top\">\n\t\t\t\t<template #content>\n\t\t\t\t\t<div\n\t\t\t\t\t\t@click=\"displayActivationError\"\n\t\t\t\t\t\tv-html=\"$locale.baseText('workflowActivator.theWorkflowIsSetToBeActiveBut')\"\n\t\t\t\t\t></div>\n\t\t\t\t</template>\n\t\t\t\t<font-awesome-icon icon=\"exclamation-triangle\" @click=\"displayActivationError\" />\n\t\t\t</n8n-tooltip>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { useToast } from '@/composables/useToast';\nimport { useWorkflowActivate } from '@/composables/useWorkflowActivate';\nimport { useUIStore } from '@/stores/ui.store';\nimport { useWorkflowsStore } from '@/stores/workflows.store';\nimport { mapStores } from 'pinia';\nimport { defineComponent } from 'vue';\nimport { getActivatableTriggerNodes } from '@/utils/nodeTypesUtils';\n\nexport default defineComponent({\n\tname: 'WorkflowActivator',\n\tprops: ['workflowActive', 'workflowId'],\n\tsetup() {\n\t\treturn {\n\t\t\t...useToast(),\n\t\t\t...useWorkflowActivate(),\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapStores(useUIStore, useWorkflowsStore),\n\t\tnodesIssuesExist(): boolean {\n\t\t\treturn this.workflowsStore.nodesIssuesExist;\n\t\t},\n\t\tisWorkflowActive(): boolean {\n\t\t\tconst activeWorkflows = this.workflowsStore.activeWorkflows;\n\t\t\treturn activeWorkflows.includes(this.workflowId);\n\t\t},\n\t\tcouldNotBeStarted(): boolean {\n\t\t\treturn this.workflowActive === true && this.isWorkflowActive !== this.workflowActive;\n\t\t},\n\t\tgetActiveColor(): string {\n\t\t\tif (this.couldNotBeStarted) {\n\t\t\t\treturn '#ff4949';\n\t\t\t}\n\t\t\treturn '#13ce66';\n\t\t},\n\t\tisCurrentWorkflow(): boolean {\n\t\t\treturn this.workflowsStore.workflowId === this.workflowId;\n\t\t},\n\t\tdisabled(): boolean {\n\t\t\tconst isNewWorkflow = !this.workflowId;\n\t\t\tif (isNewWorkflow || this.isCurrentWorkflow) {\n\t\t\t\treturn !this.workflowActive && !this.containsTrigger;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tcontainsTrigger(): boolean {\n\t\t\tconst foundTriggers = getActivatableTriggerNodes(this.workflowsStore.workflowTriggerNodes);\n\t\t\treturn foundTriggers.length > 0;\n\t\t},\n\t},\n\tmethods: {\n\t\tasync activeChanged(newActiveState: boolean) {\n\t\t\treturn await this.updateWorkflowActivation(this.workflowId, newActiveState);\n\t\t},\n\t\tasync displayActivationError() {\n\t\t\tlet errorMessage: string;\n\t\t\ttry {\n\t\t\t\tconst errorData = await this.workflowsStore.getActivationError(this.workflowId);\n\n\t\t\t\tif (errorData === undefined) {\n\t\t\t\t\terrorMessage = this.$locale.baseText(\n\t\t\t\t\t\t'workflowActivator.showMessage.displayActivationError.message.errorDataUndefined',\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\terrorMessage = this.$locale.baseText(\n\t\t\t\t\t\t'workflowActivator.showMessage.displayActivationError.message.errorDataNotUndefined',\n\t\t\t\t\t\t{ interpolate: { message: errorData } },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\terrorMessage = this.$locale.baseText(\n\t\t\t\t\t'workflowActivator.showMessage.displayActivationError.message.catchBlock',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.showMessage({\n\t\t\t\ttitle: this.$locale.baseText('workflowActivator.showMessage.displayActivationError.title'),\n\t\t\t\tmessage: errorMessage,\n\t\t\t\ttype: 'warning',\n\t\t\t\tduration: 0,\n\t\t\t\tdangerouslyUseHTMLString: true,\n\t\t\t});\n\t\t},\n\t},\n});\n</script>\n\n<style lang=\"scss\" module>\n.activeStatusText {\n\twidth: 64px; // Required to avoid jumping when changing active state\n\tpadding-right: var(--spacing-2xs);\n\tbox-sizing: border-box;\n\tdisplay: inline-block;\n\ttext-align: right;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.workflow-activator {\n\tdisplay: inline-flex;\n\tflex-wrap: nowrap;\n\talign-items: center;\n}\n\n.could-not-be-started {\n\tdisplay: inline-block;\n\tcolor: var(--color-text-danger);\n\tmargin-left: 0.5em;\n}\n</style>\n"],"names":["_sfc_main","defineComponent","useToast","useWorkflowActivate","mapStores","useUIStore","useWorkflowsStore","getActivatableTriggerNodes","newActiveState","errorMessage","errorData","_hoisted_1","_hoisted_2","_directive_loading","_resolveDirective","_openBlock","_createElementVNode","_normalizeClass","_ctx","workflowActive","_createBlock","_component_n8n_text","_createTextVNode","_toDisplayString","_createVNode","_component_n8n_tooltip","_withCtx","_withDirectives","_component_el_switch","$locale","disabled","updatingWorkflowActivation","couldNotBeStarted","_createElementBlock","_cache","args","_hoisted_3","displayActivationError","_createCommentVNode"],"mappings":"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"}