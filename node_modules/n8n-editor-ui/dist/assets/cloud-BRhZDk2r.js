import{e as k,ef as _,l as D,j as d,K as p,bd as n}from"./index-1OxaEeO3.js";import{h as N}from"./n8n-4UEsHtUL.js";import"./vendor-Dv5OeN6t.js";import"./pinia-sugP77Im.js";import"./axios-Mm4CS0gO.js";import"./flatted-DN8lQ2XG.js";import"./@vueuse/core-BBHtM40w.js";import"./lodash-es-CZ1inz46.js";import"./@n8n/permissions-BxxteU-C.js";import"./dateformat-CIxnBJXX.js";import"./vue-i18n-Delvyc9x.js";import"./uuid-SoommWqA.js";import"./luxon-CLwAIbs0.js";import"./@n8n/codemirror-lang-sql-DBO6T13I.js";import"./@lezer/common-B6ct0j_v.js";import"./prettier-bS6l4Vb1.js";import"./@jsplumb/util-DS-9vq_E.js";import"./@jsplumb/core-CVBraiyY.js";import"./@jsplumb/common-CF-b-6-M.js";import"./@jsplumb/connector-bezier-BGU0Ovbw.js";import"./@jsplumb/browser-ui-BVF2KoJK.js";import"./codemirror-lang-html-n8n-CWDO6_kP.js";import"./@n8n/codemirror-lang-Dl0FW_KM.js";import"./esprima-next-nhoSXAeq.js";import"./fast-json-stable-stringify-BOfzoJX1.js";import"./timeago.js-CiyKClrF.js";import"./qrcode.vue-BGkPba5A.js";import"./vue3-touch-events-mV0oX_Sl.js";import"./chart.js-343vZi4M.js";function h(){const e=k().fakeDoorFeatures.map(s=>({...s})),o=e.find(s=>s.id===_.ENVIRONMENTS);o&&(o.actionBoxTitle+=".cloud",o.linkURL+="&edition=cloud");const t=e.find(s=>s.id===_.LOGGING);return t&&(t.actionBoxTitle+=".cloud",t.linkURL+="&edition=cloud",t.infoText=""),e}const S=()=>{const r=k();r.fakeDoorFeatures=h()},a={pushRef:"",data:{nodeFilter:"",resultsNodes:[],filterMode:"Regular"}},g=()=>({eventName:"User entered nodes panel search term",properties:{search_string:a.data.nodeFilter,results_count:a.data.resultsNodes.length,results_nodes:a.data.resultsNodes,filter_mode:a.data.filterMode,nodes_panel_session_id:a.pushRef}}),y=()=>{a.pushRef=`nodes_panel_session_${new Date().valueOf()}`,a.data={nodeFilter:"",resultsNodes:[],filterMode:"Regular"}},E=r=>{var t;const e=D(),o=d();return{eventName:"User saved credentials",properties:{instance_id:e.instanceId,credential_type:r.credential_type,credential_id:r.credential_id,workflow_id:o.workflowId,node_type:(t=o.activeNode)==null?void 0:t.name,is_new:r.is_new}}},C=()=>{const r=d();return{eventName:"User opened workflow settings",properties:{workflow_id:r.workflowId,workflow_name:r.workflowName,current_settings:N(r.workflowSettings)}}},U=r=>{const e=d();return{eventName:"User updated workflow settings",properties:{workflow_id:e.workflowId,workflow_name:e.workflowName,new_settings:N(e.workflowSettings),old_settings:r.oldSettings}}},x=r=>{var o;return{eventName:"User opened node modal",properties:{node_name:(o=p().activeNode)==null?void 0:o.name,node_subtitle:r.nodeSubtitle}}},b=r=>{var o,t;const e=p();return{eventName:"User inserted item from Expression Editor variable selector",properties:{node_name:(o=e.activeNode)==null?void 0:o.name,node_type:(t=e.activeNode)==null?void 0:t.type.split(".")[1],parameter_name:r.parameter.displayName,variable_expression:r.selectedItem.variable}}},I=(r,e)=>{var s,i;const o=p(),t={eventName:"",properties:{}};return r.dialogVisible?(t.eventName="User opened Expression Editor",t.properties={node_name:(s=o.activeNode)==null?void 0:s.name,node_type:(i=o.activeNode)==null?void 0:i.type.split(".")[1],parameter_name:r.parameter.displayName,parameter_field_type:r.parameter.type,new_expression:e}):(t.eventName="User closed Expression Editor",t.properties={empty_expression:e,expression_value:r.value,expression_result:r.resolvedExpressionValue.slice(1)}),t},F=r=>{var o,t;const e=p();return{eventName:"User changed Authentication type from node modal",properties:{node_name:(o=e.activeNode)==null?void 0:o.name,node_type:(t=e.activeNode)==null?void 0:t.type.split(".")[1],old_mode:r.oldNodeParameters.authentication||(r.parameters.find(s=>s.name==="authentication")||{default:"default"}).default,new_mode:r.newValue}}},V=r=>{var o,t;const e=p();return{eventName:"User changed node output view mode",properties:{old_mode:r.oldValue,new_mode:r.newValue,node_name:(o=e.activeNode)==null?void 0:o.name,node_type:(t=e.activeNode)==null?void 0:t.type.split(".")[1]}}},R=r=>{var t,s,i,l,c,m,u,w,f,v;const e=d(),o={eventName:"",properties:{execution_id:e.activeExecutionId}};return(t=r.runDataExecutedStartData)!=null&&t.destinationNode?(o.eventName="Node execution finished",o.properties.node_type=(s=e.getNodeByName(r.nodeName||""))==null?void 0:s.type.split(".")[1],o.properties.node_name=r.nodeName):(o.eventName="Manual workflow execution finished",o.properties.workflow_id=e.workflowId,o.properties.workflow_name=e.workflowName),r.errorMessage||r.resultDataError?(o.properties.status="failed",o.properties.error_message=((i=r.resultDataError)==null?void 0:i.message)||"",o.properties.error_stack=((l=r.resultDataError)==null?void 0:l.stack)||"",o.properties.error_ui_message=r.errorMessage||"",o.properties.error_timestamp=new Date,r.resultDataError&&((c=r.resultDataError)!=null&&c.node)?o.properties.error_node=typeof((m=r.resultDataError)==null?void 0:m.node)=="string"?(u=r.resultDataError)==null?void 0:u.node:(f=(w=r.resultDataError)==null?void 0:w.node)==null?void 0:f.name:o.properties.error_node=r.nodeName):(o.properties.status="success",(v=r.runDataExecutedStartData)!=null&&v.destinationNode&&(o.properties.items_count=r.itemsCount||0)),o},M=r=>{const e=d();return{eventName:"User removed node from workflow canvas",properties:{node_name:r.node.name,node_type:r.node.type,node_disabled:r.node.disabled,workflow_id:e.workflowId}}},T=r=>{switch(r==null?void 0:r.type){case"n8n-nodes-base.httpRequest":const e=r.parameters.url.split("/")[2];return{eventName:"User finished httpRequest node editing",properties:{method:r.parameters.method,domain:e}};case"n8n-nodes-base.function":return{eventName:"User finished function node editing",properties:{node_name:r.name,code:r.parameters.functionCode}};case"n8n-nodes-base.functionItem":return{eventName:"User finished functionItem node editing",properties:{node_name:r.name,code:r.parameters.functionCode}};default:return}},O=r=>{var t;const e=d(),o={eventName:"",properties:{execution_id:e.activeExecutionId}};return r.nodeName?(o.eventName="User started node execution",o.properties.source="unknown",o.properties.node_type=(t=e.getNodeByName(r.nodeName))==null?void 0:t.type.split(".")[1],o.properties.node_name=r.nodeName,r.source==="RunData.ExecuteNodeButton"?o.properties.source="node_modal":r.source==="Node.executeNode"&&(o.properties.source="workflow_canvas")):(o.eventName="User started manual workflow execution",o.properties.workflow_id=e.workflowId,o.properties.workflow_name=e.workflowName),o},me={app:{mount:[()=>{S()}]},nodeView:{mount:[()=>{n().identify()}],createNodeActiveChanged:[(r,e)=>{const o=n(),t={source:e.source,nodes_panel_session_id:a.pushRef};y(),o.track("User opened nodes panel",t),o.page("Cloud instance","Nodes panel",t)}],addNodeButton:[(r,e)=>{const o=n(),t={eventName:"User added node to workflow canvas",properties:{node_type:e.nodeTypeName.split(".")[1],nodes_panel_session_id:a.pushRef}};o.track(t.eventName,t.properties)}]},main:{routeChange:[(r,e)=>{const o=n(),t=e.to.path.split("/");if(e.from.path!=="/"&&t[1]==="workflow"){const s={workflow_id:t[2]};o.page("Cloud instance","Workflow editor",s)}}]},credential:{saved:[(r,e)=>{const o=n(),t=E(e);o.track(t.eventName,t.properties)}]},credentialsEdit:{credentialTypeChanged:[(r,e)=>{const o=n();if(e.newValue){const t={eventName:"User opened Credentials modal",properties:{source:e.setCredentialType===e.credentialType?"node":"primary_menu",new_credential:!e.editCredentials,credential_type:e.credentialType}};o.track(t.eventName,t.properties),o.page("Cloud instance","Credentials modal",t.properties)}}],credentialModalOpened:[(r,e)=>{const o=n(),t={eventName:"User opened Credentials modal",properties:{source:e.activeNode?"node":"primary_menu",new_credential:!e.isEditingCredential,credential_type:e.credentialType}};o.track(t.eventName,t.properties),o.page("Cloud instance","Credentials modal",t.properties)}]},credentialsList:{mounted:[()=>{const r=n(),e={eventName:"User opened global Credentials panel"};r.track(e.eventName),r.page("Cloud instance","Credentials panel")}],dialogVisibleChanged:[(r,e)=>{const o=n();if(e.dialogVisible){const t={eventName:"User opened global Credentials panel"};o.track(t.eventName),o.page("Cloud instance","Credentials panel")}}]},workflowSettings:{dialogVisibleChanged:[(r,e)=>{const o=n();if(e.dialogVisible){const t=C();o.track(t.eventName,t.properties)}}],saveSettings:[(r,e)=>{const o=n(),t=U(e);o.track(t.eventName,t.properties)}]},dataDisplay:{onDocumentationUrlClick:[(r,e)=>{const o=n(),t={eventName:"User clicked node modal docs link",properties:{node_type:e.nodeType.name.split(".")[1],docs_link:e.documentationUrl}};o.track(t.eventName,t.properties)}],nodeTypeChanged:[(r,e)=>{var i;const o=n(),t=p(),s=x(e);o.track(s.eventName,s.properties),o.page("Cloud instance","Node modal",{node:(i=t.activeNode)==null?void 0:i.name})}],nodeEditingFinished:[()=>{const r=n(),e=p(),o=d(),t=T(e.activeNode);t&&(t.properties.workflow_id=o.workflowId),t&&r.track(t.eventName,t.properties)}]},executionsList:{openDialog:[()=>{const r=n(),e={eventName:"User opened Executions log"};r.track(e.eventName),r.page("Cloud instance","Executions log")}]},showMessage:{showError:[(r,e)=>{const o=n(),t={eventName:"Instance FE emitted error",properties:{error_title:e.title,error_description:e.message,error_message:e.errorMessage}};o.track(t.eventName,t.properties)}]},expressionEdit:{itemSelected:[(r,e)=>{const o=n(),t=b(e);e.selectedItem.variable.startsWith("Object.keys")?t.properties.variable_type="Keys":e.selectedItem.variable.startsWith("Object.values")?t.properties.variable_type="Values":t.properties.variable_type="Raw value",o.track(t.eventName,t.properties)}],dialogVisibleChanged:[(r,e)=>{var l;const o=n(),t=((l=e.value)==null?void 0:l.slice(1))??"";let s=!1;switch(typeof e.parameter.default){case"boolean":s=t==="true"&&e.parameter.default||t==="false"&&!e.parameter.default;break;case"string":s=t===e.parameter.default;break;case"number":s=t===e.parameter.default.toString();break}const i=I(e,s);o.track(i.eventName,i.properties)}]},nodeSettings:{valueChanged:[(r,e)=>{const o=n();if(e.parameterPath!=="authentication")return;const t=F(e);o.track(t.eventName,t.properties)}],credentialSelected:[(r,e)=>{const o=n(),t=Object.keys(e.updateInformation.properties.credentials||{});if(t.length<1)return;const s={eventName:"User selected credential from node modal",properties:{credential_name:e.updateInformation.properties.credentials[t[0]],credential_type:t[0]}};o.track(s.eventName,s.properties)}]},workflowRun:{runWorkflow:[(r,e)=>{const o=n(),t=O(e);o.track(t.eventName,t.properties)}],runError:[(r,e)=>{const o=n(),t={eventName:e.nodeName?"Node execution finished":"Manual workflow execution finished",properties:{preflight:"true",status:"failed",error_message:e.errorMessages.join("<br />&nbsp;&nbsp;- "),error_timestamp:new Date,node_name:e.nodeName}};o.track(t.eventName,t.properties)}]},runData:{displayModeChanged:[(r,e)=>{const o=n(),t=V(e);o.track(t.eventName,t.properties)}]},pushConnection:{executionFinished:[(r,e)=>{const o=n(),t=R(e);o.track(t.eventName,t.properties)}]},node:{deleteNode:[(r,e)=>{const o=n(),t=M(e);o.track(t.eventName,t.properties)}]},workflow:{activeChange:[(r,e)=>{const o=n(),t={eventName:e.active&&"User activated workflow"||"User deactivated workflow",properties:{workflow_id:e.workflowId,source:"workflow_modal"}};o.track(t.eventName,t.properties)}],activeChangeCurrent:[(r,e)=>{const o=n(),t=d(),s={eventName:e.active&&"User activated workflow"||"User deactivated workflow",properties:{source:"main nav",workflow_id:e.workflowId,workflow_name:t.workflowName,workflow_nodes:t.allNodes.map(i=>i.type.split(".")[1])}};o.track(s.eventName,s.properties)}],afterUpdate:[(r,e)=>{const o=n(),t={eventName:"User saved workflow",properties:{workflow_id:e.workflowData.id,workflow_name:e.workflowData.name,workflow_nodes:e.workflowData.nodes.map(s=>s.type.split(".")[1])}};o.track(t.eventName,t.properties)}]},execution:{open:[(r,e)=>{const o=n(),t={eventName:"User opened read-only execution",properties:{workflow_id:e.workflowId,workflow_name:e.workflowName,execution_id:e.executionId}};o.track(t.eventName,t.properties)}]},nodeCreateList:{destroyed:[()=>{const r=n();if(a.data.nodeFilter.length>0&&a.data.nodeFilter!==""){const e=g();r.track(e.eventName,e.properties)}}],selectedTypeChanged:[(r,e)=>{const o=n(),t={eventName:"User changed nodes panel filter",properties:{old_filter:e.oldValue,new_filter:e.newValue,nodes_panel_session_id:a.pushRef}};a.data.filterMode=e.newValue,o.track(t.eventName,t.properties)}],nodeFilterChanged:[(r,e)=>{const o=n();if(e.newValue.length===0&&a.data.nodeFilter.length>0){const t=g();o.track(t.eventName,t.properties)}e.newValue.length>e.oldValue.length&&(a.data.nodeFilter=e.newValue,a.data.resultsNodes=e.filteredNodes.map(t=>t.name?t.name.split(".")[1]:t.key?t.key.split(".")[1]:""))}]}};export{me as n8nCloudHooks};
//# sourceMappingURL=cloud-BRhZDk2r.js.map
