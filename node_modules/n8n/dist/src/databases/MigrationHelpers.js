"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.MigrationHelpers = void 0;
class MigrationHelpers {
    constructor(queryRunner) {
        this.queryRunner = queryRunner;
    }
    async runChunked(query, operation, limit = 100) {
        let offset = 0;
        let chunkedQuery;
        let chunkedQueryResults;
        do {
            chunkedQuery = this.chunkQuery(query, limit, offset);
            chunkedQueryResults = (await this.queryRunner.query(chunkedQuery));
            await operation([...chunkedQueryResults]);
            offset += limit;
        } while (chunkedQueryResults.length === limit);
    }
    chunkQuery(query, limit, offset = 0) {
        return `
			${query}
			LIMIT ${limit}
			OFFSET ${offset}
		`;
    }
}
exports.MigrationHelpers = MigrationHelpers;
//# sourceMappingURL=MigrationHelpers.js.map