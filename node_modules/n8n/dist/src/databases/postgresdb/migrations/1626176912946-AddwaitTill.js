"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AddwaitTill1626176912946 = void 0;
const config = require("../../../../config");
class AddwaitTill1626176912946 {
    constructor() {
        this.name = 'AddwaitTill1626176912946';
    }
    async up(queryRunner) {
        let tablePrefix = config.get('database.tablePrefix');
        const tablePrefixPure = tablePrefix;
        const schema = config.get('database.postgresdb.schema');
        if (schema) {
            tablePrefix = schema + '.' + tablePrefix;
        }
        console.log('\n\nINFO: Started with migration for wait functionality.\n      Depending on the number of saved executions, that may take a little bit.\n\n');
        await queryRunner.query(`ALTER TABLE ${tablePrefix}execution_entity ADD "waitTill" TIMESTAMP`);
        await queryRunner.query(`CREATE INDEX IF NOT EXISTS IDX_${tablePrefixPure}ca4a71b47f28ac6ea88293a8e2 ON ${tablePrefix}execution_entity ("waitTill")`);
    }
    async down(queryRunner) {
        let tablePrefix = config.get('database.tablePrefix');
        const tablePrefixPure = tablePrefix;
        const schema = config.get('database.postgresdb.schema');
        if (schema) {
            tablePrefix = schema + '.' + tablePrefix;
        }
        await queryRunner.query(`DROP INDEX IDX_${tablePrefixPure}ca4a71b47f28ac6ea88293a8e2`);
        await queryRunner.query(`ALTER TABLE ${tablePrefix}webhook_entity DROP COLUMN "waitTill"`);
    }
}
exports.AddwaitTill1626176912946 = AddwaitTill1626176912946;
//# sourceMappingURL=1626176912946-AddwaitTill.js.map